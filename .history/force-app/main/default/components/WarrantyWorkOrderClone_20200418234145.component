<apex:component id="wrkOrdr" controller="WarrantyWorkOrderControllerClone">
<!-- <apex:stylesheet value="{!URLFOR($Resource.Chosen_Css, 'chosen.css')}" />  -->
    
 <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.1.0/chosen.jquery.min.js" type="text/javascript"></script> 
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.1.0/chosen.min.css"/>
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <style>
    .wwoisa_error {
        color: #D8000C;
        background-color: #FFBABA;
        margin: 10px 0px; 
        padding: 12px;  
    } 
    .wwopopupText {
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(0,0,0,0.5);
                z-index: 999;
                display: none;
            }
     .wwotextAreaPopup {
                margin: 0px 15.3281px 0px 0px;
                width: 42%;
                height: 54%;
                position: fixed;
                left: 30%;
                top: 22%;
                padding: 10px;
                border-radius: .25rem; 
            } 
            .popupBack {
            	position: fixed;
			    left: 0;
			    right: 0;
			    top: 0;
			    bottom: 0;
			    z-index: 9999;
			    background: #0a030382;
            }
            .innerPopup {
            	    background: #fff;
				    max-width: 27%;
				    padding: 1%;
				    position: absolute;
				    left: 35%;
				    top: 10%;
				    border: 3px solid #727272;
				    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
				    border-radius: .50em;
            }
    </style>
    <script>
            function backtolistWWO() {
            //window.top.location = '/apex/BOATBUILDING__ServicePage?type=WWO';
            
            
            if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
                // Salesforce app navigation
                sforce.one.navigateToURL('/apex/BOATBUILDING__ServicePage?type=WWO'); 
            }
            else {
                // Set the window's URL using a Visualforce expression
                parent.window.location = '/apex/BOATBUILDING__ServicePage?type=WWO'; 
            }
                        
            }
    </script>  
    <div id="wwopopupTextArea" class="wwopopupText"> 
            <input type="hidden" value="" id="wwohiddenInpPopup"/> 
            <input type="hidden" value="" id="wwotyForCmnt"/>
            <a style="position: fixed; left: 70.8%; top: 19%;" onclick="document.getElementById('wwopopupTextArea').style.display='none';document.getElementById('wwotaCommnt').value='';document.getElementById('wwoaddCmntBttn').style.display='block';">[X]</a>
            <textarea id="wwotaCommnt" class="wwotextAreaPopup"></textarea>
            <a id="wwoaddCmntBttn" style="position: fixed; left: 65.4%; top: 77%;" class="slds-button slds-button--neutral slds-button--brand">Add Comment</a>
    </div>
    <a class="slds-button slds-button--neutral slds-button--brand" id="prntWWO" onclick="printWWO(this);" style="display:none; position: fixed; z-index: 99; left: 96.2%;%; top: 14%; width: 43px; height:40px;" title="Print">
        <apex:image id="printIcon" value="{!URLFOR($Resource.Print)}" width="40" height="40" />
    </a>
    <a class="slds-button slds-button--neutral slds-button--brand" id="ScheduleWWoo" style="display: none; position: fixed; z-index: 99; left: 96%; top: 26%; width: 40px; height:40px;" title="Schedule">
        <apex:image id="scheduleWwOOIcon" value="{!URLFOR($Resource.ScheduleClock)}" width="40" height="40" />
    </a>
    <a class="slds-button slds-button--neutral slds-button--brand" id="backToListWWO" onclick="backtolistWWO();" style="display:none; position: fixed; z-index: 99; left: 96%; top: 20%; width: 43px;height:40px;" title="Back To List">
        <apex:image id="BackToListIcon" value="{!URLFOR($Resource.BackToList)}" width="40" height="40" /> 
    </a>
    <a id="refereshBtnWWO" class="slds-button slds-button_icon" style="display:none; position: fixed; z-index: 99; left: 96%; top: 32%;background-color: #29abe2;" title= "Referesh">
	      <apex:image id="refereshBtnWWOICN" value="{!URLFOR($Resource.RefreshIcon)}" width="40" height="40" />
	  </a>
	  <a id="updatecusnotificationwwo" onclick="updatecusnotificationWwOBtn(this,'{!objCase.Id}');" class="slds-button slds-button_icon" style="display: none; position: fixed; z-index: 99; left: 96%; top: 38%;background-color: #29abe2;" title= "Update Customer">
          <apex:image id="updateCustomerIconwwo" value="{!URLFOR($Resource.UpdateCustomer)}" width="40" height="40" />
      </a>
	  <a id="WWO_TWO" class="slds-button slds-button_icon" style=" display:none;position: fixed; z-index: 99; left: 96%; top: 44%;background-color: #29abe2;" title= "Tech Work Order">
<!-- 	      TWO -->
	      <img src="https://cdn.iconscout.com/icon/premium/png-256-thumb/technician-2-197670.png"/>
	  </a>
	  	<div style="position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 999999; background: #00000091; display: none;" id="wwojobTechlookupId">
	    	<input type="hidden" id="wwodivNumLkUp" value=""/>
	    	<div style="background: #fff; position: absolute; width: 400px; height: 18%; padding: 1%; left: 36%; top: 28%; border-radius: .25em; border: 2px solid #000000ad;">
	    		<a class="slds-button slds-button_icon" onclick="wwocloseLookUp();" style="position: relative; left: 94%;">[X]</a>
	    		<br/>
	<!--     		<apex:inputField value="{!objJob.Technician__c}" styleClass="slds-input"  id="jobTechLookupIF" /> -->
	    		<apex:selectList size="1" value="{!selectedTech}" id="wwojobTechLookupIF" style="height: 34px;" styleClass="slds-select">
	                <apex:selectOptions value="{!techList}"/> 
	            </apex:selectList>
	    		<br/> 
	    		<br/> 
	    		<a class="slds-button slds-button--brand" style="position: relative; left: 90%;" onclick="wwoaddTechToJob();">OK</a>
	    	</div>
    	</div>
			<script>
			function wwocloseLookUp() {
	    		$("#wwojobTechlookupId").fadeOut();
	    		$("#wwojobTechlookupId").fadeOut(); 
	   			$("#wwodivNumLkUp").val("");
	   			//document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:jobTechLookupIF_lkid").value = '000000000000000';
	   			document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:wwojobTechLookupIF").value = '0';
	    	}
	    	function wwoaddTechnician(divNum) { 
	    		$("#wwodivNumLkUp").val(divNum);
	    		$("#wwojobTechlookupId").fadeIn();
	    		var jid = $("#wwojbTechId"+divNum).val();
	    		var jName = $("#wwotechName"+divNum).html();
	    		//document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:jobTechLookupIF_lkid").value = jid;
	    		if(jid != '') {
	    			document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:wwojobTechLookupIF").value = jid;
	   			} else {
	   				document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:wwojobTechLookupIF").value = '0';
	   			}
	    	}
    	
    	function wwoaddTechToJob() {
    		var divId = $("#wwodivNumLkUp").val();
    		var techId = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:wwojobTechLookupIF").value;
    		if(techId != '0') { 
	    		BOATBUILDING.WorkOrderControllerClone.getUserInfo(techId, function(result, event) {
	    			
	    			var objUser = result;
	    			console.log(objUser);
	    			$("#wwojbTechId"+divId).val(objUser.Id);
	    			$("#wwotechName"+divId).html(objUser.Name);
	    			$("#wwojobTechlookupId").fadeOut(); 
	    			$("#wwodivNumLkUp").val("");
	    			//document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:jobTechLookupIF_lkid").value = '000000000000000';
	    			document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:wwojobTechLookupIF").value = '0';  
	    		});
    		}
    	}
			
			
				$("#refereshBtnWWO").click(function() {
					
					$("#WwoAddressId").val("");
           			$("#WwoCityId").val("");
           			$("#WwoZipId").val("");
           			$("#WwoPhoneId").val("");
           			$("#WwoEmailId").val("");
           			$("#WwoHinId").val("");
           			$("#WwoEngSnId").val("");
           			$("#WwoEngSnId1").val("");
           			$("#WwoEngSnId2").val("");
           			$("#WwoEngSnId3").val("");
           			$("#WwoEngSnId4").val("");
           			
           			$("#WwoTvinId").val("");
           			$("#WwODriveId").val("");
           			$("#WwOHoursId").val("");
				
					var woId = $("#WWOcaseHiddenId").val();
					var woName = $("#WWONameEdit").val();
					var woStatus = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus").value;
					var woBalance = $("#Wwograndtotal_balance").val();
					console.log(woId);
					console.log(woName);
					console.log(woStatus);
					console.log(woBalance);
					$("#WwoAddDivForJob").html("");
					Wwolstjob = [];
					document.getElementById("WwoDivValue").value = '0';
					fetchWrntyWorkOrder(this, woId, woName,  woBalance, woStatus);
				});
				$("#WWO_TWO").click(function() {
					$('.popup').addClass('active');
            		var woId = $("#WWOcaseHiddenId").val();
					var woName = $("#WWONameEdit").val();
			        openCity(event, 'workReq');
			        document.getElementById("tab-default-10__item").click();
			        document.getElementById("pge:frm:tchWrkOrderCompCall:tchWrkOrdr:existingWorkOrdersId_lkid").value = woId;    
			        document.getElementById("pge:frm:tchWrkOrderCompCall:tchWrkOrdr:existingWorkOrdersId").value  = woName;
			        fetchWorkOrderParameters(this);
           		});
           		function updatecusnotificationWwOBtn(obj, objWorkOrderId){
        
			        var currentdate = new Date(); 
			        var dateTime = currentdate.getFullYear()+'-'+padd(String(currentdate.getMonth()+1))+'-'+padd(String(currentdate.getDate()))+'T'+padd(String(currentdate.getHours()))+":"+padd(String(currentdate.getMinutes()))+":"+padd(String(currentdate.getSeconds()))+'.000';
			        //$("").val(dateTime); 
			        console.log(dateTime);
			        document.getElementById("LastupdateDatewwo").value = dateTime;
			        console.log('false');
			        updateCusNotificationContwwo('1');
			        
			        woId1 = $("#WWOcaseHiddenId").val();
			        //document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:RelatedworkOrder1").value = $("#WWONameEdit").val();
			        //document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:PaymentAmount1").value = "";
			        //document.getElementById("TotalAmountDue1").value = $("#grandtotal_balance").val();
			    }
			    function ucWWO() {
			    	console.log('Test');
			        updateCusNotificationContwwo('2');
			    }
			    
			    function updateCusNotificationContwwo(isCreate){
			        //var lastUpdateDate = document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:LastupdateDate").value;
			        var lastUpdateDate = document.getElementById("LastupdateDatewwo").value;
			        var customerNotes = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:CustomerNoteswwo").value;
			        var activityType = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:activityTypewwo").value;
			        if(lastUpdateDate == null){
			            lastUpdateDate = '';
			        }
			        if(customerNotes == null){
			            customerNotes = '';
			        }
			        woId1 = $("#WWOcaseHiddenId").val();
			        console.log('lastUpdateDate--'+lastUpdateDate);
			        //document.getElementById('idupdnotificationwwo').style.display='block';
			        debugger;
			        console.log('customerNotes--'+customerNotes);
			        console.log('isCreate--'+isCreate);
			        console.log('woId1--'+woId1);
			        BOATBUILDING.WarrantyWorkOrderControllerClone.updatecusnotification(woId1,activityType,lastUpdateDate,customerNotes,isCreate,function(result, event) {
			            if(event.status) {
			                console.log(result);
			                if(isCreate == '2'){
			                    $('#idupdnotificationwwo').fadeOut();
			                    window.top.location = "/apex/BOATBUILDING__ServicePage?type=WWO&WWOId="+$("#WWONameEdit").val();
			                } else if(isCreate == '1'){
			                    console.log('In Fetched');      
			                    document.getElementById('idupdnotificationwwo').style.display='block';
			                    var htmlDiv = '';
			                    console.log('result-updatecusnotification---'+result);
			                    // Customer updates comments.
			                    if(result.length > 0) {
			                        if(result[0].length > 0){
			                            var custUpdate = result[0];
			                            console.log('custUpdate---'+custUpdate);
			                            console.log(custUpdate);
			                            for(var i = 0; i < custUpdate.length; i++) {
			                                if(custUpdate[i].includes('@-@')) {
			                                    var lst = custUpdate[i].split('@-@');
			                                    console.log(lst);
			                                    var dateTimeVar = lst[0];
			                                    var comment = ''
			                                    if( lst[1].trim() != '' && lst[1].trim() != 'null')
			                                   		comment = lst[1];
			                                    var sub = lst[2]; 
			                                    htmlDiv += '<div class="slds-timeline__item"> <span class="slds-assistive-text">Call</span> <div class="slds-media"> <div class="slds-media__body"> <div class="slds-media slds-timeline__media slds-timeline__media_call"> <div class="slds-media__figure slds-timeline__icon"> <div class="slds-icon_container slds-icon-standard-log-a-call" title="call"> <img src="/resource/BOATBUILDING__UpdateCustomer" height="30" width="30"> </div> </div> <div class="slds-media__body"> <h3 class="slds-truncate" title="Date: ">'+dateTimeVar+' ('+sub+')</h3> <p class="slds-truncate" title="Customer Notes">'+comment+'</p> </div> </div> </div> </div> </div>';
			                                }
			                            }
			                        }
			                    }
			                    
			                    // Customer Job comments.
			                    var customerCommentsHTML = '';
			                    if(result.length > 1) {
			                        if(result[1].length > 0){
			                            var custComments = result[1];
			                            for(var i = 0; i < custComments.length; i++) {
			                                var comment = custComments[i]; 
			                                customerCommentsHTML += '<div class="slds-timeline__item"> <span class="slds-assistive-text">Call</span> <div class="slds-media"> <div class="slds-media__body"> <div class="slds-media slds-timeline__media slds-timeline__media_call"> <div class="slds-media__figure slds-timeline__icon"> <div class="slds-icon_container slds-icon-standard-log-a-call" title="call"> <img src="/resource/BOATBUILDING__UpdateCustomer" height="30" width="30"> </div> </div> <div class="slds-media__body"> <p class="slds-truncate" title="Customer Notes">'+comment+'</p> </div> </div> </div> </div> </div>';
			                            }
			                        } else {
			                            customerCommentsHTML += 'No Comments.';
			                        }
			                    }
			                    
			                    // Service Writer comments.
			                    var swCommentsHTML = '';
			                    if(result.length > 2) {
			                        if(result[2].length > 0){
			                            var swComments = result[2];
			                            for(var i = 0; i < swComments.length; i++) {
			                                var comment = swComments[i]; 
			                                swCommentsHTML += '<div class="slds-timeline__item"> <span class="slds-assistive-text">Call</span> <div class="slds-media"> <div class="slds-media__body"> <div class="slds-media slds-timeline__media slds-timeline__media_call"> <div class="slds-media__figure slds-timeline__icon"> <div class="slds-icon_container slds-icon-standard-log-a-call" title="call"> <img src="/resource/BOATBUILDING__UpdateCustomer" height="30" width="30"> </div> </div> <div class="slds-media__body"> <p class="slds-truncate" title="Customer Notes">'+comment+'</p> </div> </div> </div> </div> </div>';
			                            }
			                        } else {
			                            swCommentsHTML += 'No Comments.';
			                        }
			                    }
			                    
			                    // Technician comments.
			                    var techCommentHTML = '';
			                    if(result.length > 3) {
			                        if(result[3].length > 0){
			                            var techComments = result[3];
			                            for(var i = 0; i < techComments.length; i++) {
			                                var comment = techComments[i]; 
			                                techCommentHTML += '<div class="slds-timeline__item"> <div class="slds-media"> <div class="slds-media__body"> <div class="slds-media slds-timeline__media slds-timeline__media_call"> <div class="slds-media__figure slds-timeline__icon"> <div class="slds-icon_container slds-icon-standard-log-a-call" title="call"> <img src="/resource/BOATBUILDING__UpdateCustomer" height="30" width="30"> </div> </div> <div class="slds-media__body"> <p class="slds-truncate" title="Customer Notes">'+comment+'</p> </div> </div> </div> </div> </div>';
			                            }
			                        } else {
			                            techCommentHTML += 'No Comments.';
			                        }
			                    }
			                    
			                    $("#rcntCmntwwo").html(htmlDiv);
			                    $("#customerCommentwwo").html(customerCommentsHTML);
			                    $("#swCommentwwo").html(swCommentsHTML);
			                    $("#technicianCommentwwo").html(techCommentHTML);
			                }
			            } 
			        });
			    }
			    function closeSignwwo2() {
			        $('#idupdnotificationwwo').fadeOut();
			    }
			</script>
			
			<div id="idupdnotificationwwo" class="modal" >
            
	            <div class="modal-content animate" style="height: 90%; width: 80%;overflow: auto;">
	                <div class="slds-grid slds-wrap slds-col--padded slds-m-top--medium slds-align--absolute-center">
	                    <div class="slds-col slds-size--1-of-1">
	                        <a id="updatenotificationbtnwwo" onclick="ucWWO();" style="margin-left: 45%;" class="slds-button slds-button--brand">Update</a>
	                        
	                    </div>
	                    
	                </div>
	                
	                <a style="position: relative;left: 93.8%;" onclick="closeSignwwo2();"><i class="fa fa-times fa-lg __web-inspector-hide-shortcut__" aria-hidden="true"></i></a>
	                <div class="slds-grid">
	                    <div class="slds-col">
	                        <section style="padding: 2%;">
	                            <div class="slds-col slds-size--1-of-1">
	                                <div class="slds-grid slds-wrap">
	                                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-1 slds-col--padded">
	                                        <div class="slds-form-element">
	                                            <label class="slds-form-element__label">Activity Type</label>
	                                            <div class="slds-form-element__control">
	                                                <apex:selectList style="width: 80%;" size="1" styleClass="slds-input-select" id="activityTypewwo">
	                                                    <apex:selectOption itemLabel="Log a Call" itemValue="Log a Call" />
	                                                    <apex:selectOption itemLabel="Email" itemValue="Email" />
	                                                </apex:selectList>
	                                            </div>
	                                        </div>
	                                    </div>
	                                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-1 slds-col--padded">
	                                        <div class="slds-form-element">
	                                            <label class="slds-form-element__label">Customer Last Updated</label>
	                                            <div class="slds-form-element__control">
	                                                <!--<apex:inputField value="{!objCase.Customer_Last_updated__c}" styleClass="slds-input" id="LastupdateDate" />-->
	                                                <input type="datetime-local" style="width: 80%;" class="slds-input" id="LastupdateDatewwo" disabled="disabled"/>
	                                            </div>
	                                        </div>
	                                    </div>
	                                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-1 slds-col--padded">
	                                        <div class="slds-form-element">
	                                            <label class="slds-form-element__label">Customer Notes</label>
	                                            <div class="slds-form-element__control">
	                                                <apex:inputField value="{!objCase.Customer_Notes__c}" styleClass="slds-input" id="CustomerNoteswwo" />
	                                            </div>
	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
	                        </section>
	                    </div>
	                    <!--Updates for Akshay-->
	                    <div class="slds-col">
	                        <div style="position: relative;padding: 15px; font-size: 20px;">
	                            Recent Comments
	                        </div>
	                        <!--<apex:repeat value="{!mapTimeToCustomerNotes}" var="item">-->
	                        <span id="rcntCmntwwo">
	                            
	                        </span>
	                        
	                        <div style="position: relative;padding: 15px; font-size: 20px;">
	                            Customer Comments
	                        </div>
	                        <span id="customerCommentwwo">
	                            
	                        </span>
	                        
	                        <div style="position: relative;padding: 15px; font-size: 20px;">
	                            Service Writer Comments
	                        </div>
	                        
	                        <span id="swCommentwwo">
	                            
	                        </span>
	                        
	                        <div style="position: relative;padding: 15px; font-size: 20px;">
	                            Technician Comments
	                        </div>
	                        <span id="technicianCommentwwo">
	                            
	                        </span>
	                        <!--</apex:repeat>-->
	                    </div>
	                </div>
	            </div>
	        </div> 
			
			
			<div id="addPymtPop" class="popupBack" style="display: none;">
				
				<div class="innerPopup">
					<input type="hidden" value="" id="wwoPaymentJobDivNum"/> 
					<input type="hidden" value="" id="wwoPaymentJobId"/>
					<a style="position: relative; left: 94%; color: red;" onclick="closePop();"><i class="fa fa-window-close" aria-hidden="true"></i></a>
					<table cellspacing="5" style="margin: 5px;">
						<tbody>
							<tr>
								<td style="padding: 3px;width: 200px;">
									Claim Labor Paid Amount:
								</td>
									<td>
										<input value="0.00" onkeypress="return isNumberKey(event)" id="wwoClmLbrPdAmt" style="width: 140px;" type="text" class="slds-input"/>
									</td>
								</tr>
								<tr>
									<td style="padding: 3px;width: 200px;">
										Parts Paid Amount:
									</td>
									<td>
										<input value="0.00" onkeypress="return isNumberKey(event)"  id="wwoPrtPdAmt" style="width: 140px;" type="text" class="slds-input"/>
									</td>
								</tr>
								<tr>
									<td style="padding: 3px;width: 200px;">
										Misc Charge Paid ($):
									</td>
									<td>
										<input onkeypress="return isNumberKey(event)" id="wwoMicsChrgp" style="width: 140px;" type="text" value="0.00" class="slds-input"/>
									</td>
								</tr>
								<tr>
									<td style="padding: 3px; text-align: center;" colspan="2">
										<a id="addPaymentOnWWO"  class="slds-button slds-button--brand">Add Payment</a>
									</td>
								</tr>
							</tbody>
						</table>
				</div>
			</div>
			
    <input type="hidden" id="WWOcaseHiddenId"/>
    <input type="hidden" id="WWOcaseHiddenStatus"/> 
    <div id="wrntyworkOrderListViewDiv">
        <div class="slds-grid slds-wrap slds-col--padded slds-m-top--medium slds-align--absolute-center">
            <div class="slds-col slds-size--1-of-1">
                <a id="wrntycreateWrkOrdrOnLstDiv" style="margin-left: 45%;" class="slds-button slds-button--brand">Create Work Order</a>
            </div>
        </div>
        <div class="slds-grid slds-wrap slds-col--padded slds-m-top--medium slds-align--absolute-center">
            <div class="slds-col slds-size--1-of-1">
	            <apex:outputPanel id="wwolstIdOP">
	                <table id="wwolstId" class="show slds-table slds-table--bordered slds-no-row-hover slds-table--cell-buffer slds-m-top--x-large Table1 slds-card">
	                    <thead>
	                        <tr>
	                            <th>Work Order Number</th>
	                            <th>Contact Name</th>
	                            <th>Boat Name</th> 
	                            <th>Status</th> 
	                            <th>Schedule</th> 
	                        </tr> 
	                    </thead>
	                    <tbody> 
	                        <apex:repeat value="{!WarrantyWorkOrderList}" var="objCase">
	                            <tr>
	                                <td>
	                                    <a href="javascript:void(0);" onclick="fetchWrntyWorkOrder(this,'{!objCase.Id}','{!objCase.Name}','{!objCase.Balance__c}','{!objCase.Status__c}');">
	                                        {!objCase.Name}
	                                    </a>
	                                    &nbsp; <a href="/apex/BOATBUILDING__ServicePage?type=WWO&WWOId={!objCase.Name}" target="blank"><img src="https://image.flaticon.com/icons/png/512/376/376007.png" style="height: 10px; width: 10px;"/></a> 
	                                </td>
	                                <td>
	                                    {!objCase.BOATBUILDING__Contact__r.Name}
	                                </td>
	                                <td>
	                                    {!objCase.Boat__r.Name}
	                                </td>
	                                <td>
	                                    {!objCase.Status__c}
	                                </td>
	                                <td> 
	                                    <apex:outputPanel rendered="{!if(objCase.Status__c == 'Closed', false, true)}">
	                                        <a onclick="redirectToSceduleWWO('{!objCase.Id}', '{!objCase.Name}');" herf="javascript:void(0);">Schedule</a>
	                                    </apex:outputPanel> 
	                                    <apex:outputPanel rendered="{!if(objCase.Status__c == 'Closed', true, false)}">
	                                        &nbsp;
	                                    </apex:outputPanel>
	                                </td>
	                            </tr>
	                        </apex:repeat>
	                    </tbody>
	                </table>
                </apex:outputPanel>
            </div>
        </div> 
        <script>
             $(document).ready(function() {
                $("#wwolstId").DataTable( {
                  "pageLength": 25,
                  "lengthMenu": [[25, 50, -1], [25, 50, "All"]],
                  "order": [[ 0, "desc" ]]
                } );
                 
                BOATBUILDING.WarrantyWorkOrderControllerClone.fetchWorkTypePricingDetails(function(result, event) {
                    if(event.status) {
                        if(result != null) {
                            warrntyWorkTypeList = result;
                            if(warrntyWorkTypeList.length > 0) {
                                for(var i = 0; i < warrntyWorkTypeList.length; i++) {
                                		if(workTypeList[i].BOATBUILDING__Active__c == true)
                                    			$("#WwoWorkTypeIdselect").append("<option value="+warrntyWorkTypeList[i].BOATBUILDING__Price__c+">"+warrntyWorkTypeList[i].Name+"</option>");
                                }
                            }
                        }
                    }
                });
                 
            });
            function redirectToSceduleWWO(woId, woName) {
                openCity(event, 'schedule'); 
                addWOToEvent(woId, woName);
            }
            
            $("#ScheduleWWoo").click(function() {
                var wwocaseId = $("#WWOcaseHiddenId").val();
                var wwocaseName = $("#WWONameEdit").val();
                redirectToSceduleWWO(wwocaseId, wwocaseName);
            });
            
			function closePop() {
      			$("#addPymtPop").fadeOut();
      		}
			$("#addPaymentOnWWO").click(function() {
				//wwoPaymentJobDivNum wwoPaymentJobId
				var divNum = $("#wwoPaymentJobDivNum").val();
				var jobId = $("#wwoPaymentJobId").val();
				if(jobId != '0'){
					
					$("#paymentStatus"+divNum).val("1");
					
					$("#wwoClmLbrPdAmt"+divNum).val($("#wwoClmLbrPdAmt").val());
					$("#wwoPrtPdAmt"+divNum).val($("#wwoPrtPdAmt").val());
					$("#wwoMicsChrgp"+divNum).val($("#wwoMicsChrgp").val());
					calculateWarrantySection(divNum);
					$("#addPymtPop").fadeOut();
					
				} else {
					//wwoClmStts wwoClmDt wwoClmApprvl wwoClmlbrAppAmo wwoRtrnPdAmt wwoClmPdDate wwoClmLbrPdAmt wwoPrtPdAmt wwoMicsChrgp
					$("#paymentStatus"+divNum).val("1");
					
					$("#wwoClmLbrPdAmt"+divNum).val($("#wwoClmLbrPdAmt").val());
					$("#wwoPrtPdAmt"+divNum).val($("#wwoPrtPdAmt").val());
					$("#wwoMicsChrgp"+divNum).val($("#wwoMicsChrgp").val());
					calculateWarrantySection(divNum);
					$("#addPymtPop").fadeOut();
				}
			});
        </script>
    </div> 
    <div id="wrntyworkOrderFormDiv" style="display: none;">
        <div class="wwoisa_error" id="wwoerrorDiv" style="display: none;">
           <i class="fa fa-times-circle"></i>
           <span id="wwoerrSnap"></span> 
        </div>
    
        <div class="slds-grid slds-wrap slds-col--padded">
            <!-- work order section user details -->
            <div class="slds-col slds-size--1-of-1">
                <div class="slds-grid slds-wrap">
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Customer Name<span style="color: red;">*</span></label>
                            <div class="slds-form-element__control">
                                <apex:inputField value="{!objCase.Contact__c}" OnChange="fetchRelatedContactWWo(this)" id="WwoconWrkId2" />
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Address</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoAddressId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">City</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoCityId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Zip</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoZipId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Phone Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoPhoneId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Email</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEmailId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                            <div class="slds-form-element">
                                <label class="slds-form-element__label">Boat<span style="color: red;">*</span></label>
                                <div class="slds-form-element__control">
                                    <apex:inputField value="{!objCase.Boat__c}" id="WwoboatLookId" onchange="fetchBoatFromItemWWo(this);"/>
                                </div>
                            </div>
                        </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Boat Hin</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoHinId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Engine SN</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEngSnId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Engine 1 Serial Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEngSnId1" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Engine 2 Serial Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEngSnId2" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded"> 
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Engine 3 Serial Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEngSnId3" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Engine 4 Serial Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoEngSnId4" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Trailer Vin</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoTvinId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Drive#</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WwODriveId"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Hrs</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WwOHoursId"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Waranty Work Order Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWONameEdit" value="Will show in classic" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Date Created</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoDateCrtedId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Boat Make</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoMakeId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Boat Model</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoModelId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Customer Type</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoCT" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Boat Year</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoYearId" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                   
                   <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Boat Registration Number</label>
                            <div class="slds-form-element__control">
                                <input class="slds-input" type="text" id="WWoBRN" disabled="disabled"/>
                            </div>
                        </div>
                    </div>
                   
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Status<span style="color: red;">*</span></label>
                            <div class="slds-form-element__control">
                                 <apex:inputField value="{!objCase.Status__c}" styleClass="slds-select" id="WWoStatus" />
                            </div>
                        </div>
                    </div>
                    
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">Store Location<span style="color: red;">*</span></label>
                            <div class="slds-form-element__control">
                                 <apex:inputField value="{!objCase.Store_Location__c}" styleClass="slds-select" id="WWoStoreLocation" />
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
	                    <div class="slds-form-element">
	                        <label class="slds-form-element__label">Customer Boat Status</label>
	                        <div class="slds-form-element__control">
	                           <apex:inputField value="{!objCase.Customer_Boat_Status__c}"  styleClass="slds-select" id="WoCBS" />
	                        </div>
	                    </div>
	                </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-small-size--1-of-2 slds-col--padded">
                   <div class="slds-form-element">
                       <label class="slds-form-element__label">Available Promocode</label>
                       <div class="slds-form-element__control">
                          <select class="slds-select" id="wwoPromocode" onchange="wwopromoChange();">
                          		<option value="0">--None--</option>
                          </select>
                       </div>
                   </div>
               </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                    <div class="slds-form-element">
                        <label class="slds-form-element__label">&nbsp;</label>
                        <div class="slds-form-element__control">
                            &nbsp;
                        </div>
                    </div>
                </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--3-of-4 slds-col--padded">
                    
                </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                    <div class="slds-form-element">
                        <label class="slds-form-element__label">&nbsp;</label>
                        <div class="slds-form-element__control">
                            <a id="frmBtnwwo"  class="slds-button slds-button_icon" style="display: none;background-color: #29abe2; background-color: #29abe2; width: 100%;" title= "Inspection Form">
	                             <apex:image id="frmBtnIcnwwo" value="{!URLFOR($Resource.Form)}"  width="20" height="20" />&nbsp;Inspection Form
	                         </a>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        <script>
        		$("#frmBtnwwo").click(function() {
       			var woId = $("#WWOcaseHiddenId").val();
       			window.open('/apex/BOATBUILDING__ServiceInspectionForm?woId='+woId);
       		});
        </script>
        <div class="slds-grid slds-wrap slds-col--padded slds-m-top--medium">
            <div class="slds-col slds-size--1-of-1 slds-medium-size--3-of-4 slds-col--padded">
                <div class="slds-card">
                    <div class="slds-card__body">
                    <div style="padding: 1%;">
                    		<a class="slds-button slds-button--brand" id="wwoaddCannedJobBtn">Add Canned Job</a>
                    		<a class="slds-button slds-button--brand" id="wwoaddNewJobBtn">Add new Job</a>
                    	</div>
                    <div id="WwoExistingJobPanel" style="display: none;">
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Existing Jobs</label>
                                    <div class="slds-form-element__control">
                                    <apex:selectList size="1" value="{!selectedJob}" label="Existing Jobs: " id="sl1" styleClass="slds-select chosenWWO" onchange="WwogetJobParameters(this);">
                                        <apex:selectOptions value="{!lstJobs}" id="Wwoso1"/>
                                        <!-- <apex:actionSupport event="onchange"  action="" reRender="TechWOExistingJobPanel"/> -->
                                    </apex:selectList>  
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Work Requested</label>
                                    <div class="slds-form-element__control">
                                        <input id="WWoWrkRequested" class="slds-input" type="text" disabled="disabled"/>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Work Type</label>
                                    <div class="slds-form-element__control">
                                        <input id="WWoWrkType" class="slds-input" type="text" disabled="disabled"/>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Type</label>
                                    <div class="slds-form-element__control">
                                        <input id="WWoJobType" class="slds-input" type="text" disabled="disabled"/>
                                    </div>
                                </div>
                            </div>
                        </div>                                                                
                        <div class="slds-grid slds-wrap" style="padding-bottom:10px;">
                            
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                             <div class="slds-form-element">
                                    <label class="slds-form-element__label">&nbsp;</label>
                                    <div class="slds-form-element__control">
                                        <a class="slds-button slds-button--brand" id="WwoAddjob">Add Canned Job</a>
<!--                                          <label id="wwoorLb">OR</label> -->
<!--                                         <a class="slds-button slds-button--brand" id="WwoAddnewjob">Add New Job</a> -->
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                             <div class="slds-form-element">
                                    
                                </div>
                            </div>
                        </div>
                        </div>
                        <div id="WwoshowaddjobPanel"  style="display: none;">
                        &nbsp;&nbsp;&nbsp;&nbsp;<label class="slds-form-element__label">Add New Job</label>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Job Name</label>
                                    <div class="slds-form-element__control">
                                        <input class="slds-input" type="text" id="WwonewjobNameId"/>
                                    </div>
                                </div>    
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Work Requested</label>
                                    <div class="slds-form-element__control">
                                        <input class="slds-input" type="text" id="Wwonewjobworequested"/>
                                    </div>
                                </div>    
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Work Type</label>
                                    <div class="slds-form-element__control">
<!--                                    <apex:inputField value="{!objJob.Work_Type__c}" styleClass="slds-input" id="WwoWorkTypeId" /> -->
                                    <select class="slds-select" id="WwoWorkTypeIdselect">
                                        <option value="0">--None--</option>
                                    </select>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">Type</label>
                                    <div class="slds-form-element__control">
                                        <apex:inputField value="{!objJob.Type__c}" styleClass="slds-input" id="WwoTypeWorkId" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size--1-of-1 slds-align--absolute-center Create_button slds-col--padded ">
                                <div class="slds-form-element" style="position: relative; right: 47%;">
                                    <label class="slds-form-element__label">&nbsp;</label>
                                    <div class="slds-form-element__control" style="margin-bottom: 8px;">
                                        <a id="WwoNewJobBtn" class="slds-button slds-button--neutral slds-button--brand inside_row_button" type="button">Add Job</a>
<!--                                         <a class="slds-button slds-button--neutral slds-button--brand inside_row_button " type="button" id="WwoHideNewjobPanel">Cancel</a> -->
                                    </div>
                                </div>
                            </div>
                        </div>  
                        </div>          
                    </div>
                </div>
            </div>
            
        </div>
        <div id="WwoShowjobList" style="display:none;">
        <div class="slds-grid slds-wrap slds-col--padded slds-m-top--medium" id="Wwocreatejobpanel">
            <input type="hidden" name="WwoDivValue" id="WwoDivValue" value="0" />
            <div class="slds-col slds-size--1-of-1 slds-medium-size--3-of-4 slds-col--padded" id="WwoAddDivForJob">
    
            </div>
            
            <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-col--padded">
                <div class="slds-card">
                    <div class="slds-card__body">
                        <table class="slds-table slds-table--bordered">
                            <tbody>
                                <tr>
                                    <th>Total Parts</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_parts" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Total Labor</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_labor" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                
                                <tr>
                                    <th>Total</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_total" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                
                                <tr>
                                    <th>Total Amount Due</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_amount_due" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                
                                <tr>
                                    <th>Discount On Job</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="WwograndtotalDiscount"  type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                
                                <tr>
                                    <th>Total Misc Charge</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="wwoTotalMiscCharge"  type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                
                                <tr>
                                    <th>Total Payment</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_payment" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Discount On WO</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="WwodiscountOnWO" type="text" onKeyPress="return isNumberKey(event);" onkeyup="Wwocalculate_totalofallJobDiv();"/>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Balance</th>
                                    <th>
                                        <i class="fa fa-usd" style="position: absolute;margin-top: 7%;margin-left: 2.5%;" aria-hidden="true"></i>
                                        <input class="slds-input" id="Wwograndtotal_balance" type="text" disabled="disabled"/>
                                    </th>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
        </div>
        </div>
        <div id="Wwohiddenbtn" class="slds-grid slds-wrap slds-col--padded slds-m-top--medium slds-align--absolute-center">
            <div class="slds-col slds-size--1-of-1" style="position: fixed; top: 92%; left: 43%; ">
                <a id="createWwoorder" style="margin-left: 33%; box-shadow: 0 10px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19) !important;" class="slds-button slds-button--brand">Create Warranty Work Order</a>
                <a id="cancelWwoorder" class="slds-button slds-button--brand" style="box-shadow: 0 10px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19) !important;">Back to List</a>
            </div>
        </div> 
    </div>  
    
    <div id="WWOPymntModl" class="modal" >
        <div class="modal-content animate" style="height: 90%; width: 80%;overflow: auto;">
            <a style="position: absolute;left: 86.8%;" id="WWOcloseSign33"><i class="fa fa-times fa-lg __web-inspector-hide-shortcut__" aria-hidden="true"></i></a>
               <section style="padding: 2%;">
                <b>Add Part</b><hr/>
                <label><b>Part Number/Part Name: </b></label>
                &nbsp;<input type="text" style="width: 20%;" id="WWOprtDetailInput" class="slds-input"/>
                <button style="width: auto;" class="slds-button slds-button--neutral slds-button--brand inside_row_button " id="WWOprtSrchBtn" type="button" >Search</button>
                <div class="spinnerClass" id="WWOspinner" style="display: none;">
                    <i  class="fa fa-spinner fa-spin fa-3x fa-fw margin-bottom fa-5x" style="margin-left: 45%; margin-top: 23%;" aria-hidden="true"></i>
                </div>
                <div id="WWOselectedPrntDiv" style="display: none;">
                    <hr/>
                    <label><b>Selected Parts: </b></label>
                    <div id="WWOselectedPrtDiv">
                         
                    </div>
                    <div>
                        <a style="width: auto;position: relative;left: 91.5%;" class="slds-button slds-button--neutral slds-button--brand inside_row_button" id="WWOaddToCrt" type="button" >Add To Job</a>
                    </div>
                </div>
                <div id="WWOpartResultDiv" style="display: none;"> 
                    <hr/>
                    <div id="WWOrsltLstDiv">
                    
                    </div>
                </div>
               </section>
        </div>
    </div>


    <div id="WWOPymntModlnewjob" class="modal" >
        <div class="modal-content animate" style="height: 90%; width: 80%;overflow: auto;">
            <a style="position: absolute;left: 86.8%;" id="WWOcloseSign33newjob"><i class="fa fa-times fa-lg __web-inspector-hide-shortcut__" aria-hidden="true"></i></a>
               <section style="padding: 2%;">
                <b>Add Part</b><hr/>
                <label><b>Part Number/Part Name: </b></label>
                &nbsp;<input type="text" style="width: 20%;" id="WWOprtDetailInputnewjob" class="slds-input"/>
                <button style="width: auto;" class="slds-button slds-button--neutral slds-button--brand inside_row_button " id="WWOprtSrchBtnnewjob" type="button" >Search</button>
                <div class="spinnerClass" id="WWOspinnernewjob" style="display: none;">
                    <i  class="fa fa-spinner fa-spin fa-3x fa-fw margin-bottom fa-5x" style="margin-left: 45%; margin-top: 23%;" aria-hidden="true"></i>
                </div>
                <div id="WWOselectedPrntDivnewjob" style="display: none;">
                    <hr/>
                    <label><b>Selected Parts: </b></label>
                    <div id="WWOselectedPrtDivnewjob">
                         
                    </div>
                    <div>
                        <a style="width: auto;position: relative;left: 91.5%;" class="slds-button slds-button--neutral slds-button--brand inside_row_button" id="WWOaddToCrtnewjob" type="button" >Add To Job</a>
                    </div>
                </div>
                <div id="WWOpartResultDivnewjob" style="display: none;"> 
                    <hr/>
                    <div id="WWOrsltLstDivnewjob">
                    
                    </div>
                </div>
               </section>
        </div>
    </div>


    <script>
    var WWOaddJobDiv = 0;
    var WWOjobIndex = '';
    var WWOjobIdForCart = '';  
    var wwopromo = '0'
    var wwolstSelectedPartNumber = [];
    var wwolstParts = [];
    var wwomapForQuantity = new Object();
    var lstClaimStatus = [];
    $(document).ready(function() {
        BOATBUILDING.WarrantyWorkOrderControllerClone.getClaimStatus(function(result, event) {
            if(event.status) {
                if(result != null) {
                   lstClaimStatus = result; 
//                    if(lstClaimStatus.length > 0) {
// 			            for(var i=0; i<lstClaimStatus.length; i++) {
// 			                $("#wwoClmStts").append("<option value='"+lstClaimStatus[i]+"'>"+lstClaimStatus[i]+"</option>"); 
// 			            }
// 			        }
                }    
            }
        });
    });
     
   
   function wwopromoChange() {
       	var pc = $("#wwoPromocode").val();
       	if(pc != '0') {
       	$('.popup').addClass('active');
       		BOATBUILDING.WarrantyWorkOrderControllerClone.getPromocodeDetail(pc, function(result, event) {
                       $('.popup').removeClass('active');
                       if(result != null) { 
                           if(result.BOATBUILDING__Discount_In__c != undefined) {
                           	if(result.BOATBUILDING__Discount_In__c == 'Amount') {
                           		$("#WwodiscountOnWO").val(result.BOATBUILDING__Discount_Amount__c);
								Wwocalculate_totalofallJobDiv();
                           	} else if(result.BOATBUILDING__Discount_In__c == 'Percentage' && result.BOATBUILDING__Discount_Percentage__c != undefined){
                           		var totalDue = parseFloat($("#Wwograndtotal_amount_due").val());
                           		var totalmisc = parseFloat($("#wwoTotalMiscCharge").val());
                           		var totaldis = parseFloat($("#WwograndtotalDiscount").val());
                           		
                           		var total = totalDue + totalmisc - totaldis; 
                           		
                           		var per = parseFloat(result.BOATBUILDING__Discount_Percentage__c);
                           		var dis = (total * per)/100;
                           		$("#WwodiscountOnWO").val(dis.toFixed(2));
                           		Wwocalculate_totalofallJobDiv();
                           	}
                           } 
                       }  
                   }); 
       	} else {
       		$("#discountOnWO").val('0');
       		Wwocalculate_totalofallJobDiv();
       	} 
       }  
     
     
    function addClaimStatus(divIndex, selectedValue) {
        if(lstClaimStatus.length > 0) {
            for(var i=0; i<lstClaimStatus.length; i++) {
                $("#wwoClmStts"+divIndex).append("<option value='"+lstClaimStatus[i]+"'>"+lstClaimStatus[i]+"</option>"); 
            }
        }
        if(selectedValue != '') {
            $("#wwoClmStts"+divIndex).val(selectedValue); 
        }
    }
    
    var warrntyWorkTypeList = [];
    $(document).ready(function() {
        BOATBUILDING.WarrantyWorkOrderControllerClone.fetchWorkTypePricingDetails(function(result, event) {
            if(event.status) {
                if(result != null) {
                    warrntyWorkTypeList = result;
                    if(warrntyWorkTypeList.length > 0) {
                        for(var i = 0; i < warrntyWorkTypeList.length; i++) {
                           // $("#WwoWorkTypeIdselect").append("<option value="+warrntyWorkTypeList[i].Id+">"+warrntyWorkTypeList[i].Name+"</option>");
                        }
                    }
                }
            }
        });
    });
    $("#wrntycreateWrkOrdrOnLstDiv").click(function() {
        $("#wrntyworkOrderListViewDiv").hide();
        $("#wrntyworkOrderFormDiv").show();
//         $(".chosenWWO").chosen({
//             no_results_text: "Oops, nothing found!" 
//         });
    }); 
    $("#cancelWwoorder").click(function() {
        //$("#wrntyworkOrderListViewDiv").show();
        //$("#wrntyworkOrderFormDiv").hide();
        window.top.location = "/apex/BOATBUILDING__ServicePage?type=WWO";
    }); 
    var Wwolstjob = [];
    var Wwoalllstjob = [];
    var WwolstContact = [];
    var Wwolsttax = [],Wwolstss = [];
    var WwoPercentage = '' , WwoCap_Amount_for_percent = '';
    var WwoselectedPartNumber1 = '';
    var WWOexisting = false;
    function WwogetJobParameters(obj1) {
            var WwojobID = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:sl1").value;
            if(WwojobID != null && WwojobID != "") {
                BOATBUILDING.WarrantyWorkOrderControllerClone.getDetailsOfJob(WwojobID, function(result, event) {
                    if(event.status) {
                        if(result != null) {
                            Wwolstjob = result;
                            if(Wwolstjob.length > 0) {
                                if(Wwolstjob[0].BOATBUILDING__Work_Requested__c != null) {
                                    document.getElementById("WWoWrkRequested").value = Wwolstjob[0].BOATBUILDING__Work_Requested__c;
                                } 
                                if(Wwolstjob[0].BOATBUILDING__Work_Type__c != null) {
                                    document.getElementById("WWoWrkType").value = Wwolstjob[0].BOATBUILDING__Work_Type__c;
                                }
                                if(Wwolstjob[0].BOATBUILDING__Type__c != null) {
                                    document.getElementById("WWoJobType").value = Wwolstjob[0].BOATBUILDING__Type__c;
                                }
                            }
                            else {
                                document.getElementById("WWoWrkRequested").value = "";
                                document.getElementById("WWoWrkType").value = "";
                                document.getElementById("WWoJobType").value = "";
                            }
                        }
                    }
                });
            }
            else {
                document.getElementById("WWoWrkRequested").value = "";
                document.getElementById("WWoWrkType").value = "";
                document.getElementById("WWoJobType").value = "";
            }
        }
        
    function fetchRelatedContactWWo() {
            var WwoconWrkId = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid").value;
            var WwoconWrkName = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2").value;
            if(WwoconWrkName != null && WwoconWrkName != "") {
                if(WwoconWrkId != null && WwoconWrkId != "" && WwoconWrkId != "000000000000000") {
                    BOATBUILDING.WarrantyWorkOrderControllerClone.getContact(WwoconWrkId, function(result, event) {
                        if(event.status) {
                            if(result != null) {
                                WwolstContact = result[0];
                                Wwolsttax = result[1];
                                
                                Wwolstss = result[2];
                                if(WwolstContact.length > 0) {
                                    if(WwolstContact[0].Phone != undefined) {
                                        document.getElementById("WWoPhoneId").value = WwolstContact[0].Phone;
                                    }
                                    if(WwolstContact[0].MailingStreet != undefined) {
                                        document.getElementById("WWoAddressId").value = WwolstContact[0].MailingStreet;
                                    }
                                    if(WwolstContact[0].MailingCity != undefined) {
                                        document.getElementById("WWoCityId").value = WwolstContact[0].MailingCity;
                                    }
                                    if(WwolstContact[0].Email != undefined) {
                                        document.getElementById("WWoEmailId").value = WwolstContact[0].Email;
                                    }
                                    if(WwolstContact[0].MailingPostalCode != undefined) {
                                        document.getElementById("WWoZipId").value = WwolstContact[0].MailingPostalCode;
                                    }
                                    if(WwolstContact[0].BOATBUILDING__Customer_Type__c != undefined) {
                                        document.getElementById("WWoCT").value = WwolstContact[0].BOATBUILDING__Customer_Type__c;
                                    }
                                }
                                else {
                                    document.getElementById("WWoPhoneId").value = "";
                                    document.getElementById("WWoAddressId").value = "";
                                    document.getElementById("WWoCityId").value = "";
                                    document.getElementById("WWoEmailId").value = "";
                                    document.getElementById("WWoZipId").value = "";
                                    document.getElementById("WWoCT").value = ""; 
                                }
                                
                                if(Wwolstss != undefined && Wwolstss.length > 0) {
                                    WwoPercentage = Wwolstss[0].BOATBUILDING__Percentage__c != undefined ? Wwolstss[0].BOATBUILDING__Percentage__c : 0;
                                    WwoCap_Amount_for_percent = Wwolstss[0].BOATBUILDING__Cap_Amount_for_percent__c != undefined ? Wwolstss[0].BOATBUILDING__Cap_Amount_for_percent__c : 0;
                                        
                                } 
                            }
                        }
                    });
                    
                    BOATBUILDING.WarrantyWorkOrderControllerClone.getPromocodes(function(result, event) {
                   	if(event.status) {
                   	console.log(result);
                   		if(result != null && result.length > 0) {
                   			var promoHTML = '<option value="0">--None--</option>';
                   			for(var i = 0; i < result.length; i++) {
                   				if(result[i].BOATBUILDING__Discount_In__c == 'Amount') {
                   					promoHTML += '<option value="'+result[i].Id+'">' + result[i].BOATBUILDING__Promo_Code_Name__c + ' | $ ' +parseFloat(result[i].BOATBUILDING__Discount_Amount__c).toFixed(2)+ '</option>';
                   				} else if(result[i].BOATBUILDING__Discount_In__c == 'Percentage') {
                   					promoHTML += '<option value="'+result[i].Id+'">' + result[i].BOATBUILDING__Promo_Code_Name__c + ' | ' +result[i].BOATBUILDING__Discount_Percentage__c+ '%</option>';
                   				}
                   			}
                   			$("#wwoPromocode").html(promoHTML); 
                   		} else {
                   			$("#wwoPromocode").html('<option value="0">--None--</option>');
                   		}
                   		
                   		console.log("promo check: "+wwopromo);
                   		
                   		$("#wwoPromocode").val(wwopromo)
                   		//wwopromoChange();
                   	}
                   });
                    
                }
            }
            else {
                document.getElementById("WWoPhoneId").value = ""; 
                document.getElementById("WWoAddressId").value = "";
                document.getElementById("WWoCityId").value = "";
                document.getElementById("WWoEmailId").value = "";
                document.getElementById("WWoZipId").value = "";
            }
        }
        function fetchBoatFromItemWWo(obj) {
            var WwoitemId = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid").value;
            var WwoitemName = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId").value;
            if(WwoitemName != null && WwoitemName != "") {
                if(WwoitemId != null && WwoitemId != "" && WwoitemId != "000000000000000") {
                    BOATBUILDING.WarrantyWorkOrderControllerClone.fetchItemsWo(WwoitemId, function(result, event) {
                        if(event.status) {
                            if(result != null) {
                                var WwolstCon1 = [];
                                WwolstCon1 = result;
                                if(WwolstCon1.length > 0) {
                                    if(WwolstCon1[0].BOATBUILDING__Boat_HIN_No__c != undefined) {
                                        document.getElementById("WWoHinId").value = WwolstCon1[0].BOATBUILDING__Boat_HIN_No__c;
                                    }
                                    if(WwolstCon1[0].BOATBUILDING__Engine_SN__c != undefined) {
                                        document.getElementById("WWoEngSnId").value = WwolstCon1[0].BOATBUILDING__Engine_SN__c;
                                    }
                                    
                                    if(WwolstCon1[0].BOATBUILDING__Engine_1_Serial_Number__c != undefined) {
	                                    document.getElementById("WWoEngSnId1").value = WwolstCon1[0].BOATBUILDING__Engine_1_Serial_Number__c;
	                                }
	                                if(WwolstCon1[0].BOATBUILDING__Engine_2_Serial_Number__c != undefined) {
	                                    document.getElementById("WWoEngSnId2").value = WwolstCon1[0].BOATBUILDING__Engine_2_Serial_Number__c;
	                                }
	                                if(WwolstCon1[0].BOATBUILDING__Engine_3_Serial_Number__c != undefined) {
	                                    document.getElementById("WWoEngSnId3").value = WwolstCon1[0].BOATBUILDING__Engine_3_Serial_Number__c;
	                                }
	                                if(WwolstCon1[0].BOATBUILDING__Engine_4_Serial_Number__c != undefined) {
	                                    document.getElementById("WWoEngSnId4").value = WwolstCon1[0].BOATBUILDING__Engine_4_Serial_Number__c;
	                                }
                                    
                                    if(WwolstCon1[0].BOATBUILDING__Boat_Manufacture_Date__c != undefined) {
                                        
                                        var d = parseInt(WwolstCon1[0].BOATBUILDING__Boat_Manufacture_Date__c);
                                        var dd = new Date(d);
                                        
                                        document.getElementById("WWoDateCrtedId").value = (dd.getMonth()+1)+"/"+dd.getDate()+"/"+dd.getFullYear();
                                    }
                                    if(WwolstCon1[0].BOATBUILDING__Trailer_VIN__c != undefined) {
                                        document.getElementById("WWoTvinId").value = WwolstCon1[0].BOATBUILDING__Trailer_VIN__c;
                                    }
                                    if(WwolstCon1[0].BOATBUILDING__Boat_Manufacturer__c != undefined) {
                                        document.getElementById("WWoMakeId").value = WwolstCon1[0].BOATBUILDING__Boat_Manufacturer__r.Name;
                                    }
                                    if(WwolstCon1[0].BOATBUILDING__Boat_Model__c != undefined) {
                                        document.getElementById("WWoModelId").value = WwolstCon1[0].BOATBUILDING__Boat_Model__c;
                                    }
                                    if(WwolstCon1[0].BOATBUILDING__M_Boat_Year__c != undefined) {
                                        document.getElementById("WWoYearId").value = WwolstCon1[0].BOATBUILDING__M_Boat_Year__c;
                                    }
                                }
                                else {
                                    document.getElementById("WWoHinId").value = "";
                                    document.getElementById("WWoEngSnId").value = "";
                                    $("#WwoEngSnId1").val("");
					    			$("#WwoEngSnId2").val("");
					    			$("#WwoEngSnId3").val("");
					    			$("#WwoEngSnId4").val("");
                                    document.getElementById("WWoDateCrtedId").value = "";
                                    document.getElementById("WWoTvinId").value = "";
                                    document.getElementById("WWoMakeId").value = "";
                                    document.getElementById("WWoModelId").value = "";
                                    document.getElementById("WWoYearId").value = "";
                                }
                            }
                        }
                    });
                }
            }
            else {
                document.getElementById("WWoHinId").value = "";
                document.getElementById("WWoEngSnId").value = "";
                $("#WwoEngSnId1").val("");
    			$("#WwoEngSnId2").val("");
    			$("#WwoEngSnId3").val("");
    			$("#WwoEngSnId4").val("");
                document.getElementById("WWoDateCrtedId").value = "";
                document.getElementById("WWoTvinId").value = "";
                document.getElementById("WWoMakeId").value = "";
                document.getElementById("WWoModelId").value = "";
                document.getElementById("WWoYearId").value = "";
            }
        }
        
 
        function Wwocalculate_LabourPrice()
        {
        document.getElementById("WwoLabourTotalPrice").innerHTML = '';
            if(document.getElementById("WwoLabourPrice").value !='' && document.getElementById("WwoLabourQuantity").value !='')
            {
                var Wwotot= parseFloat(document.getElementById("WwoLabourQuantity").value);
                var Wwosum_all = Wwotot *  parseFloat(document.getElementById('WwoLabourPrice').value);
                document.getElementById("WwoLabourTotalPrice").innerHTML= (Wwosum_all).toFixed(2);
            }
            else{
            return false;
            }
        }

        function Wwocalculate_totalofJobDiv(Divhiddenvalue){
           //alert('inside Wwocalculate_totalofJobDiv');
            var Wwohiddenvalue = document.getElementById("WwotheValueDiv"+Divhiddenvalue).value;
            var Wwograndtotal = 0.0;
            for(var i=1; i<=Wwohiddenvalue; i++){
            if(document.getElementById("WwoPartTotalDiv"+Divhiddenvalue+i).innerHTML != null && document.getElementById("WwoPartTotalDiv"+Divhiddenvalue+i).innerHTML != '' && document.getElementById("WwoPartPriceDiv"+Divhiddenvalue+i).innerHTML != null ){
                    var Wwosubtotal = parseFloat(document.getElementById("WwoPartTotalDiv"+Divhiddenvalue+i).innerHTML);
                    Wwograndtotal = parseFloat(Wwograndtotal + Wwosubtotal);
                }
            }
            if(document.getElementById("WwoLabourTotalPriceDiv"+Divhiddenvalue).innerHTML != null && document.getElementById("WwoLabourTotalPriceDiv"+Divhiddenvalue).innerHTML != '' ){
                var Wwolaboursubtotal = parseFloat(document.getElementById("WwoLabourTotalPriceDiv"+Divhiddenvalue).innerHTML);
                Wwograndtotal = parseFloat(Wwograndtotal + Wwolaboursubtotal);
            }
            document.getElementById("WwoTotalOfJobDiv"+Divhiddenvalue).innerHTML = (Wwograndtotal.toFixed(2));
            document.getElementById("WwoTotalOfJobDiv"+Divhiddenvalue).innerHTML = (Wwograndtotal.toFixed(2));
             
            calculateWarrantySection(Divhiddenvalue);
            calDiscountedTotalAmtWwo(Divhiddenvalue);
            Wwocalculate_totalofallJobDiv();
        }
   
        function Wwocalculate_totalofallJobDiv(){
            //alert('inside Wwocalculate_totalofallJobDivvivek');
            var WwoDivhiddenvalue = document.getElementById("WwoDivValue").value;
            var wwoTotalMiscChagre = 0.00, WWOTotalBalanceDue = 0.00; var totalpaidOnJob = 0.00; var WWOgrndDisOnJob = 0.00; Wwograndtotal = 0.0 ; var Wwototal_parts = 0.00; var Wwototal_labour = 0.00; var Wwototal_amount = 0; var Wwototal_salesamount = 0; var Wwototal_amount_due = 0;var Wwototal_customer_pay = 0; var Wwototal_balance = 0.00;

            if(WwoDivhiddenvalue == "0"){
                //$("#Wwohiddenbtn").css("display","none");
                $("#WwoShowjobList").css("display", "none");
            }
            if(Wwoalllstjob.length > 0){
                
                for(var i=0; i < Wwoalllstjob.length; i++){
                    Wwototal_parts = parseFloat(Wwototal_parts + Wwoalllstjob[i].BOATBUILDING__Total_Amount_on_Parts_del__c); 
                    //Wwototal_labour = parseFloat(Wwototal_labour + Wwoalllstjob[i].BOATBUILDING__Total_Cost_Labor__c);
                    //Wwototal_amount = parseFloat(Wwototal_amount + Wwoalllstjob[i].BOATBUILDING__Total_Amount_Job__c);
                    //Wwototal_customer_pay = parseFloat(Wwototal_customer_pay + Wwoalllstjob[i].BOATBUILDING__Customer_Pay__c);
                    
                }
            }
            Wwototal_labour = 0.00;
            for(var i=1; i<=WwoDivhiddenvalue; i++){
                if(document.getElementById("Wwonewdiv"+i) != null){
                    var Wwohiddenvalue = document.getElementById("WwotheValueDiv"+i).value;
                    for(var j=1; j<=Wwohiddenvalue; j++){
                        if(document.getElementById("WwoPartTotalDiv"+i+j).innerHTML != ''){
                            var Wwosubtotal_parts = parseFloat(document.getElementById("WwoPartTotalDiv"+i+j).innerHTML);
                            Wwototal_parts = parseFloat(Wwototal_parts + Wwosubtotal_parts);
                        }
                    } 
                }
                if(document.getElementById("WwoLabourTotalPriceDiv"+i) != null && document.getElementById("WwoLabourTotalPriceDiv"+i).innerHTML != ''){
                        var Wwosubtotal_labour = parseFloat(document.getElementById("WwoLabourTotalPriceDiv"+i).innerHTML);
                        Wwototal_labour += parseFloat(Wwosubtotal_labour);
                }
                if(document.getElementById("WwoTotalOfJobDiv"+i) != null && document.getElementById("WwoTotalOfJobDiv"+i).innerHTML != ''){
                    var Wwosubtotal_amount = parseFloat(document.getElementById("WwoTotalOfJobDiv"+i).innerHTML);
                    Wwototal_amount += parseFloat(Wwosubtotal_amount);
                }
                
                if(document.getElementById("WwodiscountOnJob"+i) != null && document.getElementById("WwodiscountOnJob"+i).value != ''){
                    var wwoJobDis = parseFloat(document.getElementById("WwodiscountOnJob"+i).value);
                    WWOgrndDisOnJob += parseFloat(wwoJobDis);
                }
                if(document.getElementById("wwoBlncDue"+i) != null && document.getElementById("wwoBlncDue"+i).value != ''){
                    var wwoJobBal = parseFloat(document.getElementById("wwoBlncDue"+i).value);
                    WWOTotalBalanceDue += parseFloat(wwoJobBal);
                }
                
                if(document.getElementById("wwoTtlPd"+i) != null && document.getElementById("wwoTtlPd"+i).value != ''){
                    var wwopaidBal = parseFloat(document.getElementById("wwoTtlPd"+i).value);
                    totalpaidOnJob += parseFloat(wwopaidBal);
                }
                if(document.getElementById("wwoMicsChrg"+i) != null && document.getElementById("wwoMicsChrg"+i).value != ''){
                    var wwoMisc = parseFloat(document.getElementById("wwoMicsChrg"+i).value);
                    wwoTotalMiscChagre += wwoMisc;    
                }
                
            }
            
            document.getElementById("Wwograndtotal_parts").value = (Wwototal_parts.toFixed(2));
            document.getElementById("Wwograndtotal_labor").value = (Wwototal_labour.toFixed(2));
            document.getElementById("Wwograndtotal_total").value = (parseFloat(Wwototal_parts) + parseFloat(Wwototal_labour)).toFixed(2);
            document.getElementById("Wwograndtotal_amount_due").value = (parseFloat(Wwototal_parts) + parseFloat(Wwototal_labour)).toFixed(2);
            document.getElementById("WwograndtotalDiscount").value = parseFloat(WWOgrndDisOnJob).toFixed(2);
            
            var disOnJob = 0.00;
            if(document.getElementById("WwograndtotalDiscount").value != '') {
                disOnJob = parseFloat(document.getElementById("WwograndtotalDiscount").value);
            }
            document.getElementById("Wwograndtotal_payment").value = (totalpaidOnJob).toFixed(2);
            
            document.getElementById("wwoTotalMiscCharge").value = (wwoTotalMiscChagre).toFixed(2);
             
            var ttlPaymnt = 0.00;
            if(document.getElementById("Wwograndtotal_payment").value != '') {
                ttlPaymnt = parseFloat(document.getElementById("Wwograndtotal_payment").value);
            }
            
            var disOnWWO = 0.00;
            if(document.getElementById("WwodiscountOnWO").value != '') {
                disOnWWO = parseFloat(document.getElementById("WwodiscountOnWO").value);
            }
            document.getElementById("Wwograndtotal_balance").value = (parseFloat(WWOTotalBalanceDue - disOnWWO).toFixed(2));  

            
        }
    
        function Wwopopulate_quantity_div(sel,Divnum,id)
        {
            var WwoselectedPartNumber1 = '';
            var WwoselectedPartDesc1 = sel.options[sel.selectedIndex].text;
            WwoselectedPartNumber1 =  sel.options[sel.selectedIndex].value;
            var WwoPartPriceid = "#WwoPartPriceDiv"+Divnum+id;
            var WwoPartsQuantity = "#WwoPartsQuantityDiv"+Divnum+id;
            var WwoPartTotal = "#WwoPartTotalDiv"+Divnum+id;
             for(var j = 0 ; j < WwolstPart.length ; j++) {
                if(WwolstPart[j].Id == WwoselectedPartNumber1){
                    $(WwoPartPriceid).html(WwolstPart[j].BOATBUILDING__Cost__c);
                    $(WwoPartsQuantity).val(WwolstPart[j].BOATBUILDING__Quantity__c);
                    $(WwoPartTotal).html(WwolstPart[j].BOATBUILDING__Quantity__c * WwolstPart[j].BOATBUILDING__Cost__c);
                }
            }
        }
        
        function Wwocalculate_quantity_Div(Divnum,id)
        {
        document.getElementById("WwoPartTotalDiv"+Divnum+id).innerHTML = '';
        var Wwosum_all = 0.0;
            if(document.getElementById("WwoPartsQuantityDiv"+Divnum+id).value !='' && document.getElementById("WwoPartPriceDiv"+Divnum+id).innerHTML !=''){
                var Wwotot= parseInt(document.getElementById("WwoPartsQuantityDiv"+Divnum+id).value);
                Wwosum_all = Wwotot *  parseFloat(document.getElementById('WwoPartPriceDiv'+Divnum+id).innerHTML);
            }
            document.getElementById("WwoPartTotalDiv"+Divnum+id).innerHTML= (Wwosum_all.toFixed(2));
        }
    
        function Wwoadd_new_row(Divnum)
        {
            
            WWOaddJobDiv = Divnum;
            WWOjobIndex = Divnum;
            $("#WWOPymntModlnewjob").fadeIn();
            /*$("#WwohiddentdDiv"+Divnum).css("display","");
            var Wwofd = document.getElementById("Wwofile1Div"+Divnum);
            var Wwonewdiv = document.createElement("Wwodiv"+Divnum);
            var Wwonumi = document.getElementById('WwotheValueDiv'+Divnum);
            var Wwonum = (document.getElementById("WwotheValueDiv"+Divnum).value -1)+ 2;
            Wwonumi.value = Wwonum;
            var Wwoselectpartlist = "WwoselectpartlistDiv"+Divnum+Wwonum;
            var WwoPartTotal = "WwoPartTotalDiv"+Divnum+Wwonum;
            var WwoPartsQuantity = "WwoPartsQuantityDiv"+Divnum+Wwonum;
            var WwoPartPrice = "WwoPartPriceDiv"+Divnum+Wwonum;
            
            var Wwor = Math.floor(Math.random()*100000);
            Wwonewdiv.setAttribute("id","Wwoaaaa"+Wwor);
        
            Wwonewdiv.innerHTML ='<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43">Parts</td><td data-label="Parts No" width="65"><select style="width:200px;" class="slds-select chosen Wwoselectpartlist" onchange="Wwopopulate_quantity_div(this,'+Divnum+','+Wwonum+'); Wwocalculate_totalofJobDiv('+Divnum+');" id="'+Wwoselectpartlist+'"><option selected="selected">Choose...</option></select></td><td data-label="Quanity" width="144"><input id="'+WwoPartsQuantity+'" onkeypress="return isNumber(event)" onkeyup="Wwocalculate_quantity_Div('+Divnum+','+Wwonum+'); Wwocalculate_totalofJobDiv('+Divnum+');" class="slds-input" type="text"/><td  class="slds-text-align--right" width="90"><i aria-hidden="true" class="fa fa-usd"></i><span id="'+WwoPartPrice+'">0.00</span></td><td width="60" class="slds-text-align--right" ><i class="fa fa-usd" aria-hidden="true"></i><span id="'+WwoPartTotal+'">0.00</span></td><td width="24" align="right"><a href="#1" title="Remove" class="hyperlink" style="font-weight: bold;text-decoration:none;" onclick="Javascript:Wworemove_row(\''+"Wwoaaaa"+Wwor+'\','+Wwonum+');return false"><i class="fa fa-times fa-lg" aria-hidden="true"></i></a></td></tr></table>';
            Wwofd.appendChild(Wwonewdiv);
        
            var WwoselectedPartNumber = '';
            
             if(WwolstPart.length > 0) {
                         for(var i = 0 ; i < WwolstPart.length ; i++) {
                                var WwopartId = "";
                                var WwopartNumber = "";
                                var WwopartName = ""
                                var WwopartQuantity = 0;
                                var WworetailPrice = 0.00;
                                var WwototalRetailPrice = 0.00;
                                var WwogrndTotal = 0.00;
                                if(WwolstPart[i].Id != null) {
                                    WwopartId = WwolstPart[i].Id;
                                }
                                if(WwolstPart[i].BOATBUILDING__Part_Number__c != null) {
                                     WwopartNumber = WwolstPart[i].BOATBUILDING__Part_Number__c;
                                }
                                if(WwolstPart[i].BOATBUILDING__Part_Name__c != null) {
                                     WwopartName = WwolstPart[i].BOATBUILDING__Part_Name__c;
                                }
                                if(WwolstPart[i].BOATBUILDING__Quantity__c != null) {
                                     WwopartQuantity = parseInt(WwolstPart[i].BOATBUILDING__Quantity__c);
                                }
                                if(WwolstPart[i].BOATBUILDING__Cost__c != null) {
                                     WworetailPrice = parseFloat(WwolstPart[i].BOATBUILDING__Cost__c);
                                }
                                $("#WwoselectpartlistDiv"+Divnum+Wwonum).append("<option value="+WwopartId+">"+WwopartNumber+":"+WwopartName+"</option>");   
                            }
                                $("#WwoselectpartlistDiv"+Divnum+Wwonum).trigger("chosen:updated");
            }   
                        $("#WwoselectpartlistDiv"+Divnum+Wwonum).chosen({
                            disable_search_threshold: 10,
                            no_results_text: "Oops, nothing found!",
                            width: "220px",
                            search_contains: true
                        }); 
            */
        }
    
        function Wworemove_row(Wwoxxx,Wwoid) 
        {
            var WwoDivhiddenvalue = document.getElementById("WwoDivValue").value;
            var Wwohiddenvalue = "WwotheValueDiv"+WwoDivhiddenvalue;
            var Wwoxxx = document.getElementById(Wwoxxx);
            Wwoxxx.parentNode.removeChild(Wwoxxx);
            document.getElementById(Wwohiddenvalue).value = parseInt(document.getElementById(Wwohiddenvalue).value)-1;
            Wwocalculate_totalofJobDiv(WwoDivhiddenvalue);
            //document.getElementById("theValue").value=document.getElementById("theValue").value -1;
        }  

        function Wworemove_div(Wwodivid,Wwodivnum) 
        {
            var Wwoelem = document.getElementById(Wwodivid);
            Wwoelem.remove(); 
            document.getElementById("WwoDivValue").value = parseInt(document.getElementById("WwoDivValue").value)-1;
            var Wwonewdivid = "Wwoaaoo"+Wwodivnum;
            if(Wwodivid == Wwonewdivid){
                var Wwoindex = parseInt(Wwodivnum);
                var Wwoindex_to_remove = parseInt(Wwodivnum) - 1;
                Wwoalllstjob.pop(Wwoindex_to_remove);
            }
            Wwocalculate_totalofallJobDiv();
        } 
        
        function Wwochange_LabourValues(Divnum)
        {
            var WwoLabourPrice = "WwoLabourPriceDiv"+Divnum;
            
            var WwoLabourTotalPrice = "WwoLabourTotalPriceDiv"+Divnum;
            if(document.getElementById("WwoWorkTypeSelect"+Divnum)!= null) {
            console.log('this is in');
                if(warrntyWorkTypeList.length > 0) {
                    for(var i = 0; i < warrntyWorkTypeList.length; i++) {
                            var wId = '#WwoWorkTypeSelect' + Divnum;
                            var WwoWorkTypeId = $(wId+" option:selected").text();
                        if(WwoWorkTypeId == warrntyWorkTypeList[i].Name) {
                        console.log('this is in');
                        console.log(warrntyWorkTypeList);
                        console.log(warrntyWorkTypeList[i].BOATBUILDING__Price__c);
                            document.getElementById(WwoLabourPrice).value = warrntyWorkTypeList[i].BOATBUILDING__Price__c;
                        }
                    }
                }
            }
            if(document.getElementById("WwonewjobWorkTypeId"+Divnum) != null) {
                console.log('This is executing');
                if(warrntyWorkTypeList.length > 0) {
                console.log('this is in');
                    for(var i = 0; i < warrntyWorkTypeList.length; i++) {
                        if($("#WwonewjobWorkTypeId"+Divnum).val() == warrntyWorkTypeList[i].Id) {
                        console.log('this is in');
                        console.log('this is in');
                        console.log(warrntyWorkTypeList[i].BOATBUILDING__Price__c);
                            document.getElementById(WwoLabourPrice).value = warrntyWorkTypeList[i].BOATBUILDING__Price__c;
                        }
                    }
                }
                //document.getElementById(WwoLabourPrice).value = $("#WwonewjobWorkTypeId"+Divnum).val();
            }
            var tot = 0;
            if(document.getElementById("WwoLabourQuantityDiv"+Divnum).value != "") {
                tot= parseInt(document.getElementById("WwoLabourQuantityDiv"+Divnum).value);
            }
            var sum_all = tot *  parseFloat(document.getElementById(WwoLabourPrice).value);
            document.getElementById(WwoLabourTotalPrice).innerHTML = (sum_all.toFixed(2));
            var partsTotal = 0.00;
            var laborTotal = 0.00; 
            if("WwoDivnum"+Divnum in objDivTotalPartAmtWwo) {
                partsTotal = parseFloat(objDivTotalPartAmtWwo["WwoDivnum"+Divnum]);
            }
            if(document.getElementById(WwoLabourTotalPrice) != null && document.getElementById(WwoLabourTotalPrice).innerHTML != "") {
                laborTotal = parseFloat(document.getElementById(WwoLabourTotalPrice).innerHTML);
            }
            
            var midTotal = partsTotal + laborTotal;
            document.getElementById("WwoTotalOfJobDiv"+Divnum).innerHTML = parseFloat(midTotal).toFixed(2);
            
            calDiscountedTotalAmtWwo(Divnum);
        }

        function calDiscountedTotalAmtWwo(divIndex) {
            var totalAmt = 0.00;    
            var discount = 0.00;
            var discountONWO = 0.00;
            if(document.getElementById("WwoTotalOfJobDiv"+divIndex).innerHTML != '' && document.getElementById("WwoTotalOfJobDiv"+divIndex).innerHTML != 'NaN') {
                totalAmt = parseFloat(document.getElementById("WwoTotalOfJobDiv"+divIndex).innerHTML);
            }
            
            if(document.getElementById("WwodiscountOnJob"+divIndex).value != '') {
                discount = parseFloat(document.getElementById("WwodiscountOnJob"+divIndex).value);
            }
            //alert("totalAmt: "+totalAmt);
            //alert("discount" + discount);
            if(discount <= totalAmt) {
                document.getElementById("gTotalAmtWwo"+divIndex).innerHTML = (totalAmt - discount).toFixed(2);
            }else {
                alert("Discount should less than total amount.");
                document.getElementById("gTotalAmtWwo"+divIndex).innerHTML = (totalAmt).toFixed(2);
                document.getElementById("WwodiscountOnJob"+divIndex).value = (0.00).toFixed(2);
            }
            var wwoMiscChrg = 0.00; 
            var total = document.getElementById("gTotalAmtWwo"+divIndex).innerHTML;
            if(document.getElementById("wwoMicsChrg"+divIndex).value != "") {
               wwoMiscChrg = parseFloat(document.getElementById("wwoMicsChrg"+divIndex).value);
            } 
            document.getElementById("gTotalAmtWwo"+divIndex).innerHTML = (parseFloat(total) + parseFloat(wwoMiscChrg)).toFixed(2);
            calculateWarrantySection(divIndex);
            Wwocalculate_totalofallJobDiv();
    }

    </script>
    <script>
    
    $(document).ready(function(){
        WwolstPart = [];
        var WwoselectedPartNumber = '';
        BOATBUILDING.WarrantyWorkOrderControllerClone.PopulatePartNumber(function(result, event) {
         if(event.status) {
            if(result != null) {
                 WwolstPart = result;
                 if(WwolstPart.length > 0) {
                     for(var i = 0 ; i < WwolstPart.length ; i++) {
                            var WwopartId= "";
                            var WwopartNumber = "";
                            var WwopartName = ""
                            var WwopartQuantity = 0;
                            var WworetailPrice = 0.00;
                            var WwototalRetailPrice = 0.00;
                            var WwogrndTotal = 0.00;
                            if(WwolstPart[i].Id != null) {
                                WwopartId = WwolstPart[i].Id;
                            }
                            if(WwolstPart[i].BOATBUILDING__Part_Number__c != null) {
                                 WwopartNumber = WwolstPart[i].BOATBUILDING__Part_Number__c;
                            }
                            if(WwolstPart[i].BOATBUILDING__Part_Name__c != null) {
                                 WwopartName = WwolstPart[i].BOATBUILDING__Part_Name__c;
                            }
                            if(WwolstPart[i].BOATBUILDING__Quantity__c != null) {
                                 WwopartQuantity = parseInt(WwolstPart[i].BOATBUILDING__Quantity__c);
                            }
                            if(WwolstPart[i].BOATBUILDING__Cost__c != null) {
                                 WworetailPrice = parseFloat(WwolstPart[i].BOATBUILDING__Cost__c);
                            }
                            $(".Wwoselectpartlist").append("<option value="+WwopartId+">"+WwopartNumber+":"+WwopartName+"</option>");   
                        }
                        $('.Wwoselectpartlist').trigger("chosen:updated");
                    }
                }
            }
        });
         $(".chosen").chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            width: "220px",
            search_contains: true
          }); 
          
            $("#Wwoselectpartlist").change(function(){
                var WwoselectedPartDesc = $(this).find("option:selected").text();
                WwoselectedPartNumber = $(this).val();
                for(var i = 0 ; i < WwolstPart.length ; i++) {
                    if(WwolstPart[i].Id == WwoselectedPartNumber){
                        $("#WwoPartPrice").html(WwolstPart[i].BOATBUILDING__Cost__c);
                        $("#WwoPartsQuantity").val(WwolstPart[i].BOATBUILDING__Quantity__c);
                        $("#WwoPartTotal").html(WwolstPart[i].BOATBUILDING__Quantity__c * WwolstPart[i].BOATBUILDING__Cost__c);
                    }
                }
            });
       
    });
        var objDivTotalPartAmtWwo = new Object();
    function Wwobind_WorkType(id,Wwoworktype)
    {
        console.log('id----'+id);
        console.log('WWO==='+Wwoworktype);
        if(warrntyWorkTypeList.length > 0) {
            for(var i = 0; i < warrntyWorkTypeList.length; i++) {
            				if(warrntyWorkTypeList[i].BOATBUILDING__Active__c) {
		                        if(warrntyWorkTypeList[i].Name == Wwoworktype) { 
		                            console.log(warrntyWorkTypeList[i].Name);
		                            console.log(Wwoworktype);
		                            Wwoworktype
		                            $(id).append("<option selected='selected' value="+warrntyWorkTypeList[i].BOATBUILDING__Price__c+">"+warrntyWorkTypeList[i].Name+"</option>");
		                        } else {
		                            $(id).append("<option value="+warrntyWorkTypeList[i].BOATBUILDING__Price__c+">"+warrntyWorkTypeList[i].Name+"</option>");
		                    }
                    }
                    //$(id+"  option:contains(" + Wwoworktype + ")").attr('selected', 'selected');
            }  
            if(Wwoworktype != '') {
                //$(id).val(Wwoworktype);
            }
        }
    }
         
    function Wwocalculate_LabourPrice_Div(WwoDivnum) { 
        document.getElementById("WwoLabourTotalPriceDiv"+WwoDivnum).innerHTML = '';
        if(document.getElementById("WwoLabourPriceDiv"+WwoDivnum).value !='' && document.getElementById("WwoLabourQuantityDiv"+WwoDivnum).value !='') {
            var Wwotot= parseFloat(document.getElementById("WwoLabourQuantityDiv"+WwoDivnum).value);
            var Wwosum_all = Wwotot *  parseFloat(document.getElementById('WwoLabourPriceDiv'+WwoDivnum).value);
            document.getElementById("WwoLabourTotalPriceDiv"+WwoDivnum).innerHTML= (Wwosum_all.toFixed(2));
            //alert("Wwosum_all: "+Wwosum_all);
            if("WwoDivnum"+WwoDivnum in objDivTotalPartAmtWwo) {
                document.getElementById("WwoTotalOfJobDiv"+WwoDivnum).innerHTML =  (parseFloat(objDivTotalPartAmtWwo["WwoDivnum"+WwoDivnum]) + parseFloat(Wwosum_all)).toFixed(2);
            } else {
                document.getElementById("WwoTotalOfJobDiv"+WwoDivnum).innerHTML =  (parseFloat(Wwosum_all)).toFixed(2);
            }
            //alert("Div number: "+document.getElementById("WwoTotalOfJobDiv"+WwoDivnum).innerHTML);
            calDiscountedTotalAmtWwo(WwoDivnum);
            calculateWarrantySection(WwoDivnum); 
        } else {
            return false;
        }
    }
    
    
    
    $("#WwoAddjob").click(function(){
            var Wwosel = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:sl1');
            var WwoselectedPartNumber1 = Wwosel.options[Wwosel.selectedIndex].value;
            var WwoDivi = document.getElementById('WwoDivValue');
            var WwoDivnum = (document.getElementById("WwoDivValue").value -1)+ 2;
            WwoDivi.value = WwoDivnum;
            var WwotheValue = "WwotheValueDiv"+WwoDivnum;
            var WWoExistingjobId = "WWojobId"+WwoDivnum;
            var Wwopartdiv='';
        if(document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid').value != '000000000000000' &&  document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2').value != ''&& document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid').value != '000000000000000' && document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId').value != ''){
            if(WwoselectedPartNumber1 != ''){
                    //$("#Wwohiddenbtn").css("display","");
                    $("#WwoShowjobList").css("display", "");
                    var WwoAddPart = "WwoAddPartDiv"+WwoDivnum;
                    var Wwohiddentd = "WwohiddentdDiv"+WwoDivnum;
                    var WwoLabourQuantity = "WwoLabourQuantityDiv"+WwoDivnum;
                    var WwoLabourPrice = "WwoLabourPriceDiv"+WwoDivnum;
                    var WwoLabourTotalPrice = "WwoLabourTotalPriceDiv"+WwoDivnum;
                    var WwoWorkTypeSelect = "WwoWorkTypeSelect"+WwoDivnum;
                    var WwoTotalOfJobDiv = "WwoTotalOfJobDiv"+WwoDivnum;
                    var WWoJNId = "WwoExistingjobName"+WwoDivnum
                    var TechId = '', TechName = '', BTN_lbl = 'Add Technician', WWOCUSTComments = '', WWOMiscCharge = '0.00',WWOClaimStatus = '', WWOComments = '',WWojobname = '',WWoworkrequested = '', WWoworktype = '',WWoLabourQuantity = '',WWoLabourPrice = 0.0, WWoLabourTotalPrice = 0.0, WwojobCustomerPay = 0.0 , WwojobTotal = 0.0 ,WWojobId = '' ;
                    //TechId TechName BTN_lbl
                    if(Wwolstjob.length > 0) {
                        if(Wwolstjob[0].BOATBUILDING__Technician__c != undefined) {
	                        TechId = Wwolstjob[0].BOATBUILDING__Technician__c;
	                        TechName = Wwolstjob[0].BOATBUILDING__Technician__r.Name;
	                        BTN_lbl = 'Update Technician';
	                    } 
                        if(Wwolstjob[0].Id != undefined) {
                            WWojobId = Wwolstjob[0].Id;
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Job_Name__c != undefined) {
                            WWojobname = Wwolstjob[0].BOATBUILDING__Job_Name__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Work_Requested__c != undefined) {
                            WWoworkrequested = Wwolstjob[0].BOATBUILDING__Work_Requested__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Work_Type__c != undefined) {
                            WWoworktype = Wwolstjob[0].BOATBUILDING__Work_Type__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__No_of_Labors__c != undefined) {
                            WWoLabourQuantity = Wwolstjob[0].BOATBUILDING__No_of_Labors__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Price_per_Labor__c != undefined) {
                            WWoLabourPrice = Wwolstjob[0].BOATBUILDING__Price_per_Labor__c; 
                        }
                        if(Wwolstjob[0].BOATBUILDING__Total_Cost_Labor__c != undefined) {
                            WWoLabourTotalPrice = Wwolstjob[0].BOATBUILDING__Total_Cost_Labor__c;
                        }
                        var totalPartPrice = 0.00;
                        if(Wwolstjob[0].BOATBUILDING__Total_Amount_on_Parts_del__c != undefined) {
                            totalPartPrice = Wwolstjob[0].BOATBUILDING__Total_Amount_on_Parts_del__c;
                        }
                            WwojobTotal = (WWoLabourTotalPrice + totalPartPrice).toFixed(2);
                        
                        if(Wwolstjob[0].BOATBUILDING__Customer_Pay__c != undefined) {
                            WwojobCustomerPay = Wwolstjob[0].BOATBUILDING__Customer_Pay__Wwochange_LabourValuesc;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Comments__c != undefined) { 
                            WWOComments = Wwolstjob[0].BOATBUILDING__Comments__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Customer_Comments__c != undefined) {
	                        WWOCUSTComments = Wwolstjob[0].BOATBUILDING__Customer_Comments__c;
	                        console.log(Wwolstjob[0].BOATBUILDING__Customer_Comments__c);
	                    } 
                         
                        if(Wwolstjob[0].BOATBUILDING__Claim_Status_New__c != undefined) { 
                            WWOClaimStatus = Wwolstjob[0].BOATBUILDING__Claim_Status_New__c;
                        }
                        
                        
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge__c != undefined) {
                            WWOMiscCharge = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge__c);
                        }
                        var misccc2 = 0.00
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge_2__c != undefined) {
                            misccc2 = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge_2__c);
                        }
                        var misccc3 = 0.00
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge_3__c != undefined) {
                            misccc3 = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge_3__c);
                        }
                        var miscccd = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_1__c != undefined) {
                            miscccd = Wwolstjob[0].BOATBUILDING__Misc_Description_1__c;
                        } 
                        var miscccd2 = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_2__c != undefined) {
                            miscccd2 = Wwolstjob[0].BOATBUILDING__Misc_Description_2__c;
                        }
                        var miscccd3 = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_3__c != undefined) {
                            miscccd3 = Wwolstjob[0].BOATBUILDING__Misc_Description_3__c;
                        }
                        // + parseFloat(WoShippingCharge)
                        var totalMisc = WWOMiscCharge + misccc2 + misccc3;
                        
                    }   
                     
                    var Wwonewdiv ="<div class='slds-card' style='background-color: #ffffff;' id='Wwoaaoo"+WwoDivnum+"'><div style='color: red; position: absolute; margin: 3px;' id='Wwoerror-panel"+WwoDivnum+"'><ul id='Wwoerror-div"+WwoDivnum+"'></ul></div><div style='float:right;line-height:0;'><a style='text-decoration:none;' onclick='remove_div(\"Wwoaaoo"+WwoDivnum+"\",\""+WwoDivnum+"\")'><i class='fa fa-times fa-lg'  style='margin-top: 4px; margin-right: 4px;' aria-hidden='true'></i></a></div><div class='slds-grid slds-wrap slds-m-top--medium'><table><tr><td><table class='slds-table slds-table--bordered' style='border-right: 1px solid #d8dde6;'><thead><tr><th>Job</th><th>Work Requested</th><th >Type</th><th >Quantity</th><th class='slds-text-align--right'>Price</th><th class='slds-text-align--right'>Total</th><th class='slds-text-align--right'></th></tr></thead><tbody><tr><td colspan='5'><input class = 'slds-input' id="+WWoExistingjobId+" type='hidden' value='"+WWojobId+"'></input><input class = 'slds-input' id="+WWoJNId+" type='text' value='"+WWojobname+"'></input></td><td>"+WWoworkrequested+"</td><td ><select id="+WwoWorkTypeSelect+" onchange='Wwochange_LabourValues("+WwoDivnum+"); Wwocalculate_totalofallJobDiv();' class='slds-select'><option value='0' selected='selected'>--None--</option></select></td><td>&nbsp;</td><td class='slds-text-align--right'></td></tr><tr><td colspan='7'><div id=Wwoexistingjobdiv"+WwoDivnum+"><input type='hidden' name='WwotheValue' id='"+WwotheValue+"' value='0' /></div></td></tr><tr><td>&nbsp;</td><td data-label='Labor'>Labor</td><td>&nbsp;</td><td data-label='Quantity'><input id='"+WwoLabourQuantity+"' onkeypress='return isNumberKey(event)' class='slds-input' type='text' onkeyup='Wwocalculate_LabourPrice_Div("+WwoDivnum+"); Wwocalculate_totalofallJobDiv();' value='"+WWoLabourQuantity+"'/></td><td data-label='Price' class='slds-text-align--right'><i class='fa fa-usd' aria-hidden='true'></i><input id='"+WwoLabourPrice+"'  class='slds-input' type='text' disabled='disabled' value="+WWoLabourPrice+"></td><td data-label='Total' class='slds-text-align--right'><i class='fa fa-usd' aria-hidden='true'></i><span id='WwoLabourTotalPriceDiv"+WwoDivnum+"'>"+WWoLabourTotalPrice+"</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td data-label='Prospecting' class='slds-text-align--right'>Total:<td class='slds-text-align--right' ><i class='fa fa-usd' aria-hidden='true'></i><span id='WwoTotalOfJobDiv"+WwoDivnum+"'>"+WwojobTotal+"</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Discount ($)</td><td class='slds-text-align--right'><input onkeypress='return isNumberKey(event)' class='slds-input' onKeyUp='calDiscountedTotalAmtWwo("+WwoDivnum+");' name='Discount' id='WwodiscountOnJob"+WwoDivnum+"'/></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>Misc Description 1</td><td colspan='2'><input type='text' value='"+miscccd+"' class='slds-input' id='miscDescwwo1"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 1 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' value='"+WWOMiscCharge+"' class='slds-input' name='Misc Charge' id='miscChargewwo1"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 2</td><td colspan='2'><input value='"+miscccd2+"' type='text' class='slds-input'  id='miscDescwwo2"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 2 ($)</td><td class='slds-text-align--right'><input value='"+misccc2+"'  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo2"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 3</td><td colspan='2'><input value='"+miscccd3+"' type='text' class='slds-input' id='miscDescwwo3"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 3 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' value='"+misccc3+"' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo3"+WwoDivnum+"'/></td><td>&nbsp;</td></tr>   <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Misc Charge ($)</td><td class='slds-text-align--right'><input class='slds-input' onchange='calDiscountedTotalAmtWwo("+WwoDivnum+");' disabled='disabled' name='Misc Charge' id='wwoMicsChrg"+WwoDivnum+"' value='"+totalMisc+"'/></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Total Amount</td><td class='slds-text-align--right' id='gTotalAmtWwo"+WwoDivnum+"'><i aria-hidden='true' class='fa fa-usd'></i>0.00</td><td>&nbsp;</td></tr></tbody></table><div style='margin:1%;'>Comments:&nbsp;<input id='WWOComments"+WwoDivnum+"' value='"+WWOComments+"' type='hidden' /><span style='position: relative; left:24.5%;'><a onclick='wwoaddCommentToJob(\""+WwoDivnum+"\", \"SER\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCommentFromJob(\""+WwoDivnum+"\", \"SER\");'>View</a></span> </div><div style='margin:1%;'>Customer Comments:&nbsp;<input id='WWOCUSTComments"+WwoDivnum+"' value='"+WWOCUSTComments+"' type='hidden'/><span style='position: relative; left:15%;'><a onclick='wwoaddCustCommentToJob(\""+WwoDivnum+"\", \"CUST\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCustCommentFromJob(\""+WwoDivnum+"\", \"CUST\");'>View</a></span> </div> <div style='margin: 1%;'> <span>Technician:&nbsp;<input type='hidden' id='wwojbTechId"+WwoDivnum+"' value='"+TechId+"'/><span id='wwotechName"+WwoDivnum+"'>"+TechName+"</span>&nbsp;<a onclick='wwoaddTechnician(\""+WwoDivnum+"\")' style='position: absolute; left:19.5%;'> "+BTN_lbl+" </a></span> </div></td><td style='vertical-align: top;'><table cellspacing='5' style='margin: 5px;'><tr><td colspan='2' style='text-align: center;'><input type='hidden' id='paymentStatus"+WwoDivnum+"' value='0'/><a class='slds-button slds-button--neutral slds-button--brand inside_row_button' id='addPayment"+WwoDivnum+"' onclick='addPaymentonWWOJ(\""+WwoDivnum+"\",\"0\");'>Add Paymet</a></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Status:</td><td><select id='wwoClmStts"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-select'><option value=''>--None--</option></select></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Date:</td><td><input id='wwoClmDt"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Approval Date:</td><td><input id='wwoClmApprvl"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Approved Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input id='wwoClmlbrAppAmo"+WwoDivnum+"' onkeypress='return isNumberKey(event)' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Return Parts Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input onkeypress='return isNumberKey(event)' id='wwoRtrnPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Paid Date:</td><td><input  id='wwoClmPdDate"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")'  id='wwoClmLbrPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Parts Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoPrtPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Misc Charge Paid ($)</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoMicsChrgp"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Total Paid:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' id='wwoTtlPd"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Balance Due:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' id='wwoBlncDue"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr></table></td></tr></table></div></div>";
                       
                    if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r != undefined) {
                        var totalOfAllWwo = 0.00;
                        for(var i=0; i<Wwolstjob[0].BOATBUILDING__Job_Line_Items__r.length; i++){
                            var WWoPartnumber = '', WWoPartQuantity = '',WWoPartname = '',WWoPartPrice = 0.0,WWoPartTotalPrice = 0.0; 
                            if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Part_Number__c != undefined){
                                WWoPartnumber = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Part_Number__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].Name != undefined){
                                WWoPartname = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].Name;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Quantity__c != undefined ){
                                WWoPartQuantity = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Quantity__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Price__c != undefined ){
                                WWoPartPrice = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Price__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Total__c != undefined ){
                                WWoPartTotalPrice = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r[i].BOATBUILDING__Total__c;
                                totalOfAllWwo += parseFloat(WWoPartTotalPrice);
                            }  
                            objDivTotalPartAmtWwo["WwoDivnum"+WwoDivnum] = totalOfAllWwo;
                            Wwopartdiv += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+WWoPartnumber+'</td><td width="65">'+WWoPartname+'</td><td width="106">&nbsp;</td><td data-label="Quanity" width="144">'+WWoPartQuantity+'</td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartPrice+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartTotalPrice+'</td></tr></table>';                            
                        }
                        
                    }
                    var id = "#WwoWorkTypeSelect"+WwoDivnum;
                    $("#WwoAddDivForJob").append(Wwonewdiv);
                    Wwobind_WorkType(id,WWoworktype);
                    var Wwofd = document.getElementById("Wwoexistingjobdiv"+WwoDivnum);
                    $(Wwofd).append(Wwopartdiv);
                    if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r != undefined){
                        document.getElementById('WwotheValueDiv'+WwoDivnum).value = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r.length;
                    }
                    Wwoalllstjob = Wwoalllstjob.concat(Wwolstjob);
                    Wwocalculate_totalofallJobDiv();
                    calDiscountedTotalAmtWwo(WwoDivnum);
                    addClaimStatus(WwoDivnum, WWOClaimStatus);        
            }
            else{
//                 document.getElementById("wwoerrSnap").innerHTML = "Please Select Existing Job";
//                 $("#wwoerrorDiv").slideDown();
//                 $("#wwoerrorDiv").delay(8000).slideUp();
                alert("Please Select Existing Job");
                return false;
            } 
        }
        else{
//                 document.getElementById("wwoerrSnap").innerHTML = "Please Select Customer And Boat";
//                 $("#wwoerrorDiv").slideDown();
//                 $("#wwoerrorDiv").delay(8000).slideUp();
                alert("Please Select Customer And Boat");
                return false; 
            }
        
    });
    
    $("#WwoNewJobBtn").click(function(){  
        if(document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid').value != '000000000000000' &&  document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2').value != ''&& document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid').value != '000000000000000' && document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId').value != ''){
            if(document.getElementById('Wwonewjobworequested').value != '' && document.getElementById('WwoWorkTypeIdselect').value != '0' && document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoTypeWorkId').value != ''
               && document.getElementById('WwonewjobNameId').value != ''){
                //$("#Wwohiddenbtn").css("display","");
                $("#WwoShowjobList").css("display", "");
                var WwojobName = document.getElementById('WwonewjobNameId').value;
                var Wwonewjobworequested = document.getElementById('Wwonewjobworequested').value;
                var WwonewjobWorkTypeId = $("#WwoWorkTypeIdselect option:selected").text(); 
                console.log(WwoWorkTypeIdselect);
                // var WwonewjobWorkTypeIdValue = $("#WwoWorkTypeIdselect").val();
                //console.log('WWO TYpe value'+WwonewjobWorkTypeIdValue);
                var WwonewjobTypeWorkId = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoTypeWorkId').value;
                var WwonewjobWorkTypeIdValue = $("#WwoWorkTypeIdselect").val();
                console.log('---'+WwonewjobTypeWorkId);
                var WwoDivi = document.getElementById('WwoDivValue');
                var WwoDivnum = (document.getElementById("WwoDivValue").value -1)+ 2;
                WwoDivi.value = WwoDivnum;
                var WwotheValue = "WwotheValueDiv"+WwoDivnum;
                var WwoAddPart = "WwoAddPartDiv"+WwoDivnum;
                var Wwohiddentd = "WwohiddentdDiv"+WwoDivnum;
                var WwoLabourQuantity = "WwoLabourQuantityDiv"+WwoDivnum; 
                var WwoLabourPrice = "WwoLabourPriceDiv"+WwoDivnum;
                var WwoLabourTotalPrice = "WwoLabourTotalPriceDiv"+WwoDivnum;
                var WwoTotalOfJobDiv = "WwoTotalOfJobDiv"+WwoDivnum; 
                var Wwofile1 = "Wwofile1Div"+WwoDivnum;   
                var Wwonewdiv ="<div class='slds-card' style='background-color: #ffffff;' id='Wwonewdiv"+WwoDivnum+"'><div  style='color: red; position: absolute; margin: 3px;' id='Wwoerror-panel"+WwoDivnum+"'><ul style='color: red;' id='Wwoerror-div"+WwoDivnum+"'></ul></div><div style='float:right;line-height:0;'><a style='text-decoration:none;padding:5px;' onclick='Wworemove_div(\"Wwonewdiv"+WwoDivnum+"\")'><i class='fa fa-times fa-lg' style='margin-top: 4px;' aria-hidden='true'></i></a></div><div class='slds-grid slds-wrap slds-m-top--medium '><table><tr><td><table class='slds-table slds-table--bordered' style='border-right: 1px solid #d8dde6;'><thead><tr><th width='43'>Job Name:</th><th width='95' id='WwojobNameId"+WwoDivnum+"'>"+WwojobName+"</th><th width='106'>&nbsp;</th><th width='144'>&nbsp;</th><th width='90' class='slds-text-align--right'>&nbsp;</th><th width='84' colspan='2' class='slds-text-align--right'>&nbsp;</th></tr><tr><th width='43'>Job</th><th width='95'>Work Requested</th><th width='106'>Type</th><th width='144'>Quantity</th><th width='90' class='slds-text-align--right'>Price</th><th width='84' colspan='2' class='slds-text-align--right'>Total</th></tr></thead><tbody><tr><td></td><td id=Wwonewjobworequested"+WwoDivnum+">"+Wwonewjobworequested+"</td><td colspan='2'><select id=WwonewjobWorkTypeId"+WwoDivnum+" class='slds-select' onchange='Wwochange_LabourValues("+WwoDivnum+");'><option value='0' selected='selected'>--None--</option></select></td><td><input type=hidden id=WwonewjobTypeWorkId"+WwoDivnum+" value="+WwonewjobTypeWorkId+"/></td><td colspan='2' class='slds-text-align--right'><a class='slds-button slds-button--brand' onclick='Wwoadd_new_row(\""+WwoDivnum+"\");' style='font-size: 9px; padding: 7px; padding-bottom: 1px; padding-top: 1px;' id='"+WwoAddPart+"'>Add Part</a></td></tr><tr><td colspan='7' id='"+Wwohiddentd+"' style='display:none;'><div id='"+Wwofile1+"'><input type='hidden' name='theValue' id='"+WwotheValue+"' value='0' /></div></td></tr><tr><td>&nbsp;</td><td data-label='Labor'>Labor</td><td>&nbsp;</td><td data-label='Quantity'><input id='"+WwoLabourQuantity+"' onkeypress='return isNumberKey(event)' class='slds-input' type='text' onkeyup='Wwocalculate_LabourPrice_Div("+WwoDivnum+"); Wwocalculate_totalofJobDiv("+WwoDivnum+");'/></td><td data-label='Price' class='slds-text-align--right'><input id='"+WwoLabourPrice+"' disabled='disabled' value='"+parseFloat(WwonewjobWorkTypeIdValue).toFixed(2)+"' class='slds-input' type='text' onkeypress='return isNumberKey(event)' onkeyup='Wwocalculate_LabourPrice_Div("+WwoDivnum+"); Wwocalculate_totalofJobDiv("+WwoDivnum+"); '/></td><td data-label='Total' class='slds-text-align--right' ><i aria-hidden='true' class='fa fa-usd'></i><span id='"+WwoLabourTotalPrice+"'>0.00</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td data-label='Prospecting' class='slds-text-align--right'>Total:<td class='slds-text-align--right' ><i aria-hidden='true' class='fa fa-usd'></i><span id='"+WwoTotalOfJobDiv+"'>0.00</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Discount ($)</td><td class='slds-text-align--right'><input style='width: 150%; position: relative; z-index: 9;' onkeypress='return isNumberKey(event)' class='slds-input' onKeyUp='calDiscountedTotalAmtWwo("+WwoDivnum+");' name='Discount' id='WwodiscountOnJob"+WwoDivnum+"'/></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>Misc Description 1</td><td colspan='2'><input type='text' class='slds-input' id='miscDescwwo1"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 1 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo1"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 2</td><td colspan='2'><input type='text' class='slds-input'  id='miscDescwwo2"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 2 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo2"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 3</td><td colspan='2'><input type='text' class='slds-input' id='miscDescwwo3"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 3 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo3"+WwoDivnum+"'/></td><td>&nbsp;</td></tr>   <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Misc Charge ($)</td><td class='slds-text-align--right'><input class='slds-input' onchange='calDiscountedTotalAmtWwo("+WwoDivnum+");' disabled='disabled' name='Misc Charge' id='wwoMicsChrg"+WwoDivnum+"' /></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Total Amount</td><td class='slds-text-align--right' ><i aria-hidden='true' class='fa fa-usd'></i><span id='gTotalAmtWwo"+WwoDivnum+"'>0.00</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table><div style='margin:1%;'>Comments:&nbsp;<input id='WWOComments"+WwoDivnum+"' type='hidden' /><span style='position: relative; left:24.5%;'><a onclick='wwoaddCommentToJob(\""+WwoDivnum+"\" , \"SER\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCommentFromJob(\""+WwoDivnum+"\", \"SER\");'>View</a></span> </div><div style='margin:1%;'>Customer Comments:&nbsp;<input id='WWOCUSTComments"+WwoDivnum+"' type='hidden'/><span style='position: relative; left:15%;'><a onclick='wwoaddCustCommentToJob(\""+WwoDivnum+"\", \"CUST\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCustCommentFromJob(\""+WwoDivnum+"\", \"CUST\");'>View</a></span> </div><div style='margin: 1%;'> <span>Technician:&nbsp;<input type='hidden' id='wwojbTechId"+WwoDivnum+"' value=''/><span id='wwotechName"+WwoDivnum+"'></span>&nbsp;<a onclick='wwoaddTechnician(\""+WwoDivnum+"\")' style='position: absolute; left:19.5%;'> Add Technician </a></span> </div></td><td style='vertical-align: top;'><table cellspacing='5' style='margin: 5px;'><tr><td colspan='2' style='text-align: center;'><input type='hidden' id='paymentStatus"+WwoDivnum+"' value='0'/><a class='slds-button slds-button--neutral slds-button--brand inside_row_button' id='addPayment"+WwoDivnum+"' onclick='addPaymentonWWOJ(\""+WwoDivnum+"\",\"0\");'>Add Paymet</a></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Status:</td><td><select id='wwoClmStts"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-select'><option value=''>--None--</option></select></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Date:</td><td><input id='wwoClmDt"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Approval Date:</td><td><input id='wwoClmApprvl"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Approved Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input id='wwoClmlbrAppAmo"+WwoDivnum+"' onkeypress='return isNumberKey(event)' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Return Parts Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input onkeypress='return isNumberKey(event)' id='wwoRtrnPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Paid Date:</td><td><input id='wwoClmPdDate"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")'  id='wwoClmLbrPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Parts Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoPrtPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Misc Charge Paid ($)</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoMicsChrgp"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Total Paid:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input  disabled='disabled' id='wwoTtlPd"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Balance Due:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' id='wwoBlncDue"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr></table></td></tr></table></div></div>";
                var WwoWorkTypeSelect = "#WwonewjobWorkTypeId"+WwoDivnum;  
                $("#WwoAddDivForJob").append(Wwonewdiv);
                Wwobind_WorkType(WwoWorkTypeSelect,WwonewjobWorkTypeId); 
                addClaimStatus(WwoDivnum, '');
                $("#WwonewjobNameId").val("");
                $("#Wwonewjobworequested").val("");  
                $("#WwoWorkTypeIdselect").val("0");
                document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoTypeWorkId').value = "";
            }
            else{
//                 document.getElementById("wwoerrSnap").innerHTML = "WorkRequested WorkType And Type are mandatory";
//                 $("#wwoerrorDiv").slideDown();
//                 $("#wwoerrorDiv").delay(8000).slideUp();
                alert("WorkRequested WorkType And Type are mandatory");
                return false;
            }
        }
        else{
//               document.getElementById("wwoerrSnap").innerHTML = "Customer And Boat Selection are mandatory";
//               $("#wwoerrorDiv").slideDown();
//               $("#wwoerrorDiv").delay(8000).slideUp();
              alert("Customer And Boat Selection are mandatory");
              return false;
            }
                
    });
    function addPaymentonWWOJ(divNum, jobId) {
    	//wwoPaymentJobDivNum wwoPaymentJobId
		$("#wwoClmLbrPdAmt").val($("#wwoClmLbrPdAmt"+divNum).val());
		$("#wwoPrtPdAmt").val($("#wwoPrtPdAmt"+divNum).val());
		$("#wwoMicsChrgp").val($("#wwoMicsChrgp"+divNum).val());
    	
    	$("#wwoPaymentJobDivNum").val(divNum);
    	$("#wwoPaymentJobId").val(jobId);
    	$("#addPymtPop").fadeIn();
    	
    }
    /*$("#WwoAddnewjob").click(function(){
        $("#WwoshowaddjobPanel").css("display", "");
        $("#WwoExistingJobPanel").css("display", "none");
    });
    $("#WwoHideNewjobPanel").click(function(){
        $("#WwoshowaddjobPanel").css("display", "none");
        $("#WwoExistingJobPanel").css("display", "");
    });*/ 
    
    $("#wwoaddNewJobBtn").click(function(){
        $("#WwoshowaddjobPanel").css("display", "");
        $("#WwoExistingJobPanel").css("display", "none");
    });
    $("#wwoaddCannedJobBtn").click(function(){
        $("#WwoshowaddjobPanel").css("display", "none");
        $("#WwoExistingJobPanel").css("display", "");
        $(".chosenWWO").chosen({
            no_results_text: "Oops, nothing found!" 
        });
    });
    
    function Wwoguid() {
        function s4() {
            return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
        }
    return s4() + s4() + s4() + s4() + s4();
    }
        
    function isNumber(evt) {
        evt = (evt) ? evt : window.event;
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode > 31 && (charCode < 48 || charCode > 57)) {
            return false;
        }
        return true;
    }
        
    function isNumberKey(evt) {
          var charCode = (evt.which) ? evt.which : evt.keyCode;
          if (charCode != 46 && charCode > 31 
            && (charCode < 48 || charCode > 57)){
             return false;
          }
          return true;
      }
     
       
        
    var Wwojsonobject = '';
    function WwojsonCreation(WwoDivnum){
    var Wwoline_items = '', Wwojob_items = '';
    Wwojsonobject = '[';
    var TechId = '', WWOCUSTComments = '', wwodiscountAmtOnJob = '0.00', PromoCode = '', CustomerBoatStatus = ''; StoreLocation  = '', miscDesc1 = '', miscDesc2 = '', miscDesc3 = '', miscChrge1 = '', miscChrge2 = '', miscChrge3 = '', WWOMISCChrgep = '0.00', WWOMISCChrge = '0.00', WWOComments='', WwoClaim_Status = '', JobName = '', WwoClaim_Date = '', WwoClaim_Approval_Date = '', WwoClaim_Labor_Approved_Amo = '', WwoReturn_Parts_Amount = '', WwoClaim_Paid_Date = '', WwoClaim_Labor_Paid_Amount = '', WwoParts_Paid_Amount = '', WwoTotal_Paid = '', WwoBalance_Due = '',  Wwoworkrequested = '',WwoWorkTypeId = '', WwoTypeWorkId = '',WwoLine_item_count = '',WwoLabour_Quantity = '', WwoLabour_Price = '',WwoCustomer_Pay = '', WwoExistingJobId = '',WwoPartQuantity = '',WwoPartPrice = '',WwoContact_id = '', WwoboatId = '', WwODriveId = '', WwOHoursId = '' , WwoPartId = '', WWoStatus = '';
    var Wwocount = 0;
    var existingWWOId = '';
    var eeee = document.getElementById("WWOcaseHiddenId").value;
    if(eeee != undefined && eeee != null && eeee != "") {
        existingWWOId = document.getElementById("WWOcaseHiddenId").value;
    }  
    WwoContact_id = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid').value;
    WwoboatId = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid').value;
    if(document.getElementById('WwODriveId').value != ''){
        WwODriveId = document.getElementById('WwODriveId').value;
    }
    else{
        WwODriveId = "null";
    }
    if(document.getElementById('WwOHoursId').value != ''){
        WwOHoursId = document.getElementById('WwOHoursId').value;
    }
    else{
        WwOHoursId = "null";
    }
    var WwoStatuslist = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus');
    if(WwoStatuslist.options[WwoStatuslist.selectedIndex].value != ''){
        WWoStatus = WwoStatuslist.options[WwoStatuslist.selectedIndex].value;
    }
    else{
        //document.getElementById("wwoerrSnap").innerHTML = "Please Select Status";
        //$("#wwoerrorDiv").slideDown();
        //$("#wwoerrorDiv").delay(8000).slideUp();
        alert("Please Select Status.");
        return false;
    }
    
     
    if(document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WoCBS").value != '') {
        CustomerBoatStatus = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WoCBS").value;
    }else {
        CustomerBoatStatus = "null";
    }
    if(document.getElementById("wwoPromocode").value != '0') {
        PromoCode = document.getElementById("wwoPromocode").value;
    }else {
        PromoCode = "null";
    }
    if(StoreLocationRequired == true) {
        var WwoStrLctlist = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStoreLocation');
        if(WwoStrLctlist.options[WwoStrLctlist.selectedIndex].value != '') {
            StoreLocation = WwoStrLctlist.options[WwoStrLctlist.selectedIndex].value;
        }
        else{
            alert("Please Select Store Location.");
            return false;
        }    
    } else {
        var WwoStrLctlist = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStoreLocation');
        if(WwoStrLctlist.options[WwoStrLctlist.selectedIndex].value != '') {
            StoreLocation = WwoStrLctlist.options[WwoStrLctlist.selectedIndex].value;
        }
    }
    
    Wwojob_items = '';
        for(var i=1;i<=WwoDivnum;i++){
        
            if(document.getElementById('WWojobId'+i) != null){
                WwoExistingJobId = document.getElementById('WWojobId'+i).value;
            
            if(document.getElementById('wwojbTechId'+i).value != '' && document.getElementById('wwojbTechId'+i).value != '0'){
                TechId = document.getElementById('wwojbTechId'+i).value;
            } else {
                TechId = '';
            }
            
            if(document.getElementById('WwoExistingjobName'+i).value != ''){
                JobName = document.getElementById('WwoExistingjobName'+i).value;
            }
            else{
                document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Job Name</li>';
                return false;
            }
            
            if(document.getElementById('WwodiscountOnJob'+i).value != ''){
              	wwodiscountAmtOnJob = document.getElementById('WwodiscountOnJob'+i).value;
          	} else {
              	wwodiscountAmtOnJob = '0.00';  
          	}
            
            if(document.getElementById('wwoClmStts'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoClaim_Status = document.getElementById('wwoClmStts'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Status</li>';
                return false;*/
                WwoClaim_Status = "";
            }
            console.log(WwoClaim_Status +" : "+i);
            if(document.getElementById('wwoClmDt'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoClaim_Date = document.getElementById('wwoClmDt'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Date</li>';
                return false;*/
                WwoClaim_Date = "";
            }
            if(document.getElementById('wwoClmApprvl'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoClaim_Approval_Date = document.getElementById('wwoClmApprvl'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Approval Date</li>';
                return false;*/
                WwoClaim_Approval_Date = "";
            }
            if(document.getElementById('wwoClmlbrAppAmo'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = ''; 
                WwoClaim_Labor_Approved_Amo = document.getElementById('wwoClmlbrAppAmo'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Labor Approved Amount</li>';
                return false;*/
                WwoClaim_Labor_Approved_Amo = "";
            }
            if(document.getElementById('wwoRtrnPdAmt'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoReturn_Parts_Amount = document.getElementById('wwoRtrnPdAmt'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Return Parts Amount</li>';
                return false;*/
                WwoReturn_Parts_Amount = "";
            }
            if(document.getElementById('wwoClmPdDate'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoClaim_Paid_Date = document.getElementById('wwoClmPdDate'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Paid Date</li>';
                return false;*/
                WwoClaim_Paid_Date = "";
            }
            if(document.getElementById('wwoClmLbrPdAmt'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoClaim_Labor_Paid_Amount = document.getElementById('wwoClmLbrPdAmt'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Labor Paid Amount</li>';
                return false;*/
                WwoClaim_Labor_Paid_Amount = "";
            }
            if(document.getElementById('wwoPrtPdAmt'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoParts_Paid_Amount = document.getElementById('wwoPrtPdAmt'+i).value;
            }
            else{
                /*document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Parts Paid Amount</li>';
                return false;*/
                WwoParts_Paid_Amount = "";
            }
            if(document.getElementById('wwoTtlPd'+i).value != ''){
                WwoTotal_Paid = document.getElementById('wwoTtlPd'+i).value;
            }
            if(document.getElementById('wwoBlncDue'+i).value != ''){
                WwoBalance_Due = document.getElementById('wwoBlncDue'+i).value;
            }
            if(document.getElementById('WWOComments'+i).value != ''){
                WWOComments = document.getElementById('WWOComments'+i).value;
            } else {
            	WWOComments = ''
            }
            
            if(document.getElementById('WWOCUSTComments'+i).value != ''){
                WWOCUSTComments = document.getElementById('WWOCUSTComments'+i).value;
            } else {
            	WWOCUSTComments = ''
            }
            
            
            if(document.getElementById('WwoLabourQuantityDiv'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoLabour_Quantity = document.getElementById('WwoLabourQuantityDiv'+i).value;
            }
            else{
                document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Labor Quantity</li>';
                return false;
            }
            if(document.getElementById('WwoLabourPriceDiv'+i).value != ''){
                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                WwoLabour_Price = document.getElementById('WwoLabourPriceDiv'+i).value;
            }
            else{
                document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Labor Price</li>';
                return false;
            }
            
            if(document.getElementById('WwoWorkTypeSelect'+i) != null){
                //WwoWorkTypeId = document.getElementById('WwoWorkTypeSelect'+i).value;
                var wId = '#WwoWorkTypeSelect'+i;
                WwoWorkTypeId = $(wId+" option:selected").text();
                console.log(WwoWorkTypeId);
            }
            /*if(document.getElementById('wwoMicsChrg'+i) != null && document.getElementById('wwoMicsChrg'+i).value != ''){
                WWOMISCChrge = document.getElementById('wwoMicsChrg'+i).value;
            } else {
                WWOMISCChrge = '0.00';
            }*/
            
            if(document.getElementById('wwoMicsChrgp'+i) != null && document.getElementById('wwoMicsChrgp'+i).value != ''){
                WWOMISCChrgep = document.getElementById('wwoMicsChrgp'+i).value;
            } else {
                WWOMISCChrgep = '0.00';
            }
            
            
            if(document.getElementById('miscChargewwo1'+i).value != ''){        
                miscChrge1 = document.getElementById('miscChargewwo1'+i).value;     
            } else {
                miscChrge1 = '0.00';
            }
            if(document.getElementById('miscChargewwo2'+i).value != ''){        
                miscChrge2 = document.getElementById('miscChargewwo2'+i).value;     
            } else {
                miscChrge2 = '0.00';
            }
            if(document.getElementById('miscChargewwo3'+i).value != ''){        
                miscChrge3 = document.getElementById('miscChargewwo3'+i).value;     
            } else {
                miscChrge3 = '0.00';
            }
            //miscDesc1
            if(document.getElementById('miscDescwwo1'+i).value != ''){        
                miscDesc1 = document.getElementById('miscDescwwo1'+i).value;     
            } else {
                miscDesc1 = '0.00';
            }
            if(document.getElementById('miscDescwwo2'+i).value != ''){        
                miscDesc2 = document.getElementById('miscDescwwo2'+i).value;     
            } else {
                miscDesc2 = '0.00';
            }
            if(document.getElementById('miscDescwwo3'+i).value != ''){        
                miscDesc3 = document.getElementById('miscDescwwo3'+i).value;     
            } else {
                miscDesc3 = '0.00';
            }
            
            
            console.log('>>>>>>'+WwoWorkTypeId);
            if(i>1 && Wwojob_items != ''){
               Wwojob_items += ','; 
            }
            //
            Wwojob_items += '{'+'"ExistingJobId"'+':'+'"'+WwoExistingJobId+'"'+','+'"Id"'+':'+'"'+Wwoguid()+'"'+','+'"WorkRequested"'+':'+'"'+Wwoworkrequested+'"'+','+'"JobName"'+':'+'"'+JobName+'"'+','+'"DiscountOnJob"'+':'+'"'+wwodiscountAmtOnJob+'"'+','+'"WorkType"'+':'+'"'+WwoWorkTypeId+'"'+','+'"Type"'+':'+'"'+WwoTypeWorkId+'"'+','+'"Line_item_count"'+':'+'"'+WwoLine_item_count+'"'+','+'"line_items"'+':'+'['+Wwoline_items+']'+','+'"Labour_Quantity"'+':'+'"'+WwoLabour_Quantity+'"'+','+'"Labour_Price"'+':'+'"'+WwoLabour_Price+'"'+','+'"Customer_Pay"'+':'+'"'+WwoCustomer_Pay+'"'+','+'"Claim_Status"'+':'+'"'+WwoClaim_Status+'"'+','+'"Claim_Date"'+':'+'"'+WwoClaim_Date+'"'+','+'"Claim_Approval_Date"'+':'+'"'+WwoClaim_Approval_Date+'"'+','+'"Claim_Approved_Amo"'+':'+'"'+WwoClaim_Labor_Approved_Amo+'"'+','+'"Return_Part_Amount"'+':'+'"'+WwoReturn_Parts_Amount+'"'+','+'"Claim_Paid_Date"'+':'+'"'+WwoClaim_Paid_Date+'"'+','+'"Claim_Labor_Paid_Amount"'+':'+'"'+WwoClaim_Labor_Paid_Amount+'"'+','+'"Parts_Paid_Amount"'+':'+'"'+WwoParts_Paid_Amount+'"'+','+'"Total_Paid"'+':'+'"'+WwoTotal_Paid+'"'+','+'"WWOBalance_Due"'+':'+'"'+WwoBalance_Due+'"'+','+'"WWOCUSTComments"'+':'+'"'+WWOCUSTComments+'"'+','+'"WWOComments"'+':'+'"'+WWOComments+'"'+','+'"WWOMISCChrge"'+':'+'"'+miscChrge1+'"'+','+'"WWOMISCChrge2"'+':'+'"'+miscChrge2+'"'+','+'"WWOMISCChrge3"'+':'+'"'+miscChrge3+'"'+','+'"WWOMISCDesc1"'+':'+'"'+miscDesc1+'"'+','+'"WWOMISCDesc2"'+':'+'"'+miscDesc2+'"'+','+'"WWOMISCDesc3"'+':'+'"'+miscDesc3+'"'+','+'"WWOMISCChrgep"'+':'+'"'+WWOMISCChrgep+'"'+','+'"TechId"'+':'+'"'+TechId+'"'+'}';    
        }
        else{
            WwoExistingJobId = '';
            if(document.getElementById('Wwonewdiv'+i) != null){
                var WwouniqueId = Wwoguid();
                
                
                if(document.getElementById('WwojobNameId'+i).innerHTML != ''){
                    JobName = document.getElementById('WwojobNameId'+i).innerHTML;
                }else {
                    document.getElementById("wwoerrSnap").innerHTML = "Please fill Job Name";
                    $("#wwoerrorDiv").slideDown();
                    $("#wwoerrorDiv").delay(8000).slideUp();
                    return;
                }
                
                if(document.getElementById('wwojbTechId'+i).value != '' && document.getElementById('wwojbTechId'+i).value != '0'){
	                TechId = document.getElementById('wwojbTechId'+i).value;
	            } else {
	                TechId = '';
	            }
                
                if(document.getElementById('WwodiscountOnJob'+i).value != ''){
	              	wwodiscountAmtOnJob = document.getElementById('WwodiscountOnJob'+i).value;
	          	} else {
	              	wwodiscountAmtOnJob = '0.00';  
	          	} 
                if(document.getElementById('Wwonewjobworequested'+i).innerHTML != ''){
                    Wwoworkrequested = document.getElementById('Wwonewjobworequested'+i).innerHTML;
                }
                else{
                    document.getElementById("wwoerrSnap").innerHTML = "Please fill Job Requested";
                    $("#wwoerrorDiv").slideDown();
                    $("#wwoerrorDiv").delay(8000).slideUp();
                    return;
                }
                if(document.getElementById('WwonewjobWorkTypeId'+i).value != ''){
                    //WwoWorkTypeId = document.getElementById('WwonewjobWorkTypeId'+i).value;
                    var wId = '#WwonewjobWorkTypeId'+i;
                    WwoWorkTypeId = $(wId+" option:selected").text();
                }
                if(document.getElementById('WwonewjobTypeWorkId'+i).value != ''){
                    WwoTypeWorkId = document.getElementById('WwonewjobTypeWorkId'+i).value;
                }
                if(document.getElementById('WwotheValueDiv'+i).value != ''){
                    Wwoline_items = '';
                    WwoLine_item_count = document.getElementById('WwotheValueDiv'+i).value;
                    for(var j=1; j<=WwoLine_item_count; j++){
                        //var WwoPartlist = document.getElementById('WwoselectpartlistDiv'+i+j);
                        //WwoPartId = WwoPartlist.options[WwoPartlist.selectedIndex].value;
                        //var wwoPartName = $("#WwoselectpartlistDiv"+i+j+" option:selected").text();
                        //console.log(wwoPartName); 

                        WwoPartId = document.getElementById('WwoprtId'+i+j).innerHTML;
                        //PartName = $("#selectpartlistDiv"+i+j+" option:selected").text();
                        wwoPartName = document.getElementById('WwoselectpartlistDiv'+i+j).value;

                        if(WwoPartId != 'Choose...'){
                            document.getElementById('Wwoerror-div'+i).innerHTML = '';
                            if(document.getElementById('WwoPartsQuantityDiv'+i+j).value != ''){
                                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                                WwoPartQuantity = document.getElementById('WwoPartsQuantityDiv'+i+j).value;
                            }
                            else{
                                document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Parts Quantity</li>';
                                return false;
                            }
                            if(document.getElementById('WwoPartPriceDiv'+i+j).innerHTML != ''){
                                document.getElementById('Wwoerror-div'+i).innerHTML = '';
                                WwoPartPrice = document.getElementById('WwoPartPriceDiv'+i+j).innerHTML;
                            }
                            else{
                                document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Part Price</li>';
                                return false;
                            }
                            if(j>1){
                                Wwoline_items += ',';
                            } 
                            Wwoline_items += '{'+'"Id"'+':'+'"'+WwouniqueId+'"'+','+'"PartId"'+':'+'"'+WwoPartId+'"'+','+'"PartQuantity"'+':'+'"'+WwoPartQuantity+'"'+','+'"PartPrice"'+':'+'"'+WwoPartPrice+'"'+','+'"PartNameNumber"'+':'+'"'+wwoPartName+'"'+'}'; 
                        }
                        else{
                            document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please Select Part</li>';
                            return false;
                        }
                    }
                     
                }
                if(document.getElementById('WwoLabourQuantityDiv'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoLabour_Quantity = document.getElementById('WwoLabourQuantityDiv'+i).value;
                }
                else{
                    document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Labor Quantity</li>';
                    return false;
                }
                if(document.getElementById('WwoLabourPriceDiv'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoLabour_Price = document.getElementById('WwoLabourPriceDiv'+i).value;
                }
                else{
                    document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Labor Price</li>';
                    return false;
                }
                /*
                if(document.getElementById('WwoCustomerPay'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoCustomer_Pay = document.getElementById('WwoCustomerPay'+i).value;
                }
                */
                if(document.getElementById('wwoClmStts'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Status = document.getElementById('wwoClmStts'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Status</li>';
                    //return false;
                    WwoClaim_Status = "";
                }
                console.log(WwoClaim_Status +" new: "+i); 
                if(document.getElementById('wwoClmDt'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Date = document.getElementById('wwoClmDt'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Date</li>';
                    //return false;
                    WwoClaim_Date ="";
                }
                if(document.getElementById('wwoClmApprvl'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Approval_Date = document.getElementById('wwoClmApprvl'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Approval Date</li>';
                    //return false;
                    WwoClaim_Approval_Date = "";
                }
                if(document.getElementById('wwoClmlbrAppAmo'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Labor_Approved_Amo = document.getElementById('wwoClmlbrAppAmo'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Labor Approved Amount</li>';
                    //return false;
                    WwoClaim_Labor_Approved_Amo = "";
                }
                if(document.getElementById('wwoRtrnPdAmt'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoReturn_Parts_Amount = document.getElementById('wwoRtrnPdAmt'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Return Parts Amount</li>';
                    //return false;
                    WwoReturn_Parts_Amount = "";
                }
                if(document.getElementById('wwoClmPdDate'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Paid_Date = document.getElementById('wwoClmPdDate'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Paid Date</li>';
                    //return false;
                    WwoClaim_Paid_Date = "";
                }
                if(document.getElementById('wwoClmLbrPdAmt'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoClaim_Labor_Paid_Amount = document.getElementById('wwoClmLbrPdAmt'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Claim Labor Paid Amount</li>';
                    //return false;
                    WwoClaim_Labor_Paid_Amount = ""
                }
                if(document.getElementById('wwoPrtPdAmt'+i).value != ''){
                    document.getElementById('Wwoerror-div'+i).innerHTML = '';
                    WwoParts_Paid_Amount = document.getElementById('wwoPrtPdAmt'+i).value;
                }
                else{
                    //document.getElementById('Wwoerror-div'+i).innerHTML = '<li><i class="fa fa-times-circle"></i>Please fill Parts PAid Amount</li>';
                    //return false;
                    WwoParts_Paid_Amount = "";
                }
                if(document.getElementById('wwoTtlPd'+i).value != ''){
                    WwoTotal_Paid = document.getElementById('wwoTtlPd'+i).value;
                }
                if(document.getElementById('wwoBlncDue'+i).value != ''){
                    WwoBalance_Due = document.getElementById('wwoBlncDue'+i).value;
                }
                if(document.getElementById('WWOComments'+i).value != ''){
                    WWOComments = document.getElementById('WWOComments'+i).value;
                }
                if(document.getElementById('WWOCUSTComments'+i).value != ''){
	                WWOCUSTComments = document.getElementById('WWOCUSTComments'+i).value;
	            } else {
	            	WWOCUSTComments = ''
	            } 
                /*if(document.getElementById('wwoMicsChrg'+i) != null && document.getElementById('wwoMicsChrg'+i).value != ''){
                    WWOMISCChrge = document.getElementById('wwoMicsChrg'+i).value;
                } else {
                    WWOMISCChrge = '0.00';
                }*/
                
                
                if(document.getElementById('miscChargewwo1'+i).value != ''){        
                    miscChrge1 = document.getElementById('miscChargewwo1'+i).value;     
                } else {
                    miscChrge1 = '0.00';
                }
                if(document.getElementById('miscChargewwo2'+i).value != ''){        
                    miscChrge2 = document.getElementById('miscChargewwo2'+i).value;     
                } else {
                    miscChrge2 = '0.00';
                }
                if(document.getElementById('miscChargewwo3'+i).value != ''){        
                    miscChrge3 = document.getElementById('miscChargewwo3'+i).value;     
                } else {
                    miscChrge3 = '0.00';
                }
                //miscDesc1
                if(document.getElementById('miscDescwwo1'+i).value != ''){        
                    miscDesc1 = document.getElementById('miscDescwwo1'+i).value;     
                } else {
                    miscDesc1 = '0.00';
                }
                if(document.getElementById('miscDescwwo2'+i).value != ''){        
                    miscDesc2 = document.getElementById('miscDescwwo2'+i).value;     
                } else {
                    miscDesc2 = '0.00';
                }
                if(document.getElementById('miscDescwwo3'+i).value != ''){        
                    miscDesc3 = document.getElementById('miscDescwwo3'+i).value;     
                } else {
                    miscDesc3 = '0.00';
                }
                
                
                if(document.getElementById('wwoMicsChrgp'+i) != null && document.getElementById('wwoMicsChrgp'+i).value != ''){
                    WWOMISCChrgep = document.getElementById('wwoMicsChrgp'+i).value;
                } else {
                    WWOMISCChrgep = '0.00';
                }
                if(i>1){
                    Wwojob_items += ',';
                }
            Wwojob_items += '{'+'"ExistingJobId"'+':'+'"'+WwoExistingJobId+'"'+','+'"Id"'+':'+'"'+WwouniqueId+'"'+','+'"JobName"'+':'+'"'+JobName+'"'+','+'"DiscountOnJob"'+':'+'"'+wwodiscountAmtOnJob+'"'+','+'"WorkRequested"'+':'+'"'+Wwoworkrequested+'"'+','+'"WorkType"'+':'+'"'+WwoWorkTypeId+'"'+','+'"Type"'+':'+'"'+WwoTypeWorkId+'"'+','+'"Line_item_count"'+':'+'"'+WwoLine_item_count+'"'+','+'"line_items"'+':'+'['+Wwoline_items+']'+','+'"Labour_Quantity"'+':'+'"'+WwoLabour_Quantity+'"'+','+'"Labour_Price"'+':'+'"'+WwoLabour_Price+'"'+','+'"Customer_Pay"'+':'+'"'+WwoCustomer_Pay+'"'+','+'"Claim_Status"'+':'+'"'+WwoClaim_Status+'"'+','+'"Claim_Date"'+':'+'"'+WwoClaim_Date+'"'+','+'"Claim_Approval_Date"'+':'+'"'+WwoClaim_Approval_Date+'"'+','+'"Claim_Approved_Amo"'+':'+'"'+WwoClaim_Labor_Approved_Amo+'"'+','+'"Return_Part_Amount"'+':'+'"'+WwoReturn_Parts_Amount+'"'+','+'"Claim_Paid_Date"'+':'+'"'+WwoClaim_Paid_Date+'"'+','+'"Claim_Labor_Paid_Amount"'+':'+'"'+WwoClaim_Labor_Paid_Amount+'"'+','+'"Parts_Paid_Amount"'+':'+'"'+WwoParts_Paid_Amount+'"'+','+'"Total_Paid"'+':'+'"'+WwoTotal_Paid+'"'+','+'"WWOBalance_Due"'+':'+'"'+WwoBalance_Due+'"'+','+'"WWOCUSTComments"'+':'+'"'+WWOCUSTComments+'"'+','+'"WWOComments"'+':'+'"'+WWOComments+'"'+','+'"WWOMISCChrge"'+':'+'"'+miscChrge1+'"'+','+'"WWOMISCChrge2"'+':'+'"'+miscChrge2+'"'+','+'"WWOMISCChrge3"'+':'+'"'+miscChrge3+'"'+','+'"WWOMISCDesc1"'+':'+'"'+miscDesc1+'"'+','+'"WWOMISCDesc2"'+':'+'"'+miscDesc2+'"'+','+'"WWOMISCDesc3"'+':'+'"'+miscDesc3+'"'+','+'"WWOMISCChrgep"'+':'+'"'+WWOMISCChrgep+'"'+','+'"TechId"'+':'+'"'+TechId+'"'+'}';   
            }
        } 
     
        }
         //PromoCode
        Wwojsonobject += '{'+'"PromoCode"'+':'+'"'+PromoCode+'"'+','+'"CustomerBoatStatus"'+':'+'"'+CustomerBoatStatus+'"'+','+'"StoreLocation"'+':'+'"'+StoreLocation+'"'+','+'"WOCaseId"'+':'+'"'+existingWWOId+'"'+','+'"Contact_Id"'+':'+'"'+WwoContact_id+'"'+','+'"boatId"'+':'+'"'+WwoboatId+'"'+','+'"Drive"'+':'+'"'+WwODriveId+'"'+','+'"Hours"'+':'+'"'+WwOHoursId+'"'+','+'"Status"'+':'+'"'+WWoStatus+'"'+','+'"Job_item"'+':'+'['+Wwojob_items+']'+'}';
        
        Wwojsonobject += ']';
        return "success";
    }
     
    function calculateWarrantySection(wSDivNum) {
        var clmLbrPdAmt = 0.00; 
        if(document.getElementById("wwoClmLbrPdAmt"+wSDivNum).value != "") {
            clmLbrPdAmt = parseFloat(document.getElementById("wwoClmLbrPdAmt"+wSDivNum).value);
        }
        var prtPdAmt = 0.00;
        if(document.getElementById("wwoPrtPdAmt"+wSDivNum).value != "") { 
            prtPdAmt = parseFloat(document.getElementById("wwoPrtPdAmt"+wSDivNum).value);
        }
        
        var miscPaid = 0.00;
        if(document.getElementById("wwoMicsChrgp"+wSDivNum).value != "") { 
            miscPaid = parseFloat(document.getElementById("wwoMicsChrgp"+wSDivNum).value);
        } 
        
        var ttlPd = 0.00;
        var ttlAmt = 0.00;
        
        
        ttlPd = (parseFloat(clmLbrPdAmt) + parseFloat(prtPdAmt) + parseFloat(miscPaid)).toFixed(2);
        document.getElementById("wwoTtlPd"+wSDivNum).value = ttlPd;
        var ttlamtStr = document.getElementById("gTotalAmtWwo"+wSDivNum).innerHTML;
        if(ttlamtStr != null && ttlamtStr != '') {
            ttlAmt = parseFloat(ttlamtStr); 
        }
        var blnceDue = ttlAmt - ttlPd;
        console.log("ttlPd: "+ttlPd);
        console.log("ttlAmt: "+ttlAmt);
        console.log("blnceDue: "+blnceDue);
        document.getElementById("wwoBlncDue"+wSDivNum).value = (blnceDue).toFixed(2); 
        
        Wwocalculate_totalofallJobDiv();
    }
    
    $("#createWwoorder").click(function(){ 
            var objCaseStatus = document.getElementById("WWOcaseHiddenStatus").value;
            if(objCaseStatus != "Closed" && objCaseStatus != "closed") {
        var WwoDivnum = document.getElementById("WwoDivValue").value;
          if(document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid').value != '000000000000000' &&  document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2').value != ''&& document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid').value != '000000000000000' && document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId').value != ''){
                var Wworesult = WwojsonCreation(WwoDivnum);
                console.log(Wwojsonobject); 
                
                if(Wworesult == "success"){ 
                    $('.popup').addClass('active');
                    BOATBUILDING.WarrantyWorkOrderControllerClone.createWarrantyWorkOrder(Wwojsonobject, function(result, event) {
                    debugger;   
                        if(event.status) {
                            if(result == "Success") {
                                var wwoid = $("#WWONameEdit").val();
                                    if(wwoid != null && wwoid != "Will show in classic") {
                                        window.top.location = "/apex/BOATBUILDING__ServicePage?type=WWO&WWOId="+wwoid;
                                    } else {
                                        window.top.location = "/apex/BOATBUILDING__ServicePage?type=WWO";
                                    }       
                            } 
                            else{ 
                                alert("Something went wrong please try again.");
                                $('.popup').removeClass('active');
                            } 
                        } 
                    });
                }
                else{
                    return false;
                }
            }
            else{
//                 document.getElementById("wwoerrSnap").innerHTML = "Please select customer and boat";
//                 $("#wwoerrorDiv").slideDown(); 
//                 $("#wwoerrorDiv").delay(8000).slideUp(); 
                alert("Please select customer and boat");
                return false;
            }
        } else {
                alert("This work order has been closed.\nThank you!!");
        } 
    });
    
    
    function fetchWrntyWorkOrder(obj, objCaseId, objCaseName,objCaseAmtDue, objCaseStatus) {
                console.log("aa");   
            $('.popup').addClass('active');
            $("#ScheduleWWoo").show();
            if(objCaseStatus == "Closed" || objCaseStatus == "closed") {
                    $("#createWwoorder").hide();
                    $("#cancelWwoorder").hide();
                    $("#WwoAddjob").hide();
                    $("#WwoAddnewjob").hide();
                    $("#ScheduleWWoo").hide();
                    $("#wwoorLb").html("");
            }
            
            document.getElementById("WWOcaseHiddenId").value = objCaseId;
            document.getElementById("WWOcaseHiddenStatus").value = objCaseStatus;
            
            //document.getElementById("caseHiddenName").value = objCaseName; 
            //document.getElementById("caseHiddenTotalAmtDue").value = objCaseAmtDue;
            WWOexisting = true;
            //$("#woSpinner").show(); 
            BOATBUILDING.WarrantyWorkOrderControllerClone.fetchWorkOrder(objCaseId, function(result, event) {
            $('.popup').removeClass('active');
                if(event.status) {
                    if(result != null) {
                    	
                    	$("#updatecusnotificationwwo").show();
                        $("#prntWWO").show();
                        $("#backToListWWO").show();
                        $("#refereshBtnWWO").show();
                        $("#WWO_TWO").show();
                        
                        $("#frmBtnwwo").show();
                        $("#woSpinner").hide();
                        
                        
                        $("#wrntyworkOrderListViewDiv").hide();
                        $("#wrntyworkOrderFormDiv").show();
                        console.log(result);
                        document.getElementById("createWwoorder").innerHTML = "Update Warranty Work Order";
                        //existing = true;
                        //alert(result[0].BOATBUILDING__Total_Payment_payment__c); 
                        if(result[0].BOATBUILDING__Total_Payment_payment__c != undefined) {
                            //document.getElementById("grandtotal_payment").value = result[0].BOATBUILDING__Total_Payment_payment__c;
                        } else {
                            //document.getElementById("grandtotal_payment").value = (0.00).toFixed(2);
                        }
                        
                        
                        document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid").value = result[0].BOATBUILDING__Contact__c;
                        //existingCaseId = result[0].Id;
                        if(result[0].BOATBUILDING__Contact__r.FirstName != undefined) {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkold").value = result[0].BOATBUILDING__Contact__r.FirstName +" "+ result[0].BOATBUILDING__Contact__r.LastName;
                        }else {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkold").value = result[0].BOATBUILDING__Contact__r.LastName;
                        }
                        
                        if(result[0].BOATBUILDING__Contact__r.FirstName != undefined) {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2").value = result[0].BOATBUILDING__Contact__r.FirstName +" "+ result[0].BOATBUILDING__Contact__r.LastName;
                        }else {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2").value = result[0].BOATBUILDING__Contact__r.LastName;
                        }
                        
                        if(result[0].BOATBUILDING__Contact__r.MailingStreet != undefined) {
                            document.getElementById("WWoAddressId").value = result[0].BOATBUILDING__Contact__r.MailingStreet;
                        }
                        
                        if(result[0].Name != undefined) {
                            document.getElementById("WWONameEdit").value = result[0].Name;
                        }
                        if(result[0].BOATBUILDING__Customer_Boat_Status__c != undefined) {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WoCBS").value = result[0].BOATBUILDING__Customer_Boat_Status__c;
                        }
                        if(result[0].BOATBUILDING__Promo_Code__c != undefined) {
                            wwopromo = result[0].BOATBUILDING__Promo_Code__c;
                        }
                        
                        if(result[0].BOATBUILDING__Contact__r.MailingCity != undefined) {
                            document.getElementById("WWoCityId").value = result[0].BOATBUILDING__Contact__r.MailingCity; 
                        }
                        
                        if(result[0].BOATBUILDING__Contact__r.MailingPostalCode != undefined) {
                            document.getElementById("WWoZipId").value = result[0].BOATBUILDING__Contact__r.MailingPostalCode; 
                        } 
                        
                        if(result[0].BOATBUILDING__Contact__r.Phone != undefined) {
                            document.getElementById("WWoPhoneId").value = result[0].BOATBUILDING__Contact__r.Phone; 
                        }
                        
                        if(result[0].BOATBUILDING__Contact__r.Email != undefined) {
                            document.getElementById("WWoEmailId").value = result[0].BOATBUILDING__Contact__r.Email; 
                        }
                        if(result[0].BOATBUILDING__Discount__c != undefined) {
                            //document.getElementById("discountOnWO").value = result[0].BOATBUILDING__Discount__c;
                        }
                        
                        if(result[0].BOATBUILDING__Status__c != undefined) { 
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus").value = result[0].BOATBUILDING__Status__c;
                        }
                        if(result[0].BOATBUILDING__Store_Location__c != undefined) { 
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStoreLocation").value = result[0].BOATBUILDING__Store_Location__c;
                        }
                        if(result[0].BOATBUILDING__CreatedDate__c != undefined) {  
                            //**** Remaining ****//
                             
                            var dt = new Date(result[0].BOATBUILDING__Created_Date_Formula__c); 
                            var dte = dt.getDate() + "/" + (dt.getMonth() + 1) + "/" + dt.getFullYear(); 
                            var dtField = document.getElementById("WWoDateCrtedId");
                            dtField.setAttribute('type', 'text');
                            dtField.disabled = true;
                            dtField.value = dte; 
                        }
                        
                        if(result[0].BOATBUILDING__Boat__c != undefined) {
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid").value = result[0].BOATBUILDING__Boat__c;
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkold").value = result[0].BOATBUILDING__Boat__r.Name;
                            document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId").value = result[0].BOATBUILDING__Boat__r.Name;
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_HIN_No__c != undefined) {  
                                document.getElementById("WWoHinId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_HIN_No__c; 
                            }
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_SN__c != undefined) {  
                                document.getElementById("WWoEngSnId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_SN__c; 
                            }
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_1_Serial_Number__c != undefined) {
                                document.getElementById("WWoEngSnId1").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_1_Serial_Number__c;
                            }
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_2_Serial_Number__c != undefined) {
                                document.getElementById("WWoEngSnId2").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_2_Serial_Number__c;
                            }
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_3_Serial_Number__c != undefined) {
                                document.getElementById("WWoEngSnId3").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_3_Serial_Number__c;
                            }
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_4_Serial_Number__c != undefined) {
                                document.getElementById("WWoEngSnId4").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Engine_4_Serial_Number__c;
                            } 
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Trailer_VIN__c != undefined) {  
                                document.getElementById("WWoTvinId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Trailer_VIN__c; 
                            } 
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Registration_Number__c != undefined) {  
                                document.getElementById("WWoBRN").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Registration_Number__c; 
                            }
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Manufacturer__c != undefined) {   
                                document.getElementById("WWoMakeId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Manufacturer__r.Name; 
                            }
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Model__c != undefined) {  
                                document.getElementById("WWoModelId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__Boat_Model__c; 
                            } 
                            
                            if(result[0].BOATBUILDING__Boat__r.BOATBUILDING__M_Boat_Year__c != undefined) {  
                                document.getElementById("WWoYearId").value = result[0].BOATBUILDING__Boat__r.BOATBUILDING__M_Boat_Year__c; 
                            } 
                        }
                        
                        if(result[0].BOATBUILDING__Drive__c != undefined) {
                            document.getElementById("WwODriveId").value = result[0].BOATBUILDING__Drive__c; 
                        }
                        //if(result[0].BOATBUILDING__CreatedDate__c != undefined) {
                           // document.getElementById("pge:frm:wrkOrdrCompCall:wrkOrdr:CreatedDateId").value = result[0].BOATBUILDING__CreatedDate__c; 
                        //}
                        
                        if(result[0].BOATBUILDING__Hours__c != undefined) {
                            document.getElementById("WwOHoursId").value = result[0].BOATBUILDING__Hours__c; 
                        }
                        
                        //if(result[0].Status != undefined) { 
                           // document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus").value = result[0].Status; 
                        //}
                        
                        if(result[0].BOATBUILDING__Sales_Tax_Percent__c != undefined) {
                            //document.getElementById("WoSalesTax").value = result[0]. BOATBUILDING__Sales_Tax_Percent__c;  
                        }
                        fetchRelatedContactWWo();
//                         $(".chosenWWO").chosen({
// 				            no_results_text: "Oops, nothing found!" 
// 				        });
                        var lstResultJob = [];
                        if(result[1] != undefined) {
                            lstResultJob = result[1];
                            if(lstResultJob.length > 0) {
                                for(var i = 0; i < lstResultJob.length; i++) {
                                    
                                    Wwolstjob.push(lstResultJob[i]);
                                    WwoselectedPartNumber1 = lstResultJob[i].Id;
                                    //document.getElementById("Addjob").click();
                                    addJobFromEditableWWO();
                                    Wwolstjob = [];
                                }
                            }
                        }
                    } 
                }
            });
        
    }
    
    function removeFromExistingWWO(divId, JobId) {
       console.log(JobId); 
       var objCaseStatus = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus").value;
           if(objCaseStatus != "Closed" && objCaseStatus != "closed") {
                            
           var wwoId = document.getElementById("WWONameEdit").value;
        
           if(confirm('Are you sure to remove this job?')) {
               BOATBUILDING.WarrantyWorkOrderControllerClone.removeFromExistingWO(JobId, function(result, event) {
                   if(event.status) {
                       if(result != null) {
                           console.log(result);
                           if(result == "SUCCESS") {
                                if(wwoId != null) { 
                                    window.top.location = "/apex/BOATBUILDING__ServicePage?type=WWO&WWOId="+wwoId;          
                                }   
                           }
                       }
                   }
               });
           }
       }
    }
    
    
    function addJobFromEditableWWO() {
        var Wwosel = document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:sl1');
        if(!WWOexisting) {
            WwoselectedPartNumber1 = Wwosel.options[Wwosel.selectedIndex].value;
        }
        var WwoDivi = document.getElementById('WwoDivValue');
        var WwoDivnum = (document.getElementById("WwoDivValue").value -1)+ 2;
        WwoDivi.value = WwoDivnum;
        var WwotheValue = "WwotheValueDiv"+WwoDivnum;
        var WWoExistingjobId = "WWojobId"+WwoDivnum; 
        var Wwopartdiv='';
        //if(document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2_lkid').value != '000000000000000' &&  document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoconWrkId2').value != ''&& document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId_lkid').value != '000000000000000' && document.getElementById('pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WwoboatLookId').value != ''){
            if(WwoselectedPartNumber1 != ''){ 
                    //$("#Wwohiddenbtn").css("display","");
                    $("#WwoShowjobList").css("display", "");
                    var WwoAddPart = "WwoAddPartDiv"+WwoDivnum;
                    var Wwohiddentd = "WwohiddentdDiv"+WwoDivnum;
                    var WwoLabourQuantity = "WwoLabourQuantityDiv"+WwoDivnum;
                    var WwoLabourPrice = "WwoLabourPriceDiv"+WwoDivnum;
                    var WwoLabourTotalPrice = "WwoLabourTotalPriceDiv"+WwoDivnum;
                    var WwoWorkTypeSelect = "WwoWorkTypeSelect"+WwoDivnum;
                    var WwoTotalOfJobDiv = "WwoTotalOfJobDiv"+WwoDivnum;
                    var WWoJNId = "WwoExistingjobName"+WwoDivnum
                    var WWOCUSTComments = '', WWOMiscChargep = '0.00', WWOMiscCharge = '0.00', WWOClaimStatus = '',WWOComments= '',WWODiscount = 0.00, WWojobname = '',WWoworkrequested = '', WWoworktype = '',WWoLabourQuantity = '',WWoLabourPrice = 0.0, WWoLabourTotalPrice = 0.0, WwojobCustomerPay = 0.0 , WwojobTotal = 0.0 ,WWojobId = '' ;
                    var WWOClaimDate = '';
                    var WWOClaimAD = '';
                    var WWOClaimLAA = 0.00;
                    var rtrnPrtAmnt = 0.00;
                    var WWOClaimPaidDate = '';
                    var WWOClaimLPA = 0.00;
                    var prtPdAmnt = 0.00;
                    var TechId = '', TechName = '', BTN_lbl = 'Add Technician';
                    if(Wwolstjob.length > 0) {
                    	
                    	if(Wwolstjob[0].BOATBUILDING__Technician__c != undefined) {
	                        TechId = Wwolstjob[0].BOATBUILDING__Technician__c;
	                        TechName = Wwolstjob[0].BOATBUILDING__Technician__r.Name;
	                        BTN_lbl = 'Update Technician';
	                    } 
                     
                        if(Wwolstjob[0].Id != undefined) {
                            WWojobId = Wwolstjob[0].Id;
                        } 
                        if(Wwolstjob[0].BOATBUILDING__Job_Name__c != undefined) {
                            WWojobname = Wwolstjob[0].BOATBUILDING__Job_Name__c;
                        } 
                        if(Wwolstjob[0].BOATBUILDING__Work_Requested__c != undefined) {
                            WWoworkrequested = Wwolstjob[0].BOATBUILDING__Work_Requested__c;
                        } 
                        if(Wwolstjob[0].BOATBUILDING__Work_Type__c != undefined) {
                            WWoworktype = Wwolstjob[0].BOATBUILDING__Work_Type__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__No_of_Labors__c != undefined) {
                            WWoLabourQuantity = Wwolstjob[0].BOATBUILDING__No_of_Labors__c;
                        } 
                        if(Wwolstjob[0].BOATBUILDING__Price_per_Labor__c != undefined) {
                            WWoLabourPrice = Wwolstjob[0].BOATBUILDING__Price_per_Labor__c; 
                        }
                        if(Wwolstjob[0].BOATBUILDING__Total_Cost_Labor__c != undefined) {
                            WWoLabourTotalPrice = Wwolstjob[0].BOATBUILDING__Total_Cost_Labor__c;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Discount__c != undefined) {
                            WWODiscount = Wwolstjob[0].BOATBUILDING__Discount__c;
                        } 
                        
                        var totalPartPrice = 0.00;
                        if(Wwolstjob[0].BOATBUILDING__Total_Amount_on_Parts_del__c != undefined) {
                            totalPartPrice = Wwolstjob[0].BOATBUILDING__Total_Amount_on_Parts_del__c;
                        }
                            WwojobTotal = (WWoLabourTotalPrice + totalPartPrice).toFixed(2);
                        
                        if(Wwolstjob[0].BOATBUILDING__Customer_Pay__c != undefined) {
                            WwojobCustomerPay = Wwolstjob[0].BOATBUILDING__Customer_Pay__Wwochange_LabourValuesc;
                        }
                        if(Wwolstjob[0].BOATBUILDING__Comments__c != undefined) { 
                            WWOComments = Wwolstjob[0].BOATBUILDING__Comments__c;
                        }
                         if(Wwolstjob[0].BOATBUILDING__Customer_Comments__c != undefined) {
	                        WWOCUSTComments = Wwolstjob[0].BOATBUILDING__Customer_Comments__c;
	                        console.log(Wwolstjob[0].BOATBUILDING__Customer_Comments__c);
	                    }  
                        if(Wwolstjob[0].BOATBUILDING__Claim_Status_New__c != undefined) { 
                            WWOClaimStatus = Wwolstjob[0].BOATBUILDING__Claim_Status_New__c;
                        }
                         
                        if(Wwolstjob[0].BOATBUILDING__Claim_Date__c != undefined) { 
                            var dt = new Date(Wwolstjob[0].BOATBUILDING__Claim_Date__c);
                            WWOClaimDate = dt.toISOString().substr(0, 10);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Claim_Approval_Date__c != undefined) { 
                            var dt = new Date(Wwolstjob[0].BOATBUILDING__Claim_Approval_Date__c);
                            WWOClaimAD = dt.toISOString().substr(0, 10);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Claim_Labor_Approved_Amount__c != undefined) { 
                            WWOClaimLAA = parseFloat(Wwolstjob[0].BOATBUILDING__Claim_Labor_Approved_Amount__c);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Return_Parts_Amount__c != undefined) { 
                            rtrnPrtAmnt = parseFloat(Wwolstjob[0].BOATBUILDING__Return_Parts_Amount__c);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Claim_Paid_Date__c != undefined) { 
                            var dt = new Date(Wwolstjob[0].BOATBUILDING__Claim_Paid_Date__c);
                            WWOClaimPaidDate = dt.toISOString().substr(0, 10);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Claim_Labor_Paid_Amount__c != undefined) { 
                            WWOClaimLPA = parseFloat(Wwolstjob[0].BOATBUILDING__Claim_Labor_Paid_Amount__c);
                        }
                        
                        if(Wwolstjob[0].BOATBUILDING__Parts_Paid_Amount__c != undefined) { 
                            prtPdAmnt = parseFloat(Wwolstjob[0].BOATBUILDING__Parts_Paid_Amount__c);
                        }
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge__c != undefined) { 
                            WWOMiscCharge = Wwolstjob[0].BOATBUILDING__Misc_Charge__c;
                        }
                        
                        //var misccc = 0.00
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge__c != undefined) {
                            WWOMiscCharge = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge__c);
                        }
                        var misccc2 = 0.00
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge_2__c != undefined) {
                            misccc2 = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge_2__c);
                        }
                        var misccc3 = 0.00
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge_3__c != undefined) {
                            misccc3 = parseFloat(Wwolstjob[0].BOATBUILDING__Misc_Charge_3__c);
                        }
                        var miscccd = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_1__c != undefined) {
                            miscccd = Wwolstjob[0].BOATBUILDING__Misc_Description_1__c;
                        } 
                        var miscccd2 = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_2__c != undefined) {
                            miscccd2 = Wwolstjob[0].BOATBUILDING__Misc_Description_2__c;
                        }
                        var miscccd3 = '';
                        if(Wwolstjob[0].BOATBUILDING__Misc_Description_3__c != undefined) {
                            miscccd3 = Wwolstjob[0].BOATBUILDING__Misc_Description_3__c;
                        }
                        // + parseFloat(WoShippingCharge)
                        var totalMisc = WWOMiscCharge + misccc2 + misccc3;
                        
                        
                        if(Wwolstjob[0].BOATBUILDING__Misc_Charge_Paid__c != undefined) { 
                            WWOMiscChargep = Wwolstjob[0].BOATBUILDING__Misc_Charge_Paid__c;
                        }
                        
                    }
                     			
                    var Wwonewdiv ="<div class='slds-card' style='background-color: #ffffff;' id='Wwoaaoo"+WwoDivnum+"'><div style='color: red; position: absolute; margin: 3px;' id='Wwoerror-panel"+WwoDivnum+"'><ul id='Wwoerror-div"+WwoDivnum+"'></ul></div><div style='float:right;line-height:0;'><a id='rmvwwo"+WwoDivnum+"' style='text-decoration:none;' onclick='removeFromExistingWWO(\"Wwoaaoo"+WwoDivnum+"\",\""+WWojobId+"\")'><i class='fa fa-times fa-lg'  style='margin-top: 4px; margin-right: 4px;' aria-hidden='true'></i></a></div><div class='slds-grid slds-wrap slds-m-top--medium'><table><tr><td><table class='slds-table slds-table--bordered' style='border-right: 1px solid #d8dde6;'><thead><tr><th>Job</th><th>Work Requested</th><th >Type</th><th >Quantity</th><th class='slds-text-align--right'>Price</th><th class='slds-text-align--right'>Total</th><th class='slds-text-align--right'></th></tr></thead><tbody><tr><td colspan='4'><input class = 'slds-input' id="+WWoExistingjobId+" type='hidden' value='"+WWojobId+"'></input><input class = 'slds-input' id="+WWoJNId+" type='text' value='"+WWojobname+"'></input></td><td><select id="+WwoWorkTypeSelect+" onchange='Wwochange_LabourValues("+WwoDivnum+"); Wwocalculate_totalofallJobDiv();' class='slds-select'><option value='0' selected='selected'>--None--</option></select></td><td  class='slds-text-align--right' colspan='2'><a id='wwoaddPWOJ"+WwoDivnum+"' onclick='addPartForEditableWWO("+WwoDivnum+", \""+WwoselectedPartNumber1+"\");' class='slds-button slds-button--brand'>Add Part</a></td></tr><tr><td colspan='7'><div id=Wwoexistingjobdiv"+WwoDivnum+"><input type='hidden' name='WwotheValue' id='"+WwotheValue+"' value='0' /></div></td></tr><tr><td>&nbsp;</td><td data-label='Labor'>Labor</td><td>&nbsp;</td><td data-label='Quantity'><input id='"+WwoLabourQuantity+"' onkeypress='return isNumberKey(event)' class='slds-input' type='text' onkeyup='Wwocalculate_LabourPrice_Div("+WwoDivnum+"); Wwocalculate_totalofallJobDiv();' value='"+WWoLabourQuantity+"'/></td><td data-label='Price' class='slds-text-align--right'><i class='fa fa-usd' aria-hidden='true'></i><input id='"+WwoLabourPrice+"'  class='slds-input' type='text' disabled='disabled' value="+WWoLabourPrice+"></td><td data-label='Total' class='slds-text-align--right'><i class='fa fa-usd' aria-hidden='true'></i><span id='WwoLabourTotalPriceDiv"+WwoDivnum+"'>"+WWoLabourTotalPrice+"</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td data-label='Prospecting' class='slds-text-align--right'>Total:<td class='slds-text-align--right' ><i class='fa fa-usd' aria-hidden='true'></i><span id='WwoTotalOfJobDiv"+WwoDivnum+"'>"+WwojobTotal+"</span></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Discount ($)</td><td class='slds-text-align--right'><input onkeypress='return isNumberKey(event)' class='slds-input' value='"+WWODiscount+"' onKeyUp='calDiscountedTotalAmtWwo("+WwoDivnum+");' name='Discount' id='WwodiscountOnJob"+WwoDivnum+"'/></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>Misc Description 1</td><td colspan='2'><input type='text' value='"+miscccd+"' class='slds-input' id='miscDescwwo1"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 1 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' value='"+WWOMiscCharge+"' class='slds-input' name='Misc Charge' id='miscChargewwo1"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 2</td><td colspan='2'><input value='"+miscccd2+"' type='text' class='slds-input'  id='miscDescwwo2"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 2 ($)</td><td class='slds-text-align--right'><input value='"+misccc2+"'  onkeypress='return isNumberKey(event)' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo2"+WwoDivnum+"'/></td><td>&nbsp;</td></tr> <tr><td>&nbsp;</td><td>Misc Description 3</td><td colspan='2'><input value='"+miscccd3+"' type='text' class='slds-input' id='miscDescwwo3"+WwoDivnum+"'/></td><td class='slds-text-align--right'>Misc Charge 3 ($)</td><td class='slds-text-align--right'><input  onkeypress='return isNumberKey(event)' value='"+misccc3+"' onKeyUp='calculatetotalMiscwwo("+WwoDivnum+");' class='slds-input' name='Misc Charge' id='miscChargewwo3"+WwoDivnum+"'/></td><td>&nbsp;</td></tr>   <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Misc Charge ($)</td><td class='slds-text-align--right'><input class='slds-input' onchange='calDiscountedTotalAmtWwo("+WwoDivnum+");' disabled='disabled' name='Misc Charge' id='wwoMicsChrg"+WwoDivnum+"' value='"+totalMisc+"'/></td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td class='slds-text-align--right'>Total Amount</td><td class='slds-text-align--right' id='gTotalAmtWwo"+WwoDivnum+"'><i aria-hidden='true' class='fa fa-usd'></i>0.00</td><td>&nbsp;</td></tr></tbody></table><div style='margin:1%;'>Comments:&nbsp;<input id='WWOComments"+WwoDivnum+"' value='"+WWOComments+"' type='hidden'/><span style='position: relative; left:24.5%;'><a onclick='wwoaddCommentToJob(\""+WwoDivnum+"\", \"SER\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCommentFromJob(\""+WwoDivnum+"\", \"SER\");'>View</a></span> </div><div style='margin:1%;'>Customer Comments:&nbsp;<input id='WWOCUSTComments"+WwoDivnum+"' value='"+WWOCUSTComments+"' type='hidden'/><span style='position: relative; left:15%;'><a onclick='wwoaddCustCommentToJob(\""+WwoDivnum+"\", \"CUST\");'>Add</a>&nbsp;|&nbsp;<a onclick='wwoviewCustCommentFromJob(\""+WwoDivnum+"\", \"CUST\");'>View</a></span> </div> <div style='margin: 1%;'> <span>Technician:&nbsp;<input type='hidden' id='wwojbTechId"+WwoDivnum+"' value='"+TechId+"'/><span id='wwotechName"+WwoDivnum+"'>"+TechName+"</span>&nbsp;<a onclick='wwoaddTechnician(\""+WwoDivnum+"\")' style='position: absolute; left:19.5%;'> "+BTN_lbl+" </a></span> </div></td><td style='vertical-align: top;'><table cellspacing='5' style='margin: 5px;'><tr><td colspan='2' style='text-align: center;'><input type='hidden' id='paymentStatus"+WwoDivnum+"' value='0'/><a class='slds-button slds-button--neutral slds-button--brand inside_row_button' id='addPayment"+WwoDivnum+"' onclick='addPaymentonWWOJ(\""+WwoDivnum+"\",\"0\");'>Add Paymet</a></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Status:</td><td><select id='wwoClmStts"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-select'><option value=''>--None--</option></select></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Date:</td><td><input id='wwoClmDt"+WwoDivnum+"' value='"+WWOClaimDate+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Approval Date:</td><td><input id='wwoClmApprvl"+WwoDivnum+"' value='"+WWOClaimAD+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Approved Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input value='"+WWOClaimLAA+"' id='wwoClmlbrAppAmo"+WwoDivnum+"' onkeypress='return isNumberKey(event)' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Return Parts Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input value='"+rtrnPrtAmnt+"' onkeypress='return isNumberKey(event)' id='wwoRtrnPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Paid Date:</td><td><input  value='"+WWOClaimPaidDate+"' id='wwoClmPdDate"+WwoDivnum+"' style='width: 140px;' type='date'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Claim Labor Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' value='"+WWOClaimLPA+"' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")'  id='wwoClmLbrPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Parts Paid Amount:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' value='"+prtPdAmnt+"' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoPrtPdAmt"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Misc Charge Paid ($)</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' onkeypress='return isNumberKey(event)' onkeyUp='calculateWarrantySection(\""+WwoDivnum+"\")' id='wwoMicsChrgp"+WwoDivnum+"' style='width: 140px;' type='text' value='"+WWOMiscChargep+"'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Total Paid:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' id='wwoTtlPd"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr><tr><td style='padding: 3px;width: 200px;'>Balance Due:</td><td><i aria-hidden='true' class='fa fa-usd' style='position: absolute;margin-top: .89%;margin-left: .40%;'></i><input disabled='disabled' id='wwoBlncDue"+WwoDivnum+"' style='width: 140px;' type='text'  class='slds-input'/></td></tr></table></td></tr></table></div></div>";   
                    
                    if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r != undefined) {
                        var totalOfAllWwo = 0.00; 
                        for(var i=0; i<Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r.length; i++){ 
                            var WWOPID= '', WWoPartnumber = '', WWoPartFullName = '', WWoPartQuantity = '',WWoPartname = '',WWoPartPrice = 0.0,WWoPartTotalPrice = 0.0; 
                            WWOPID = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].Id; 
                            if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Number__c != undefined){
                                WWoPartnumber = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Number__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Name__c != undefined){
                                //WWoPartname = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Name__c;
                                WWoPartFullName = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Name__c;
                                if(WWoPartFullName.length > 5) {
                                        WWoPartname = WWoPartFullName.substr(0, 5) + '...';
                                } else {
                                        WWoPartname = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Part_Name__c;
                                }
                            }
                            if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Quantity__c != undefined ){
                                WWoPartQuantity = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Quantity__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Price__c != undefined ){
                                WWoPartPrice = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Price__c;
                            }
                            if(Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Total__c != undefined ){
                                WWoPartTotalPrice = Wwolstjob[0].BOATBUILDING__Work_Order_Job_Line_Items__r[i].BOATBUILDING__Total__c;
                                totalOfAllWwo += parseFloat(WWoPartTotalPrice);
                            }
                            objDivTotalPartAmtWwo["WwoDivnum"+WwoDivnum] = totalOfAllWwo;
                            var prtIndexWWO = i+1;
                            //Wwopartdiv += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+WWoPartnumber+'</td><td width="65">'+WWoPartname+'</td><td width="106">&nbsp;</td><td data-label="Quanity" width="144">'+WWoPartQuantity+'</td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartPrice+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartTotalPrice+'</td></tr></table>';                            
                            Wwopartdiv += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+WWoPartnumber+'</td><td width="100"><span style=" display: none; position: absolute; top: -38%; left: -4%; border: 1px solid #a8b8c7; padding: 5px; border-radius: 1rem; background: #e1e6ee; z-index:999;" id="hiddnPrtNamewwo'+WwoDivnum+''+prtIndexWWO+'">'+WWoPartFullName+'</span><a onmouseover="viewFullNameWWO(\''+WwoDivnum+'\',\''+prtIndexWWO+'\');" onmouseout="hideFullNameWWO(\''+WwoDivnum+'\',\''+prtIndexWWO+'\');">'+WWoPartname+'</a></td><td width="106">&nbsp;</td><td data-label="Quantity" width="144"><input onkeyPress="return isNumber(event);" onKeyUp="wwochangeQuanityFromEditableMode(this, \''+WWOPID+'\', \''+WwoDivnum+'\');"  type="text" value="'+WWoPartQuantity+'" class="slds-input"/></td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartPrice+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+WWoPartTotalPrice+'</td><td style="text-align: right;"><a onclick="wworemovePart(this, \''+WWOPID+'\', \''+WwoDivnum+'\');">Remove</a></td></tr></table>';
                        }
                        
                    }
                    
                    var id = "#WwoWorkTypeSelect"+WwoDivnum;
                    $("#WwoAddDivForJob").append(Wwonewdiv);
                    Wwobind_WorkType(id,WWoworktype);
                    var Wwofd = document.getElementById("Wwoexistingjobdiv"+WwoDivnum);
                    $(Wwofd).append(Wwopartdiv);
                    if(Wwolstjob[0].BOATBUILDING__Job_Line_Items__r != undefined){
                        document.getElementById('WwotheValueDiv'+WwoDivnum).value = Wwolstjob[0].BOATBUILDING__Job_Line_Items__r.length;
                    }
                    Wwoalllstjob = Wwoalllstjob.concat(Wwolstjob);
                    calDiscountedTotalAmtWwo(WwoDivnum);
                    Wwocalculate_totalofallJobDiv();
                    addClaimStatus(WwoDivnum, WWOClaimStatus);  
                    var objCaseStatus = document.getElementById("pge:frm:wrntyWrkOrdrCompCall:wrkOrdr:WWoStatus").value;
                    if(objCaseStatus == "Closed" || objCaseStatus == "closed") {
                            //$("#rmvwwo"+WwoDivnum).hide();
                            $("#wwoaddPWOJ"+WwoDivnum).hide();
                            
                    }      
            }
            else{
                document.getElementById("wwoerrSnap").innerHTML = "Please Select Existing Job";
                $("#wwoerrorDiv").slideDown();
                $("#wwoerrorDiv").delay(8000).slideUp();
                return false;
            }
//         }
//         else{
//                 document.getElementById("wwoerrSnap").innerHTML = "Please Select Customer And Boat";
//                 $("#wwoerrorDiv").slideDown();
//                 $("#wwoerrorDiv").delay(8000).slideUp();
//                 return false; 
//             }
    }
    
    
    
    function calculatetotalMiscwwo(divNum) {
            var misc1 = 0.00; 
            var misc2 = 0.00;
            var misc3 = 0.00;
        
        if($("#miscChargewwo1"+divNum).val().replace(/\s/g,'') != "" ) {
            misc1 = parseFloat($("#miscChargewwo1"+divNum).val());
        }
        
        if($("#miscChargewwo2"+divNum).val().replace(/\s/g,'') != "" ) {
            misc2 = parseFloat($("#miscChargewwo2"+divNum).val());
        }
            
        if($("#miscChargewwo3"+divNum).val().replace(/\s/g,'') != "" ) {
            misc3 = parseFloat($("#miscChargewwo3"+divNum).val());
        }       
            var totalMisc = misc1 + misc2 + misc3;
            console.log(misc1 + misc2 + misc3);
            $("#wwoMicsChrg"+divNum).val(totalMisc.toFixed(2));
            //console.log('>>calculatetotalMisc'+divNum);
            calDiscountedTotalAmtWwo(divNum); 
    }
    
    
    function viewFullNameWWO(dn,pn) {
            $("#hiddnPrtNamewwo"+dn+""+pn).fadeIn();
    }
    
    function hideFullNameWWO(dn,pn) {
            $("#hiddnPrtNamewwo"+dn+""+pn).fadeOut();
    }
    
    
    
    function addPartForEditableWWO(divNum, jobId) { 
        WWOaddJobDiv = divNum;
        $("#WWOPymntModl").fadeIn(); 
        WWOjobIdForCart = jobId;
        WWOjobIndex = divNum; 
    }
    
    /*window.onclick = function(event) {
       if (event.target == document.getElementById('WWOPymntModl')) {
            WWOhideAll();
        } 
    } */
    
    $("#WWOcloseSign33").click(function() {
        WWOhideAll();
    });
    
    $("#WWOcloseSign33newjob").click(function() {
        WWOhideAllnewjob();
    });
      
    function WWOhideAll() {
        console.log("hide"); 
        $('#WWOPymntModl').fadeOut();
        $("#WWOselectedPrntDiv").hide();
        $("#WWOpartResultDiv").hide(); 
        document.getElementById("WWOprtDetailInput").value = "";
        wwolstSelectedPartNumber = [];
        wwomapForQuantity = new Object();
    }
    function WWOhideAllnewjob() {
        console.log("hide"); 
        $('#WWOPymntModlnewjob').fadeOut();
        $("#WWOselectedPrntDivnewjob").hide();
        $("#WWOpartResultDivnewjob").hide(); 
        document.getElementById("WWOprtDetailInputnewjob").value = "";
        wwolstSelectedPartNumber = [];
        wwomapForQuantity = new Object();
    }
    
    $("#WWOprtSrchBtn").click(function() {
        $("#WWOspinner").show();
        var prtDetail = $("#WWOprtDetailInput").val(); 
        if(prtDetail != "") { 
            BOATBUILDING.WarrantyWorkOrderControllerClone.searchParts(prtDetail, function(result, event) {
                if(event.status) {
                    if(result != null) {
                        wwolstParts = result;
                        $("#WWOpartResultDiv").fadeIn();
                        var tableHTML = "<table class='slds-table' style='border-collapse: collapse;'><thead><tr><th>&nbsp;</th><th>Part Number</th><th>Part Name</th><th>Quanity</th><th>Cost</th><th>Total Amount</th></tr></thead><tbody>";
                        if(wwolstParts.length > 0) {
                            for(var i = 0; i < wwolstParts.length; i++) {
                                var total = parseFloat(wwolstParts[i].Quantity) * parseFloat(wwolstParts[i].MSRP);
                                if (wwolstParts[i].PartNumber in wwomapForQuantity ) {
                                    tableHTML +="<tr><td><input id='select"+i+"' checked='checked' onchange='wwoaddToCart(\""+i+"\");' type='checkbox' /></td><td id='partNumber"+i+"'>"+wwolstParts[i].PartNumber+"</td><td>"+wwolstParts[i].PartName+"</td><td><input type='text' id='partQuantity"+i+"' value='"+wwomapForQuantity[wwolstParts[i].PartNumber]+"' onkeyPress='return isNumber(event);' onKeyUp='wwoquantityChange(\""+i+"\");' class='slds-input'/></td><td>$<span id='partMSRP"+i+"'>"+wwolstParts[i].MSRP+"</span></td><td>$<span id='partTotal"+i+"'>"+total+"</span></td></tr>"
                                } 
                                else {
                                    tableHTML +="<tr><td><input id='select"+i+"' onchange='wwoaddToCart(\""+i+"\");' type='checkbox' /></td><td id='partNumber"+i+"'>"+wwolstParts[i].PartNumber+"</td><td>"+wwolstParts[i].PartName+"</td><td><input type='text' id='partQuantity"+i+"' value='"+wwolstParts[i].Quantity+"' onkeyPress='return isNumber(event);' onKeyUp='wwoquantityChange(\""+i+"\");' class='slds-input'/></td><td>$<span id='partMSRP"+i+"'>"+wwolstParts[i].MSRP+"</span></td><td>$<span id='partTotal"+i+"'>"+total+"</span></td></tr>"
                                }
                            }
                            tableHTML += "</tbody></table>";
                        }
                        document.getElementById("WWOrsltLstDiv").innerHTML = tableHTML;
                        $("#WWOspinner").hide();
                    }else {
                        $("#WWOpartResultDiv").fadeIn();
                        document.getElementById("WWOrsltLstDiv").innerHTML = "<span style='color: red;'>No Record Found.</span>";
                        $("#WWOspinner").hide();
                    }
                }
            });
        } 
        else { 
            $("#WWOpartResultDiv").fadeIn();
            document.getElementById("WWOrsltLstDiv").innerHTML = "<span style='color: red;'>Please enter Part Number/Part Name.</span>";
            $("#WWOspinner").hide();
        }
    });


    $("#WWOprtSrchBtnnewjob").click(function() {
        $("#WWOspinnernewjob").show();
        var prtDetail = $("#WWOprtDetailInputnewjob").val(); 
        if(prtDetail != "") { 
            BOATBUILDING.WarrantyWorkOrderControllerClone.searchParts(prtDetail, function(result, event) {
                if(event.status) {
                    if(result != null) {
                        wwolstParts = result;
                        $("#WWOpartResultDivnewjob").fadeIn();
                        var tableHTML = "<table class='slds-table' style='border-collapse: collapse;'><thead><tr><th>&nbsp;</th><th>Part Number</th><th>Part Name</th><th>Quanity</th><th>Retail Price</th><th>Total Amount</th></tr></thead><tbody>";
                        if(wwolstParts.length > 0) {
                            for(var i = 0; i < wwolstParts.length; i++) {
                                var total = parseFloat(wwolstParts[i].Quantity) * parseFloat(wwolstParts[i].MSRP);
                                if (wwolstParts[i].PartNumber in wwomapForQuantity ) {
                                    tableHTML +="<tr><td><input id='selectnewjob"+i+"' checked='checked' onchange='wwoaddToCartnewjob(\""+i+"\");' type='checkbox' /></td><td id='partNumbernewjob"+i+"'>"+wwolstParts[i].PartNumber+"</td><td>"+wwolstParts[i].PartName+"</td><td><input type='text' id='partQuantitynewjob"+i+"' value='"+wwomapForQuantity[wwolstParts[i].PartNumber]+"' onkeyPress='return isNumber(event);' onKeyUp='wwoquantityChangenewjob(\""+i+"\");' class='slds-input'/></td><td>$<span id='partMSRPnewjob"+i+"'>"+wwolstParts[i].MSRP+"</span></td><td>$<span id='partTotalnewjob"+i+"'>"+total+"</span></td></tr>"
                                } 
                                else {
                                    tableHTML +="<tr><td><input id='selectnewjob"+i+"' onchange='wwoaddToCartnewjob(\""+i+"\");' type='checkbox' /></td><td id='partNumbernewjob"+i+"'>"+wwolstParts[i].PartNumber+"</td><td>"+wwolstParts[i].PartName+"</td><td><input type='text' id='partQuantitynewjob"+i+"' value='"+wwolstParts[i].Quantity+"' onkeyPress='return isNumber(event);' onKeyUp='wwoquantityChangenewjob(\""+i+"\");' class='slds-input'/></td><td>$<span id='partMSRPnewjob"+i+"'>"+wwolstParts[i].MSRP+"</span></td><td>$<span id='partTotalnewjob"+i+"'>"+total+"</span></td></tr>"
                                }
                            }
                            tableHTML += "</tbody></table>";
                        }
                        document.getElementById("WWOrsltLstDivnewjob").innerHTML = tableHTML;
                        $("#WWOspinnernewjob").hide();
                    }else {
                        $("#WWOpartResultDivnewjob").fadeIn();
                        document.getElementById("WWOrsltLstDivnewjob").innerHTML = "<span style='color: red;'>No Record Found.</span>";
                        $("#WWOspinnernewjob").hide();
                    }
                }
            });
        } 
        else { 
            $("#WWOpartResultDivnewjob").fadeIn();
            document.getElementById("WWOrsltLstDivnewjob").innerHTML = "<span style='color: red;'>Please enter Part Number/Part Name.</span>";
            $("#WWOspinnernewjob").hide();
        }
    });

    
    function wwoquantityChange(index) {
        wwoupdateDiscountQuantityMaps(index);
    }
    function wwoquantityChangenewjob(index) {
        wwoupdateDiscountQuantityMapsnewjob(index);
    }
    function wwoupdateDiscountQuantityMaps(index) {
        var partNumber = document.getElementById("partNumber"+index).innerHTML;
        var partQuantity = $("#partQuantity"+index).val();
        var partMSRP = document.getElementById("partMSRP"+index).innerHTML;
        if(partQuantity != '') {
            partQuantityTmp = parseFloat(partQuantity);
        } 
        var total = partQuantityTmp * partMSRP;
        
        document.getElementById("partTotal"+index).innerHTML = total;
        if (partNumber in wwomapForQuantity ) {
            wwomapForQuantity[partNumber] = partQuantity;
        }
    }

    function wwoupdateDiscountQuantityMapsnewjob(index) {
        var partNumber = document.getElementById("partNumbernewjob"+index).innerHTML;
        var partQuantity = $("#partQuantitynewjob"+index).val();
        var partMSRP = document.getElementById("partMSRPnewjob"+index).innerHTML;
        if(partQuantity != '') {
            partQuantityTmp = parseFloat(partQuantity);
        } 
        var total = partQuantityTmp * partMSRP;
        
        document.getElementById("partTotalnewjob"+index).innerHTML = total;
        if (partNumber in wwomapForQuantity ) {
            wwomapForQuantity[partNumber] = partQuantity;
        }
    } 
    
    function wwoaddToCart(index) {
        var partNumber = document.getElementById("partNumber"+index).innerHTML;
        var partQuantity = $("#partQuantity"+index).val();
        var partMSRP = document.getElementById("partMSRP"+index).innerHTML;
        
        if(document.getElementById("select"+index).checked == true) {
            if(partQuantity != '') {
                if(parseFloat(partQuantity) > 0) {
                    wwomapForQuantity[partNumber] = partQuantity;
                    wwolstSelectedPartNumber.push(partNumber);
                    if(wwolstSelectedPartNumber.length > 0) {
                        var strParts = '['
                        for(var i = 0; i < wwolstSelectedPartNumber.length; i++) {
                            if(i == 0) {
                                strParts += "<a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                            }
                            else {
                                strParts += ", <a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                            }
                        }
                        strParts += "]";
                        $("#WWOselectedPrntDiv").fadeIn();
                        document.getElementById("WWOselectedPrtDiv").innerHTML = strParts; 
                            
                    }
                }
                else {
                    document.getElementById("select"+index).checked = false;
                    alert("Quantity should be greater than 0.");
                }
            }else {
                document.getElementById("select"+index).checked = false;
                alert("Quantity should be greater than 0.");
            }
        }
        else {
            if(lstSelectedPartNumber.length > 0) {
                var index = wwolstSelectedPartNumber.indexOf(partNumber);
                if(index > -1) {
                    wwolstSelectedPartNumber.splice(index, 1);
                }
                if(wwolstSelectedPartNumber.length > 0) {
                    var strParts = '['
                    for(var i = 0; i < wwolstSelectedPartNumber.length; i++) {
                        if(i == 0) {
                            strParts += "<a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                        }
                        else {
                            strParts += ", <a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                        }
                    }
                    strParts += "]";
                    $("#WWOselectedPrntDiv").fadeIn();
                    document.getElementById("WWOselectedPrtDiv").innerHTML = strParts;     
                }
                else {
                    $("#WWOselectedPrntDiv").fadeOut();
                }
            }
            
            delete wwomapForQuantity[partNumber];
        }
    }



    function wwoaddToCartnewjob(index) {
        var partNumber = document.getElementById("partNumbernewjob"+index).innerHTML;
        var partQuantity = $("#partQuantitynewjob"+index).val();
        var partMSRP = document.getElementById("partMSRPnewjob"+index).innerHTML;
        
        if(document.getElementById("selectnewjob"+index).checked == true) {
            if(partQuantity != '') {
                if(parseFloat(partQuantity) > 0) {
                    wwomapForQuantity[partNumber] = partQuantity;
                    wwolstSelectedPartNumber.push(partNumber);
                    if(wwolstSelectedPartNumber.length > 0) {
                        var strParts = '['
                        for(var i = 0; i < wwolstSelectedPartNumber.length; i++) {
                            if(i == 0) {
                                strParts += "<a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                            }
                            else {
                                strParts += ", <a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                            }
                        }
                        strParts += "]";
                        $("#WWOselectedPrntDivnewjob").fadeIn();
                        document.getElementById("WWOselectedPrtDivnewjob").innerHTML = strParts; 
                            
                    }
                }
                else {
                    document.getElementById("selectnewjob"+index).checked = false;
                    alert("Quantity should be greater than 0.");
                }
            }else {
                document.getElementById("selectnewjob"+index).checked = false;
                alert("Quantity should be greater than 0.");
            }
        }
        else {
            if(lstSelectedPartNumber.length > 0) {
                var index = wwolstSelectedPartNumber.indexOf(partNumber);
                if(index > -1) {
                    wwolstSelectedPartNumber.splice(index, 1);
                }
                if(wwolstSelectedPartNumber.length > 0) {
                    var strParts = '['
                    for(var i = 0; i < wwolstSelectedPartNumber.length; i++) {
                        if(i == 0) {
                            strParts += "<a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                        }
                        else {
                            strParts += ", <a style='font-style: italic;'>"+wwolstSelectedPartNumber[i]+"</a>";
                        }
                    }
                    strParts += "]";
                    $("#WWOselectedPrntDivnewjob").fadeIn();
                    document.getElementById("WWOselectedPrtDivnewjob").innerHTML = strParts;     
                }
                else {
                    $("#WWOselectedPrntDivnewjob").fadeOut();
                }
            }
            
            delete wwomapForQuantity[partNumber];
        }
    }

    
    
    var wwolstFinalList = [];
    var wwoobjMapForResutData = new Object();
    var wwomapForQuantityTmp = new Object();
    $("#WWOaddToCrt").click(function() {
        console.log("Add Part"); 
        $("#spinner").show();
        if(WWOaddJobDiv != 0) {
            for(key in wwomapForQuantity) {
                wwomapForQuantityTmp[key] = wwomapForQuantity[key];
            } 
            var lstResult = [];
            if(wwolstSelectedPartNumber.length > 0) {
                BOATBUILDING.WarrantyWorkOrderControllerClone.getFinalList(wwolstSelectedPartNumber, wwomapForQuantityTmp, WWOjobIdForCart, function(result, event) {
                    if(event.status) {
                        console.log(result);
                        //hideAll(); 
                        
                        if(result != null) { 
                            lstResult = result;
                            if(lstResult.length > 0) {
                                for(var i = 0; i < lstResult.length; i++) { 
                                    if(lstResult[i].PartNumber in wwomapForQuantityTmp ) {
                                        if(!(lstResult[i].PartNumber in wwoobjMapForResutData)) {
                                            wwolstFinalList.push(lstResult[i]);
                                            wwoobjMapForResutData[lstResult[i].PartNumber] = lstResult[i];
                                        }
                                    }
                                } 
                            }
                            if(wwolstFinalList.length > 0) {
                                var grandTotalBal = 0.00;
                                var tableHTML = '';
                                for(var i = 0; i < wwolstFinalList.length; i++) {
                                    if(wwolstFinalList[i].PartNumber in wwomapForQuantityTmp) {
                                        var total = parseFloat(wwomapForQuantityTmp[wwolstFinalList[i].PartNumber]) * parseFloat(wwolstFinalList[i].MSRP);
                                        grandTotalBal += total; 
                                        
                                        
                                        var WWoPartFullName = '', WWoPartname = '';
                                        if(wwolstFinalList[i].PartName != undefined){
                                            WWoPartFullName = wwolstFinalList[i].PartName;
                                            if(WWoPartFullName.length > 5) {
                                                    WWoPartname = WWoPartFullName.substr(0, 5) + '...'; 
                                            } else { 
                                                    WWoPartname = result[i].PartName;
                                            } 
                                        }
                                        
                                        var prtIndexWWO = (i+WWOaddJobDiv)+"final";
                                        
                                        tableHTML += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+wwolstFinalList[i].PartNumber+'</td><td width="100"><span style=" display: none; position: absolute; top: -38%; left: -4%; border: 1px solid #a8b8c7; padding: 5px; border-radius: 1rem; background: #e1e6ee; z-index:999;" id="hiddnPrtNamewwo'+WWOaddJobDiv+''+prtIndexWWO+'">'+WWoPartFullName+'</span><a onmouseover="viewFullNameWWO(\''+WWOaddJobDiv+'\',\''+prtIndexWWO+'\');" onmouseout="hideFullNameWWO(\''+WWOaddJobDiv+'\',\''+prtIndexWWO+'\');">'+WWoPartname+'</a></td><td width="106">&nbsp;</td><td data-label="Quantity" width="144"><input onkeyPress="return isNumber(event);" onKeyUp="wwochangeQuanityFromEditableMode(this, \''+wwolstFinalList[i].Id+'\', \''+WWOaddJobDiv+'\');"  type="text" value="'+wwomapForQuantityTmp[wwolstFinalList[i].PartNumber]+'" class="slds-input"/></td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(wwolstFinalList[i].MSRP).toFixed(2)+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(total).toFixed(2)+'</td><td style="text-align: right;"><a onclick="wworemovePart(this, \''+wwolstFinalList[i].Id+'\', \''+WWOaddJobDiv+'\');">Remove</a></td></tr></table>'; 
                                    } 
                                }  
                                
                                $("#Wwoexistingjobdiv"+WWOaddJobDiv).append(tableHTML);
                                var jT = grandTotalBal + parseFloat(document.getElementById("WwoLabourTotalPriceDiv"+WWOaddJobDiv).innerHTML) + parseFloat(document.getElementById("WwoTotalOfJobDiv"+WWOaddJobDiv).innerHTML);
                                
                                var disJob = 0.00;
                                if($("#WwodiscountOnJob"+WWOaddJobDiv).val() != "") {
                                    disJob = parseFloat($("#WwodiscountOnJob"+WWOaddJobDiv).val());
                                }
                                
                                document.getElementById("WwoTotalOfJobDiv"+WWOaddJobDiv).innerHTML = jT;
                                document.getElementById("gTotalAmtWwo"+WWOaddJobDiv).innerHTML = jT - disJob;
                                
                                var grandTotalBal2 = parseFloat($("#Wwograndtotal_parts").val()) + parseFloat(grandTotalBal);
                                console.log(grandTotalBal2); 
                                document.getElementById("Wwograndtotal_parts").value = parseFloat(grandTotalBal2).toFixed();
                                
                                var grandtotal_total = grandTotalBal2 + parseFloat($("#Wwograndtotal_labor").val()); 
                                document.getElementById("Wwograndtotal_total").value = parseFloat(grandtotal_total).toFixed(2); 
                                var totalDue = parseFloat(grandtotal_total);
                                document.getElementById("Wwograndtotal_amount_due").value = parseFloat(totalDue).toFixed(2);
                                
                                //document.getElementById("TotalOfJobDiv"+jobIndex).innerHTML = parseFloat(grandtotal_total).toFixed(2);
                                //var disJob = 0.00;
                                //if($("#WwodiscountOnJob"+WWOjobIndex).val() != "") {
                                   // disJob = parseFloat($("#WwodiscountOnJob"+WWOjobIndex).val());
                                //}

                                
                                //var totalforJob = parseFloat(grandtotal_total) - parseFloat(disJob);
                                
                                //document.getElementById("gTotalAmtWwo"+WWOjobIndex).innerHTML = parseFloat(totalforJob).toFixed(2);
                                
                                var grandtotalDiscount = parseFloat($("#WwograndtotalDiscount").val());
                                var grandtotal_payment = parseFloat($("#Wwograndtotal_payment").val());
                                var discountOnWO = 0.00;
                                if($("#Wwograndtotal_payment").val() != '') {
                                    discountOnWO = parseFloat($("#Wwograndtotal_payment").val());
                                }
                                document.getElementById("Wwograndtotal_balance").value = parseFloat(totalDue - (grandtotal_payment + discountOnWO)).toFixed(2);
                                //Wwocalculate_totalofallJobDiv();
                            }
                            $("#WWOspinner").hide();
                            //calculate_totalofallJobDiv(); 
                            //$('#PymntModl').fadeOut();
                            //$("#selectedPrntDiv").hide();
                            //$("#partResultDiv").hide(); 
                            //document.getElementById("prtDetailInput").value = "";
                            WWOhideAll();
                                
                            
                            wwolstSelectedPartNumber = [];
                            wwomapForQuantity = new Object();
                            wwomapForQuantityTmp = new Object();
                            wwolstFinalList = []; 
                            wwoobjMapForResutData = new Object();
                            lstResult = [];
                        }
                    }
                });
            }
        
        } 
        
    });




    $("#WWOaddToCrtnewjob").click(function() {
        console.log("Add Part"); 
        $("#spinner").show();
        if(WWOaddJobDiv != 0) {
            for(key in wwomapForQuantity) {
                wwomapForQuantityTmp[key] = wwomapForQuantity[key];
            } 
            var lstResult = [];
            if(wwolstSelectedPartNumber.length > 0) {
                BOATBUILDING.WarrantyWorkOrderControllerClone.getFinalList2(wwolstSelectedPartNumber, wwomapForQuantityTmp, function(result, event) {
                    if(event.status) {
                        console.log(result);
                        //hideAll(); 
                        
                        if(result != null) { 
                            lstResult = result;
                            if(lstResult.length > 0) {
                                for(var i = 0; i < lstResult.length; i++) { 
                                    if(lstResult[i].PartNumber in wwomapForQuantityTmp ) {
                                        if(!(lstResult[i].PartNumber in wwoobjMapForResutData)) {
                                            wwolstFinalList.push(lstResult[i]);
                                            wwoobjMapForResutData[lstResult[i].PartNumber] = lstResult[i];
                                        }
                                    }
                                } 
                            }
                            if(wwolstFinalList.length > 0) {
                                var grandTotalBal = 0.00;
                                var tableHTML = '';
                                console.log(WWOaddJobDiv);
                                $("#WwohiddentdDiv"+WWOaddJobDiv).css("display","");
                                var Wwofd = document.getElementById("Wwofile1Div"+WWOaddJobDiv);
                                for(var i = 0; i < wwolstFinalList.length; i++) {
                                    if(wwolstFinalList[i].PartNumber in wwomapForQuantityTmp) {
                                        var total = parseFloat(wwomapForQuantityTmp[wwolstFinalList[i].PartNumber]) * parseFloat(wwolstFinalList[i].MSRP);
                                        grandTotalBal += total; 
                                        
                                        
                                        var WWoPartFullName = '', WWoPartname = '';
                                        if(wwolstFinalList[i].PartName != undefined){
                                            WWoPartFullName = wwolstFinalList[i].PartName;
                                            if(WWoPartFullName.length > 5) {
                                                    WWoPartname = WWoPartFullName.substr(0, 5) + '...'; 
                                            } else {
                                                    WWoPartname = result[i].PartName;
                                            } 
                                        }
                                        
                                        var prtIndexWWO = (i+WWOaddJobDiv)+"final";
                                        
                                        var Wwonewdiv = document.createElement("Wwodiv"+WWOaddJobDiv);
                                        var Wwonumi = document.getElementById('WwotheValueDiv'+WWOaddJobDiv);
                                        var Wwonum = (document.getElementById("WwotheValueDiv"+WWOaddJobDiv).value -1)+ 2;
                                        Wwonumi.value = Wwonum;
                                        var Wwoselectpartlist = "WwoselectpartlistDiv"+WWOaddJobDiv+Wwonum;
                                        var WwoPartTotal = "WwoPartTotalDiv"+WWOaddJobDiv+Wwonum;
                                        var WwopartId = "WwoprtId"+WWOaddJobDiv+Wwonum;
                                        var WwoPartsQuantity = "WwoPartsQuantityDiv"+WWOaddJobDiv+Wwonum;
                                        var WwoPartPrice = "WwoPartPriceDiv"+WWOaddJobDiv+Wwonum; 
                                        
                                        var r = Math.floor(Math.random()*100000);
                                        Wwonewdiv.setAttribute("id","aaaa"+r);
                                        
                                        Wwonewdiv.innerHTML = '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65" id="'+WwopartId+'">'+wwolstFinalList[i].PartNumber+'</td><td data-label="Parts No" width="65"><span style=" display: none; position: absolute; top: -38%; left: -4%; border: 1px solid #a8b8c7; padding: 5px; border-radius: 1rem; background: #e1e6ee; z-index:999;" id="hiddnPrtName'+WWOaddJobDiv+''+prtIndexWWO+'">'+WWoPartFullName+'</span><input type="hidden" value="'+WWoPartFullName+'" id="'+Wwoselectpartlist+'"><a onmouseover="viewFullName(\''+WWOaddJobDiv+'\',\''+prtIndexWWO+'\');" onmouseout="hideFullName(\''+WWOaddJobDiv+'\',\''+prtIndexWWO+'\');" >'+WWoPartname+'</a></td><td data-label="Quanity" width="144"><input id="'+WwoPartsQuantity+'" onkeypress="return isNumber(event)" onkeyup="Wwocalculate_quantity_Div('+WWOaddJobDiv+','+Wwonum+'); Wwocalculate_totalofJobDiv('+WWOaddJobDiv+');" class="slds-input" type="text" value="'+wwomapForQuantityTmp[wwolstFinalList[i].PartNumber]+'"/><td id="'+WwoPartPrice+'" class="slds-text-align--right" width="90">'+parseFloat(wwolstFinalList[i].MSRP).toFixed(2)+'</td><td width="60" class="slds-text-align--right" id="'+WwoPartTotal+'">'+parseFloat(total).toFixed(2)+'</td><td width="24" align="right"><a href="#1" title="Remove" class="hyperlink" style="text-decoration:none;" onclick="Javascript:remove_row(\''+"aaaa"+r+'\','+Wwonum+');return false">Remove</a></td></tr></table>';
                                        Wwofd.appendChild(Wwonewdiv);
                                    } 
                                }  
                                
                                
                            }
                            $("#WWOspinner").hide();
                            //calculate_totalofallJobDiv(); 
                            //$('#PymntModl').fadeOut();
                            //$("#selectedPrntDiv").hide();
                            //$("#partResultDiv").hide(); 
                            //document.getElementById("prtDetailInput").value = "";
                            WWOhideAllnewjob();
                            wwolstSelectedPartNumber = [];
                            wwomapForQuantity = new Object();
                            wwomapForQuantityTmp = new Object();
                            wwolstFinalList = []; 
                            wwoobjMapForResutData = new Object();
                            lstResult = [];
                            
                            
                        }
                    }
                });
            }
        
        } 
        
    });


    
    
    function wwochangeQuanityFromEditableMode(obj, jliId, divNum) {
        $('.popup').addClass('active');
        if(obj.value != "" && obj.value > 0) { 
            BOATBUILDING.WarrantyWorkOrderControllerClone.updatePartFromEditableMode(jliId, obj.value, function(result, event) {
                $('.popup').removeClass('active'); 
                var tableHTML = '<input type="hidden" name="theValue" id="WwotheValueDiv'+divNum+'" value="'+result.length+'">';
                var grandTotalBal = 0.00;
                if(result.length > 0) {
                    for(var i = 0; i < result.length; i++) {
                            var total = parseFloat(result[i].Quantity) * parseFloat(result[i].MSRP);
                            grandTotalBal += total; 
                             
                            var WWoPartFullName = '', WWoPartname = '';
                            if(result[i].PartName != undefined){
                                WWoPartFullName = result[i].PartName;
                                if(WWoPartFullName.length > 5) {
                                        WWoPartname = WWoPartFullName.substr(0, 5) + '...'; 
                                } else {
                                        WWoPartname = result[i].PartName;
                                }
                            } 
                            var prtIndexWWO = i+1;
                            
                            tableHTML += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+result[i].PartNumber+'</td><td width="100"><span style=" display: none; position: absolute; top: -38%; left: -4%; border: 1px solid #a8b8c7; padding: 5px; border-radius: 1rem; background: #e1e6ee; z-index:999;" id="hiddnPrtNamewwo'+divNum+''+prtIndexWWO+'">'+WWoPartFullName+'</span><a onmouseover="viewFullNameWWO(\''+divNum+'\',\''+prtIndexWWO+'\');" onmouseout="hideFullNameWWO(\''+divNum+'\',\''+prtIndexWWO+'\');">'+WWoPartname+'</a></td><td width="106">&nbsp;</td><td data-label="Quantity" width="144"><input onkeyPress="return isNumber(event);" onKeyUp="wwochangeQuanityFromEditableMode(this, \''+result[i].Id+'\', \''+divNum+'\');"  type="text" value="'+result[i].Quantity+'" class="slds-input"/></td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(result[i].MSRP).toFixed(2)+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(total).toFixed(2)+'</td><td style="text-align: right;"><a onclick="wworemovePart(this, \''+result[i].Id+'\', \''+divNum+'\');">Remove</a></td></tr></table>'; 
                    }
                    document.getElementById("Wwoexistingjobdiv"+divNum).innerHTML = tableHTML;
                } else {
                    document.getElementById("Wwoexistingjobdiv"+divNum).innerHTML = tableHTML;
                } 
                /*var grandTotalBal2 = parseFloat(grandTotalBal); 
                document.getElementById("grandtotal_parts").value = parseFloat(grandTotalBal2).toFixed();
                var grandtotal_total = (grandTotalBal2 + parseFloat($("#grandtotal_labor").val()) + parseFloat($("#grandtotal_supplies").val())).toFixed(2);
                document.getElementById("grandtotal_total").value = parseFloat(grandtotal_total).toFixed(2);
                var totalDue = parseFloat(grandtotal_total) + parseFloat($("#grandtotal_tax").val());
                document.getElementById("grandtotal_amount_due").value = parseFloat(totalDue).toFixed(2);
                
                document.getElementById("TotalOfJobDiv"+divNum).innerHTML = parseFloat(grandtotal_total).toFixed(2);
                var disJob = 0.00;
                if($("#discountOnJob"+divNum).val() != "") {
                    disJob = parseFloat($("#discountOnJob"+divNum).val());
                }
                
                var shipCh = 0.00;
                if($("#shippingId"+divNum).val() != "") {
                    shipCh = parseFloat($("#shippingId"+divNum).val());
                }
                
                var totalforJob = (parseFloat(grandtotal_total) + parseFloat(shipCh)) - parseFloat(disJob);
                
                document.getElementById("gTotalAmt"+divNum).innerHTML = parseFloat(totalforJob).toFixed(2);
                
                var grandtotalDiscount = parseFloat($("#grandtotalDiscount").val());
                var grandtotal_payment = parseFloat($("#grandtotal_payment").val());
                var discountOnWO = 0.00;
                if($("#grandtotal_payment").val() != '') {
                    discountOnWO = parseFloat($("#grandtotal_payment").val());
                }
                document.getElementById("grandtotal_balance").value = parseFloat(totalDue - (grandtotal_payment + discountOnWO)).toFixed(2);
                var totalShippingChrge = document.getElementById("shippingGrndTtl").value;
                var total_salesamount = document.getElementById("grandtotal_tax").value;
                document.getElementById("grandTotalId").value = parseFloat(grandtotal_total + totalShippingChrge + total_salesamount).toFixed(2); 
                Wwocalculate_totalofallJobDiv();*/
            });
        } else if(obj.value == "") {
            $('.popup').removeClass('active');
        } else {
            $('.popup').removeClass('active');
            alert("Please enter valid quantity");
        }
    } 
    
    
    function wworemovePart(obj, jliId, divNum) {
        //$('.popup').addClass('active');
        BOATBUILDING.WarrantyWorkOrderControllerClone.removeExistingElement(jliId, function(result, event) {
            //$('.popup').removeClass('active'); 
            var tableHTML = ''; 
            var grandTotalBal = 0.00; 
            if(result.length > 0) {
                tableHTML = '<input type="hidden" name="theValue" id="WwotheValueDiv'+divNum+'" value="'+result.length+'">';
                for(var i = 0; i < result.length; i++) {
                        var total = parseFloat(result[i].Quantity) * parseFloat(result[i].MSRP);
                        grandTotalBal += total;   
                        
                         var WWoPartFullName = '', WWoPartname = '';
                        if(result[i].PartName != undefined){
                            WWoPartFullName = result[i].PartName;
                            if(WWoPartFullName.length > 5) {
                                    WWoPartname = WWoPartFullName.substr(0, 5) + '...'; 
                            } else {
                                    WWoPartname = result[i].PartName;
                            }
                        }
                        var prtIndexWWO = i+1;
                        tableHTML += '<table width="100%" border="0" cellspacing="2" cellpadding="2"><tr><td data-label="Part" width="43" >Parts</td><td width="65">'+result[i].PartNumber+'</td><td width="100"><span style=" display: none; position: absolute; top: -38%; left: -4%; border: 1px solid #a8b8c7; padding: 5px; border-radius: 1rem; background: #e1e6ee; z-index:999;" id="hiddnPrtNamewwo'+divNum+''+prtIndexWWO+'">'+WWoPartFullName+'</span><a onmouseover="viewFullNameWWO(\''+divNum+'\',\''+prtIndexWWO+'\');" onmouseout="hideFullNameWWO(\''+divNum+'\',\''+prtIndexWWO+'\');">'+WWoPartname+'</a></td><td width="106">&nbsp;</td><td data-label="Quantity" width="144"><input onkeyPress="return isNumber(event);" onKeyUp="wwochangeQuanityFromEditableMode(this, \''+result[i].Id+'\', \''+divNum+'\');"  type="text" value="'+result[i].Quantity+'" class="slds-input"/></td><td class="slds-text-align--right" width="90"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(result[i].MSRP).toFixed(2)+'</td><td width="60" class="slds-text-align--right"><i class="fa fa-usd" aria-hidden="true"></i>'+parseFloat(total).toFixed(2)+'</td><td style="text-align: right;"><a onclick="wworemovePart(this, \''+result[i].Id+'\', \''+divNum+'\');">Remove</a></td></tr></table>'; 
                }
                document.getElementById("Wwoexistingjobdiv"+divNum).innerHTML = tableHTML;
                
            } else {
                tableHTML = '<input type="hidden" name="theValue" id="theValueDiv'+divNum+'" value="'+0+'">'; 
                document.getElementById("Wwoexistingjobdiv"+divNum).innerHTML = tableHTML; 
            } 
            //objDivTotalPartAmt["DivNum"+divNum] = grandTotalBal; 
            //calculate_totalofallJobDiv(); 
               
            /*var grandTotalBal2 = parseFloat(grandTotalBal);
            document.getElementById("grandtotal_parts").value = parseFloat(grandTotalBal2).toFixed();
            var grandtotal_total = (grandTotalBal2 + parseFloat($("#grandtotal_labor").val()) + parseFloat($("#grandtotal_supplies").val())).toFixed(2);
            document.getElementById("grandtotal_total").value = parseFloat(grandtotal_total).toFixed(2);
            var totalDue = parseFloat(grandtotal_total) + parseFloat($("#grandtotal_tax").val());
            document.getElementById("grandtotal_amount_due").value = parseFloat(totalDue).toFixed(2);
            
            document.getElementById("TotalOfJobDiv"+divNum).innerHTML = parseFloat(grandtotal_total).toFixed(2);
            var disJob = 0.00;
            if($("#discountOnJob"+divNum).val() != "") {
                disJob = parseFloat($("#discountOnJob"+divNum).val());
            }
            
            var shipCh = 0.00; 
            if($("#shippingId"+divNum).val() != "") {
                shipCh = parseFloat($("#shippingId"+divNum).val());
            }
            
            var totalforJob = (parseFloat(grandtotal_total) + parseFloat(shipCh)) - parseFloat(disJob);
            
            document.getElementById("gTotalAmt"+divNum).innerHTML = parseFloat(totalforJob).toFixed(2);
            
            var grandtotalDiscount = parseFloat($("#grandtotalDiscount").val());
            var grandtotal_payment = parseFloat($("#grandtotal_payment").val());
            var discountOnWO = 0.00;
            if($("#grandtotal_payment").val() != '') {
                discountOnWO = parseFloat($("#grandtotal_payment").val());
            }
            document.getElementById("grandtotal_balance").value = parseFloat(totalDue - (grandtotal_payment + discountOnWO)).toFixed(2);
            var totalShippingChrge = document.getElementById("shippingGrndTtl").value;
            var total_salesamount = document.getElementById("grandtotal_tax").value;
            document.getElementById("grandTotalId").value = parseFloat(grandtotal_total + totalShippingChrge + total_salesamount).toFixed(2);
            calculate_totalofallJobDiv1();*/
        });
    }
       
    function printWWO(obj) {
        if($("#WWOcaseHiddenId").val() != null && $("#WWOcaseHiddenId").val() != "") {
                if("{!PrintSkip}" == '0') {
                    //window.top.location = '/apex/BOATBUILDING__CasePDFPageClone3?scontrolCaching=1&id='+$("#WWOcaseHiddenId").val()+'&btnStatus=Print&type=WWO&WOType=wwo';
                    
                    window.open(
					  '/apex/BOATBUILDING__CasePDFPageClone3?scontrolCaching=1&id='+$("#WWOcaseHiddenId").val()+'&btnStatus=Print&type=WWO&WOType=wwo',
					  '_blank' // <- This is what makes it open in a new window.
					);
                    
            } else {
                    //window.top.location = '/apex/BOATBUILDING__CasePDFPageClone3skp?scontrolCaching=1&id='+$("#WWOcaseHiddenId").val()+'&btnStatus=Print&type=WWO&WOType=wwo';
                    window.open(
					  '/apex/BOATBUILDING__CasePDFPageClone3skp?scontrolCaching=1&id='+$("#WWOcaseHiddenId").val()+'&btnStatus=Print&type=WWO&WOType=wwo',
					  '_blank' // <- This is what makes it open in a new window.
					);
            }
        }
    }
    function wwoaddCommentToJob(wwoDivNum, ty) {
            console.log(wwoDivNum)
            //hiddenInpPopup, taCommnt, popupTextArea
            document.getElementById("wwotyForCmnt").value = ty;
            document.getElementById("wwohiddenInpPopup").value = wwoDivNum;
            var comments = document.getElementById("WWOComments"+wwoDivNum).value;
            document.getElementById("wwotaCommnt").value = comments;
            document.getElementById("wwopopupTextArea").style.display = "block";
    }
    function wwoaddCustCommentToJob(wwoDivNum, ty) {
        //console.log(wwoDivNum)
        //hiddenInpPopup, taCommnt, popupTextArea
        document.getElementById("wwotyForCmnt").value = ty;
        document.getElementById("wwohiddenInpPopup").value = wwoDivNum;
        var comments = document.getElementById("WWOCUSTComments"+wwoDivNum).value;
        document.getElementById("wwotaCommnt").value = comments;
        document.getElementById("wwopopupTextArea").style.display = "block";
    }
    function wwoviewCustCommentFromJob(wwoDivNum, ty) {
            console.log(wwoDivNum)
            //hiddenInpPopup, taCommnt, popupTextArea
            document.getElementById("wwotyForCmnt").value = ty;
            document.getElementById("wwohiddenInpPopup").value = wwoDivNum;
            var comments = document.getElementById("WWOCUSTComments"+wwoDivNum).value;
            document.getElementById("wwotaCommnt").value = comments;
            document.getElementById("wwopopupTextArea").style.display = "block";
            document.getElementById("wwoaddCmntBttn").style.display = "none";
    
    }
    function wwoviewCommentFromJob(wwoDivNum, ty) {
            console.log(wwoDivNum)
            //hiddenInpPopup, taCommnt, popupTextArea
            document.getElementById("wwotyForCmnt").value = ty;
            document.getElementById("wwohiddenInpPopup").value = wwoDivNum;
            var comments = document.getElementById("WWOComments"+wwoDivNum).value;
            document.getElementById("wwotaCommnt").value = comments;
            document.getElementById("wwopopupTextArea").style.display = "block";
            document.getElementById("wwoaddCmntBttn").style.display = "none";
    
    }
    $("#wwoaddCmntBttn").click(function() {
             
        ty = document.getElementById("wwotyForCmnt").value ;
        console.log(ty);
        if(ty == 'CUST') {
            var cmntToAdd = $("#wwotaCommnt").val();
            if(document.getElementById("wwotaCommnt").value.includes('\n')) {
                cmntToAdd = $("#wwotaCommnt").val().replace(/\n/g, " ~~ ");
            }
            var jobDivNum = document.getElementById("wwohiddenInpPopup").value;
            document.getElementById("WWOCUSTComments"+jobDivNum).value = cmntToAdd;
            document.getElementById("wwopopupTextArea").style.display = "none";
            
        } else if(ty == 'SER') {
            var cmntToAdd = $("#wwotaCommnt").val();
            if(document.getElementById("wwotaCommnt").value.includes('\n')) {
                cmntToAdd = $("#wwotaCommnt").val().replace(/\n/g, " ~~ ");
            } 
            var jobDivNum = document.getElementById("wwohiddenInpPopup").value;
            document.getElementById("WWOComments"+jobDivNum).value = cmntToAdd;
            document.getElementById("wwopopupTextArea").style.display = "none";
        }
            
    });
    </script>
 
   
</apex:component>